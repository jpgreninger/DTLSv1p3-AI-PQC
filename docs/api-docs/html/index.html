<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DTLS v1.3 Implementation: DTLS v1.3 API Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--BEGIN TREEVIEW-->
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<!--END TREEVIEW-->
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<!--BEGIN EXTRA_STYLESHEET-->
<link href="$extra_stylesheet" rel="stylesheet" type="text/css"/>
<!--END EXTRA_STYLESHEET-->
<!--BEGIN FORMULA_MACROS-->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { fonts: ["TeX"] }
  });
</script>
<!--END FORMULA_MACROS-->
<script type="text/javascript" async="async" src="path"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectname">DTLS v1.3 Implementation
  <span id="projectnumber">&#160;1.0.0</span>
  </td>
   <td>        ðŸ”’ Enterprise-grade DTLS v1.3 implementation with SystemC TLM modeling and comprehensive security features</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Doxygen Awesome features initialization -->
<script type="text/javascript">
    // Initialize doxygen-awesome features when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        // Enable dark mode toggle if available
        if (typeof doxygen_awesome_dark_mode_toggle !== 'undefined') {
            doxygen_awesome_dark_mode_toggle.init();
        }
        // Enable fragment copy button if available
        if (typeof doxygen_awesome_fragment_copy_button !== 'undefined') {
            doxygen_awesome_fragment_copy_button.init();
        }
        // Enable paragraph link if available
        if (typeof doxygen_awesome_paragraph_link !== 'undefined') {
            doxygen_awesome_paragraph_link.init();
        }
        // Enable interactive TOC if available
        if (typeof doxygen_awesome_interactive_toc !== 'undefined') {
            doxygen_awesome_interactive_toc.init();
        }
        // Enable tabs if available
        if (typeof doxygen_awesome_tabs !== 'undefined') {
            doxygen_awesome_tabs.init();
        }
    });
</script><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">DTLS v1.3 API Documentation </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2home_2jgreninger_2Work_2DTLSv1p3_2docs_2API__DOCUMENTATION"></a> Complete reference for the DTLS v1.3 C++ library public API. This implementation follows RFC 9147 specifications and provides both high-level convenience APIs and low-level control interfaces.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Table of Contents</h1>
<ul>
<li>Quick Start</li>
<li>Core API</li>
<li>Connection Management</li>
<li>Cryptographic Interface</li>
<li>Protocol Layer</li>
<li>Memory Management</li>
<li>Error Handling</li>
<li>Configuration</li>
<li>Performance Monitoring</li>
<li>Security Features</li>
<li>Examples</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Quick Start</h1>
<h2><a class="anchor" id="autotoc_md3"></a>
Basic Client Connection</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;dtls/connection.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dtls/crypto/provider_factory.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>dtls::v13;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Initialize crypto provider</span></div>
<div class="line"><span class="keyword">auto</span> crypto_manager = crypto::ProviderFactory::instance()</div>
<div class="line">    .create_provider(<span class="stringliteral">&quot;openssl&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Configure connection</span></div>
<div class="line"><a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a> config;</div>
<div class="line">config.handshake_timeout = std::chrono::seconds(10);</div>
<div class="line">config.enable_early_data = <span class="keyword">true</span>;</div>
<div class="line">config.supported_cipher_suites = {</div>
<div class="line">    CipherSuite::TLS_AES_256_GCM_SHA384,</div>
<div class="line">    CipherSuite::TLS_CHACHA20_POLY1305_SHA256</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create connection</span></div>
<div class="line"><span class="keyword">auto</span> connection_result = Connection::create_client(</div>
<div class="line">    NetworkAddress::from_string(<span class="stringliteral">&quot;192.168.1.100:4433&quot;</span>),</div>
<div class="line">    config,</div>
<div class="line">    std::move(crypto_manager)</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (!connection_result) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to create connection: &quot;</span> </div>
<div class="line">              &lt;&lt; connection_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> connection = std::move(connection_result.value());</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Perform handshake</span></div>
<div class="line"><span class="keyword">auto</span> handshake_result = connection-&gt;handshake();</div>
<div class="line"><span class="keywordflow">if</span> (!handshake_result) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Handshake failed: &quot;</span> </div>
<div class="line">              &lt;&lt; handshake_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Send application data</span></div>
<div class="line">std::vector&lt;uint8_t&gt; data = {<span class="charliteral">&#39;H&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;l&#39;</span>, <span class="charliteral">&#39;l&#39;</span>, <span class="charliteral">&#39;o&#39;</span>};</div>
<div class="line"><span class="keyword">auto</span> send_result = connection-&gt;send(data);</div>
<div class="line"><span class="keywordflow">if</span> (!send_result) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Send failed: &quot;</span> </div>
<div class="line">              &lt;&lt; send_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="ttc" id="astructdtls_1_1v13_1_1ConnectionConfig_html"><div class="ttname"><a href="structdtls_1_1v13_1_1ConnectionConfig.html">dtls::v13::ConnectionConfig</a></div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00118">connection.h:118</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4"></a>
Basic Server Setup</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;dtls/connection.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dtls/crypto/provider_factory.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>dtls::v13;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Server configuration</span></div>
<div class="line"><a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a> server_config;</div>
<div class="line">server_config.enable_connection_id = <span class="keyword">true</span>;</div>
<div class="line">server_config.connection_id_length = 8;</div>
<div class="line">server_config.max_early_data_size = 16384;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create connection manager</span></div>
<div class="line"><span class="keyword">auto</span> manager_result = ConnectionManager::create(server_config);</div>
<div class="line"><span class="keyword">auto</span>&amp; manager = manager_result.value();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set up event callbacks</span></div>
<div class="line">manager.set_event_callback([](ConnectionEvent event, <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp; conn) {</div>
<div class="line">    <span class="keywordflow">switch</span> (event) {</div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::HANDSHAKE_COMPLETED:</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Client connected successfully&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::DATA_RECEIVED:</div>
<div class="line">            <span class="comment">// Handle incoming data</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::CONNECTION_CLOSED:</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Client disconnected&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Start server</span></div>
<div class="line"><span class="keyword">auto</span> bind_result = manager.bind(NetworkAddress::from_string(<span class="stringliteral">&quot;0.0.0.0:4433&quot;</span>));</div>
<div class="line"><span class="keywordflow">if</span> (!bind_result) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to bind server&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Run server loop</span></div>
<div class="line">manager.run();</div>
<div class="ttc" id="aclassdtls_1_1v13_1_1Connection_html"><div class="ttname"><a href="classdtls_1_1v13_1_1Connection.html">dtls::v13::Connection</a></div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00231">connection.h:231</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md5"></a>
Core API</h1>
<h2><a class="anchor" id="autotoc_md6"></a>
Types and Constants</h2>
<p>The core types are defined in <code><a class="el" href="types_8h.html" title="Core DTLS v1.3 Protocol Types and Constants.">include/dtls/types.h</a></code>:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::v13 {</div>
<div class="line">    <span class="comment">// Protocol version constants</span></div>
<div class="line">    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="group__CoreTypes.html#gabc4372b1165cf4e20b612d50ff20e1bb">ProtocolVersion</a> <a class="code hl_variable" href="group__VersionConstants.html#gaa155c2c1b01c7c98909d43aaa2c84247">DTLS_V13</a>{254, 252};</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection identifiers and session data</span></div>
<div class="line">    <span class="keyword">using </span>ConnectionID = std::vector&lt;uint8_t&gt;;</div>
<div class="line">    <span class="keyword">using </span>SessionID = std::vector&lt;uint8_t&gt;;</div>
<div class="line">    <span class="keyword">using </span>Random = std::array&lt;uint8_t, 32&gt;;</div>
<div class="line">    <span class="keyword">using </span>KeyMaterial = std::vector&lt;uint8_t&gt;;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Network addressing</span></div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a> {</div>
<div class="line">        <span class="keyword">enum class</span> Family { IPv4, IPv6 } family;</div>
<div class="line">        std::array&lt;uint8_t, 16&gt; address;</div>
<div class="line">        uint16_t port;</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">static</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a> from_ipv4(uint32_t ip, uint16_t port);</div>
<div class="line">        <span class="keyword">static</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a> from_ipv6(<span class="keyword">const</span> std::array&lt;uint8_t, 16&gt;&amp; ip, uint16_t port);</div>
<div class="line">        <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;NetworkAddress&gt;</a> from_string(<span class="keyword">const</span> std::string&amp; addr);</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">bool</span> is_ipv4() <span class="keyword">const</span>;</div>
<div class="line">        <span class="keywordtype">bool</span> is_ipv6() <span class="keyword">const</span>;</div>
<div class="line">        std::string to_string() <span class="keyword">const</span>;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Protocol enums</span></div>
<div class="line">    <span class="keyword">enum class</span> <a class="code hl_enumeration" href="types_8h.html#ab9c84107809224041465427557aafdeb">ContentType</a> : uint8_t {</div>
<div class="line">        INVALID = 0,</div>
<div class="line">        CHANGE_CIPHER_SPEC = 20,</div>
<div class="line">        ALERT = 21,</div>
<div class="line">        HANDSHAKE = 22,</div>
<div class="line">        APPLICATION_DATA = 23,</div>
<div class="line">        HEARTBEAT = 24,</div>
<div class="line">        TLS12_CID = 25,</div>
<div class="line">        <a class="code hl_enumvalue" href="types_8h.html#ab9c84107809224041465427557aafdeba0fc437bc317835cad5faafc12a83fad5">ACK</a> = 26</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">enum class</span> HandshakeType : uint8_t {</div>
<div class="line">        CLIENT_HELLO = 1,</div>
<div class="line">        SERVER_HELLO = 2,</div>
<div class="line">        NEW_SESSION_TICKET = 4,</div>
<div class="line">        END_OF_EARLY_DATA = 5,</div>
<div class="line">        HELLO_RETRY_REQUEST = 6,</div>
<div class="line">        ENCRYPTED_EXTENSIONS = 8,</div>
<div class="line">        CERTIFICATE = 11,</div>
<div class="line">        CERTIFICATE_REQUEST = 13,</div>
<div class="line">        CERTIFICATE_VERIFY = 15,</div>
<div class="line">        FINISHED = 20,</div>
<div class="line">        KEY_UPDATE = 24,</div>
<div class="line">        <a class="code hl_enumvalue" href="types_8h.html#ab9c84107809224041465427557aafdeba0fc437bc317835cad5faafc12a83fad5">ACK</a> = 26,</div>
<div class="line">        MESSAGE_HASH = 254</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">enum class</span> CipherSuite : uint16_t {</div>
<div class="line">        TLS_AES_128_GCM_SHA256 = 0x1301,</div>
<div class="line">        TLS_AES_256_GCM_SHA384 = 0x1302,</div>
<div class="line">        TLS_CHACHA20_POLY1305_SHA256 = 0x1303,</div>
<div class="line">        TLS_AES_128_CCM_SHA256 = 0x1304,</div>
<div class="line">        TLS_AES_128_CCM_8_SHA256 = 0x1305</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">enum class</span> ConnectionState {</div>
<div class="line">        INITIAL,</div>
<div class="line">        WAIT_SERVER_HELLO,</div>
<div class="line">        WAIT_ENCRYPTED_EXTENSIONS,</div>
<div class="line">        WAIT_CERTIFICATE_OR_CERT_REQUEST,</div>
<div class="line">        WAIT_CERTIFICATE_VERIFY,</div>
<div class="line">        WAIT_SERVER_FINISHED,</div>
<div class="line">        WAIT_CLIENT_CERTIFICATE,</div>
<div class="line">        WAIT_CLIENT_CERTIFICATE_VERIFY,</div>
<div class="line">        WAIT_CLIENT_FINISHED,</div>
<div class="line">        CONNECTED,</div>
<div class="line">        CLOSED,</div>
<div class="line">        EARLY_DATA,</div>
<div class="line">        WAIT_END_OF_EARLY_DATA,</div>
<div class="line">        EARLY_DATA_REJECTED</div>
<div class="line">    };</div>
<div class="line">}</div>
<div class="ttc" id="aclassdtls_1_1v13_1_1Result_html"><div class="ttname"><a href="classdtls_1_1v13_1_1Result.html">dtls::v13::Result</a></div><div class="ttdef"><b>Definition</b> <a href="result_8h_source.html#l00019">result.h:19</a></div></div>
<div class="ttc" id="agroup__CoreTypes_html_gabc4372b1165cf4e20b612d50ff20e1bb"><div class="ttname"><a href="group__CoreTypes.html#gabc4372b1165cf4e20b612d50ff20e1bb">dtls::v13::ProtocolVersion</a></div><div class="ttdeci">uint16_t ProtocolVersion</div><div class="ttdoc">Protocol version identifier (network byte order)</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00041">types.h:41</a></div></div>
<div class="ttc" id="agroup__VersionConstants_html_gaa155c2c1b01c7c98909d43aaa2c84247"><div class="ttname"><a href="group__VersionConstants.html#gaa155c2c1b01c7c98909d43aaa2c84247">dtls::v13::DTLS_V13</a></div><div class="ttdeci">constexpr ProtocolVersion DTLS_V13</div><div class="ttdoc">DTLS v1.3 version identifier (primary target)</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00067">types.h:67</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html">dtls::v13::NetworkAddress</a></div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00306">types.h:306</a></div></div>
<div class="ttc" id="atypes_8h_html_ab9c84107809224041465427557aafdeb"><div class="ttname"><a href="types_8h.html#ab9c84107809224041465427557aafdeb">dtls::v13::ContentType</a></div><div class="ttdeci">ContentType</div><div class="ttdoc">DTLS record content types per RFC 9147 Section 5.</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00077">types.h:77</a></div></div>
<div class="ttc" id="atypes_8h_html_ab9c84107809224041465427557aafdeba0fc437bc317835cad5faafc12a83fad5"><div class="ttname"><a href="types_8h.html#ab9c84107809224041465427557aafdeba0fc437bc317835cad5faafc12a83fad5">dtls::v13::ContentType::ACK</a></div><div class="ttdeci">@ ACK</div><div class="ttdoc">Acknowledgment messages (DTLS 1.3 feature)</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
Result Type System</h2>
<p>The library uses a Result&lt;T&gt; type for error handling instead of exceptions:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Check if result contains a value</span></div>
<div class="line">    <span class="keywordtype">bool</span> has_value() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keyword">explicit</span> <span class="keyword">operator</span> bool() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Access value (only if has_value() == true)</span></div>
<div class="line">    T&amp; value();</div>
<div class="line">    <span class="keyword">const</span> T&amp; value() <span class="keyword">const</span>;</div>
<div class="line">    T&amp; operator*();</div>
<div class="line">    <span class="keyword">const</span> T&amp; operator*() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Access error (only if has_value() == false)</span></div>
<div class="line">    <span class="keyword">const</span> Error&amp; error() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Convenience methods</span></div>
<div class="line">    T value_or(T&amp;&amp; default_value) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Factory methods</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;T&gt;</a> success(T&amp;&amp; value);</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;T&gt;</a> failure(Error error);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Usage examples</span></div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;Connection&gt;</a> conn_result = Connection::create_client(...);</div>
<div class="line"><span class="keywordflow">if</span> (conn_result) {</div>
<div class="line">    <span class="keyword">auto</span>&amp; connection = *conn_result;</div>
<div class="line">    <span class="comment">// Use connection</span></div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; conn_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md8"></a>
Connection Management</h1>
<h2><a class="anchor" id="autotoc_md9"></a>
Connection Class</h2>
<p>The main interface for DTLS connections:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Factory methods</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;Connection&gt;</a>&gt; create_client(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; server_address,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a>&amp; config,</div>
<div class="line">        std::unique_ptr&lt;crypto::CryptoProvider&gt; crypto_provider</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;Connection&gt;</a>&gt; create_server(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; bind_address,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a>&amp; config,</div>
<div class="line">        std::unique_ptr&lt;crypto::CryptoProvider&gt; crypto_provider</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection lifecycle</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> handshake();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> handshake_async(std::function&lt;<span class="keywordtype">void</span>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a>)&gt; callback);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> close();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> close(AlertDescription alert = AlertDescription::CLOSE_NOTIFY);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Data transmission</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;size_t&gt;</a> send(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;size_t&gt;</a> send(<span class="keyword">const</span> uint8_t* data, <span class="keywordtype">size_t</span> length);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; receive();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;size_t&gt;</a> receive(uint8_t* buffer, <span class="keywordtype">size_t</span> buffer_size);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Early data (0-RTT) support</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;size_t&gt;</a> send_early_data(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> is_early_data_accepted() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Key management</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> update_keys();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> request_post_handshake_auth();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// State information</span></div>
<div class="line">    ConnectionState get_state() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> is_connected() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> is_handshake_complete() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection properties</span></div>
<div class="line">    CipherSuite get_negotiated_cipher_suite() <span class="keyword">const</span>;</div>
<div class="line">    <a class="code hl_typedef" href="group__CoreTypes.html#gabc4372b1165cf4e20b612d50ff20e1bb">ProtocolVersion</a> get_negotiated_version() <span class="keyword">const</span>;</div>
<div class="line">    std::optional&lt;ConnectionID&gt; get_connection_id() <span class="keyword">const</span>;</div>
<div class="line">    std::optional&lt;ConnectionID&gt; get_peer_connection_id() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics and monitoring</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionStats.html">ConnectionStats</a>&amp; get_statistics() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> reset_statistics();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Advanced features</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> set_connection_id(<span class="keyword">const</span> ConnectionID&amp; cid);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> migrate_connection(<span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; new_address);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; export_keying_material(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; label,</div>
<div class="line">        <span class="keywordtype">size_t</span> length,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; context = {}</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Event handling</span></div>
<div class="line">    <span class="keywordtype">void</span> set_event_callback(ConnectionEventCallback callback);</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="ttc" id="astructdtls_1_1v13_1_1ConnectionStats_html"><div class="ttname"><a href="structdtls_1_1v13_1_1ConnectionStats.html">dtls::v13::ConnectionStats</a></div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00158">connection.h:158</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md10"></a>
Connection Configuration</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a> {</div>
<div class="line">    <span class="comment">// Cryptographic preferences</span></div>
<div class="line">    std::vector&lt;CipherSuite&gt; supported_cipher_suites = {</div>
<div class="line">        CipherSuite::TLS_AES_256_GCM_SHA384,</div>
<div class="line">        CipherSuite::TLS_AES_128_GCM_SHA256,</div>
<div class="line">        CipherSuite::TLS_CHACHA20_POLY1305_SHA256</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    std::vector&lt;NamedGroup&gt; supported_groups = {</div>
<div class="line">        NamedGroup::X25519,</div>
<div class="line">        NamedGroup::SECP256R1,</div>
<div class="line">        NamedGroup::SECP384R1</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    std::vector&lt;SignatureScheme&gt; supported_signatures = {</div>
<div class="line">        SignatureScheme::RSA_PSS_RSAE_SHA256,</div>
<div class="line">        SignatureScheme::ECDSA_SECP256R1_SHA256,</div>
<div class="line">        SignatureScheme::ED25519</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Timing configuration</span></div>
<div class="line">    std::chrono::milliseconds handshake_timeout{10000};</div>
<div class="line">    std::chrono::milliseconds retransmission_timeout{1000};</div>
<div class="line">    uint32_t max_retransmissions = 5;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection ID support</span></div>
<div class="line">    <span class="keywordtype">bool</span> enable_connection_id = <span class="keyword">true</span>;</div>
<div class="line">    uint8_t connection_id_length = 8;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Early data (0-RTT) configuration</span></div>
<div class="line">    <span class="keywordtype">bool</span> enable_early_data = <span class="keyword">true</span>;</div>
<div class="line">    uint32_t max_early_data_size = 16384;</div>
<div class="line">    std::chrono::milliseconds early_data_timeout{5000};</div>
<div class="line">    <span class="keywordtype">bool</span> allow_early_data_replay_protection = <span class="keyword">true</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Session management</span></div>
<div class="line">    <span class="keywordtype">bool</span> enable_session_resumption = <span class="keyword">true</span>;</div>
<div class="line">    std::chrono::seconds session_lifetime{7200};</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Buffer sizes</span></div>
<div class="line">    <span class="keywordtype">size_t</span> receive_buffer_size = 65536;</div>
<div class="line">    <span class="keywordtype">size_t</span> send_buffer_size = 65536;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Error recovery configuration</span></div>
<div class="line">    <a class="code hl_struct" href="structdtls_1_1v13_1_1ErrorRecoveryConfig.html">ErrorRecoveryConfig</a> error_recovery;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Factory method with defaults</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a> default_client_config();</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a> default_server_config();</div>
<div class="line">};</div>
<div class="ttc" id="astructdtls_1_1v13_1_1ErrorRecoveryConfig_html"><div class="ttname"><a href="structdtls_1_1v13_1_1ErrorRecoveryConfig.html">dtls::v13::ErrorRecoveryConfig</a></div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00058">connection.h:58</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11"></a>
Connection Events</h2>
<div class="fragment"><div class="line"><span class="keyword">enum class</span> ConnectionEvent {</div>
<div class="line">    HANDSHAKE_STARTED,</div>
<div class="line">    HANDSHAKE_COMPLETED,</div>
<div class="line">    HANDSHAKE_FAILED,</div>
<div class="line">    DATA_RECEIVED,</div>
<div class="line">    CONNECTION_CLOSED,</div>
<div class="line">    ERROR_OCCURRED,</div>
<div class="line">    ALERT_RECEIVED,</div>
<div class="line">    KEY_UPDATE_COMPLETED,</div>
<div class="line">    EARLY_DATA_ACCEPTED,</div>
<div class="line">    EARLY_DATA_REJECTED,</div>
<div class="line">    EARLY_DATA_RECEIVED,</div>
<div class="line">    NEW_SESSION_TICKET_RECEIVED,</div>
<div class="line">    RECOVERY_STARTED,</div>
<div class="line">    RECOVERY_SUCCEEDED,</div>
<div class="line">    RECOVERY_FAILED,</div>
<div class="line">    CONNECTION_DEGRADED,</div>
<div class="line">    CONNECTION_RESTORED</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>ConnectionEventCallback = std::function&lt;void(ConnectionEvent, <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp;)&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Example usage</span></div>
<div class="line">connection-&gt;set_event_callback([](ConnectionEvent event, <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp; conn) {</div>
<div class="line">    <span class="keywordflow">switch</span> (event) {</div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::HANDSHAKE_COMPLETED:</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Handshake completed with cipher suite: &quot;</span> </div>
<div class="line">                      &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(conn.get_negotiated_cipher_suite()) &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::DATA_RECEIVED:</div>
<div class="line">            <span class="comment">// Handle incoming application data</span></div>
<div class="line">            <span class="keyword">auto</span> data = conn.receive();</div>
<div class="line">            <span class="keywordflow">if</span> (data) {</div>
<div class="line">                process_application_data(*data);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::ERROR_OCCURRED:</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Connection error occurred&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">});</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md12"></a>
Connection Manager</h2>
<p>For server applications managing multiple connections:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="classdtls_1_1v13_1_1ConnectionManager.html">ConnectionManager</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;ConnectionManager&gt;</a>&gt; create(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a>&amp; config</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Server lifecycle</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> bind(<span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; address);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> listen(<span class="keywordtype">int</span> backlog = 128);</div>
<div class="line">    <span class="keywordtype">void</span> run();</div>
<div class="line">    <span class="keywordtype">void</span> stop();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection management</span></div>
<div class="line">    std::vector&lt;std::shared_ptr&lt;Connection&gt;&gt; get_active_connections();</div>
<div class="line">    <span class="keywordtype">size_t</span> get_connection_count() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Event handling</span></div>
<div class="line">    <span class="keywordtype">void</span> set_event_callback(ConnectionEventCallback callback);</div>
<div class="line">    <span class="keywordtype">void</span> set_new_connection_callback(</div>
<div class="line">        std::function&lt;<span class="keywordtype">void</span>(std::shared_ptr&lt;Connection&gt;)&gt; callback</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration</span></div>
<div class="line">    <span class="keywordtype">void</span> set_max_connections(<span class="keywordtype">size_t</span> max_connections);</div>
<div class="line">    <span class="keywordtype">void</span> set_connection_timeout(std::chrono::seconds timeout);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span>ServerStats {</div>
<div class="line">        <span class="keywordtype">size_t</span> total_connections_accepted;</div>
<div class="line">        <span class="keywordtype">size_t</span> active_connections;</div>
<div class="line">        <span class="keywordtype">size_t</span> failed_handshakes;</div>
<div class="line">        <span class="keywordtype">size_t</span> bytes_sent;</div>
<div class="line">        <span class="keywordtype">size_t</span> bytes_received;</div>
<div class="line">        std::chrono::steady_clock::time_point start_time;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">const</span> ServerStats&amp; get_server_statistics() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1ConnectionManager.html">ConnectionManager</a>() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="ttc" id="aclassdtls_1_1v13_1_1ConnectionManager_html"><div class="ttname"><a href="classdtls_1_1v13_1_1ConnectionManager.html">dtls::v13::ConnectionManager</a></div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00618">connection.h:618</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md13"></a>
Cryptographic Interface</h1>
<h2><a class="anchor" id="autotoc_md14"></a>
Provider Factory</h2>
<p>The cryptographic operations are abstracted through a provider system:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13_1_1crypto.html">dtls::v13::crypto</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ProviderFactory {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> ProviderFactory&amp; instance();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider registration</span></div>
<div class="line">    <span class="keywordtype">void</span> register_provider(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; name,</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; description,</div>
<div class="line">        std::function&lt;std::unique_ptr&lt;CryptoProvider&gt;()&gt; factory,</div>
<div class="line">        <span class="keywordtype">int</span> priority = 0</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider creation</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;CryptoProvider&gt;</a>&gt; create_provider(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; name = <span class="stringliteral">&quot;default&quot;</span></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;CryptoProvider&gt;</a>&gt; create_best_available_provider();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider information</span></div>
<div class="line">    std::vector&lt;std::string&gt; get_available_providers() <span class="keyword">const</span>;</div>
<div class="line">    std::vector&lt;ProviderRegistration&gt; get_provider_registrations() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> is_provider_available(<span class="keyword">const</span> std::string&amp; name) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider management</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> load_plugin(<span class="keyword">const</span> std::string&amp; plugin_path);</div>
<div class="line">    <span class="keywordtype">void</span> unload_all_plugins();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Health monitoring</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;ProviderCompatibilityResult&gt;</a> check_compatibility(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; provider_name,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;CipherSuite&gt;&amp; required_suites</div>
<div class="line">    ) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    ProviderFactory() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Built-in provider availability check</span></div>
<div class="line"><span class="keyword">namespace </span>builtin {</div>
<div class="line">    <span class="keywordtype">bool</span> is_openssl_available();</div>
<div class="line">    <span class="keywordtype">bool</span> is_botan_available();</div>
<div class="line">    <span class="keywordtype">bool</span> is_hardware_acceleration_available();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1crypto_html"><div class="ttname"><a href="namespacedtls_1_1v13_1_1crypto.html">dtls::v13::crypto</a></div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00075">crypto.h:75</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md15"></a>
Crypto Provider Interface</h2>
<div class="fragment"><div class="line"><span class="keyword">class </span>CryptoProvider {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> ~CryptoProvider() = <span class="keywordflow">default</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider information</span></div>
<div class="line">    <span class="keyword">virtual</span> std::string get_name() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::string get_version() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::vector&lt;CipherSuite&gt; get_supported_cipher_suites() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::vector&lt;NamedGroup&gt; get_supported_groups() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::vector&lt;SignatureScheme&gt; get_supported_signatures() <span class="keyword">const</span> = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Key generation and management</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> generate_key_pair(NamedGroup group) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> derive_shared_secret(</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; private_key,</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; peer_public_key,</div>
<div class="line">        NamedGroup group</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// HKDF operations (RFC 5869)</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> hkdf_extract(</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; salt,</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; ikm,</div>
<div class="line">        HashAlgorithm hash</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> hkdf_expand_label(</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; prk,</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; label,</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; context,</div>
<div class="line">        <span class="keywordtype">size_t</span> length,</div>
<div class="line">        HashAlgorithm hash</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// AEAD encryption/decryption</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; aead_encrypt(</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; key,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; nonce,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; plaintext,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; additional_data,</div>
<div class="line">        AEADCipher cipher</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; aead_decrypt(</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; key,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; nonce,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; ciphertext,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; additional_data,</div>
<div class="line">        AEADCipher cipher</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Digital signatures</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; sign(</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; private_key,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; message,</div>
<div class="line">        SignatureScheme scheme</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> verify(</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; public_key,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; message,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; signature,</div>
<div class="line">        SignatureScheme scheme</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Hash functions</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; hash(</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data,</div>
<div class="line">        HashAlgorithm algorithm</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; hmac(</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; key,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data,</div>
<div class="line">        HashAlgorithm algorithm</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Random number generation</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; generate_random(<span class="keywordtype">size_t</span> length) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Certificate operations</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; parse_certificate(</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; cert_data</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> extract_public_key(</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; certificate</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Hardware acceleration support</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> supports_hardware_acceleration() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> enable_hardware_acceleration() = 0;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md16"></a>
Provider Manager</h2>
<p>For advanced provider management and load balancing:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>ProviderManager {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">explicit</span> ProviderManager(ProviderPoolConfig config = {});</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider pool management</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> add_provider(std::unique_ptr&lt;CryptoProvider&gt; provider);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> remove_provider(<span class="keyword">const</span> std::string&amp; name);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Operation delegation with load balancing</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;CryptoProvider&gt;</a>&gt; get_provider();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;CryptoProvider&gt;</a>&gt; get_provider_for_operation(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; operation_type</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Health monitoring</span></div>
<div class="line">    <span class="keywordtype">void</span> enable_health_monitoring(std::chrono::seconds interval);</div>
<div class="line">    <span class="keywordtype">void</span> disable_health_monitoring();</div>
<div class="line">    std::vector&lt;ProviderHealth&gt; get_provider_health() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Performance metrics</span></div>
<div class="line">    <span class="keyword">struct </span>PerformanceMetrics {</div>
<div class="line">        std::chrono::nanoseconds avg_operation_time;</div>
<div class="line">        <span class="keywordtype">size_t</span> operations_per_second;</div>
<div class="line">        <span class="keywordtype">double</span> success_rate;</div>
<div class="line">        <span class="keywordtype">size_t</span> total_operations;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    PerformanceMetrics get_performance_metrics(<span class="keyword">const</span> std::string&amp; provider) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    ProviderPoolConfig config_;</div>
<div class="line">    std::vector&lt;std::unique_ptr&lt;CryptoProvider&gt;&gt; providers_;</div>
<div class="line">    <span class="keyword">mutable</span> std::mutex providers_mutex_;</div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md17"></a>
Protocol Layer</h1>
<h2><a class="anchor" id="autotoc_md18"></a>
Record Layer Interface</h2>
<p>Low-level record processing:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::v13::protocol {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>RecordLayer {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;RecordLayer&gt;</a>&gt; create(</div>
<div class="line">        std::unique_ptr&lt;crypto::CryptoProvider&gt; crypto_provider</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Record processing</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; encrypt_record(</div>
<div class="line">        <a class="code hl_enumeration" href="types_8h.html#ab9c84107809224041465427557aafdeb">ContentType</a> content_type,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; plaintext,</div>
<div class="line">        <a class="code hl_typedef" href="group__CoreTypes.html#gace5e728a8418b8695b245902009ffa77">Epoch</a> epoch,</div>
<div class="line">        <a class="code hl_typedef" href="group__CoreTypes.html#ga50089dc7f9d67ec4e7563999a0e01a4b">SequenceNumber</a> sequence_number,</div>
<div class="line">        <span class="keyword">const</span> std::optional&lt;ConnectionID&gt;&amp; connection_id = std::nullopt</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;DecryptedRecord&gt;</a> decrypt_record(</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; encrypted_record</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Key management</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> set_write_keys(</div>
<div class="line">        <a class="code hl_typedef" href="group__CoreTypes.html#gace5e728a8418b8695b245902009ffa77">Epoch</a> epoch,</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; write_key,</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; write_iv,</div>
<div class="line">        AEADCipher cipher</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> set_read_keys(</div>
<div class="line">        <a class="code hl_typedef" href="group__CoreTypes.html#gace5e728a8418b8695b245902009ffa77">Epoch</a> epoch,</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; read_key,</div>
<div class="line">        <span class="keyword">const</span> KeyMaterial&amp; read_iv,</div>
<div class="line">        AEADCipher cipher</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> update_keys(<span class="keyword">const</span> KeyMaterial&amp; update_secret);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Sequence number management</span></div>
<div class="line">    <a class="code hl_typedef" href="group__CoreTypes.html#ga50089dc7f9d67ec4e7563999a0e01a4b">SequenceNumber</a> get_next_write_sequence(<a class="code hl_typedef" href="group__CoreTypes.html#gace5e728a8418b8695b245902009ffa77">Epoch</a> epoch);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> validate_read_sequence(</div>
<div class="line">        <a class="code hl_typedef" href="group__CoreTypes.html#gace5e728a8418b8695b245902009ffa77">Epoch</a> epoch,</div>
<div class="line">        <a class="code hl_typedef" href="group__CoreTypes.html#ga50089dc7f9d67ec4e7563999a0e01a4b">SequenceNumber</a> sequence_number</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection ID support</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> set_connection_id(<span class="keyword">const</span> ConnectionID&amp; cid);</div>
<div class="line">    std::optional&lt;ConnectionID&gt; get_connection_id() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Anti-replay protection</span></div>
<div class="line">    <span class="keywordtype">void</span> enable_anti_replay_protection(<span class="keywordtype">size_t</span> window_size = 64);</div>
<div class="line">    <span class="keywordtype">void</span> disable_anti_replay_protection();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    RecordLayer() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>DecryptedRecord {</div>
<div class="line">    <a class="code hl_enumeration" href="types_8h.html#ab9c84107809224041465427557aafdeb">ContentType</a> content_type;</div>
<div class="line">    std::vector&lt;uint8_t&gt; plaintext;</div>
<div class="line">    <a class="code hl_typedef" href="group__CoreTypes.html#gace5e728a8418b8695b245902009ffa77">Epoch</a> epoch;</div>
<div class="line">    <a class="code hl_typedef" href="group__CoreTypes.html#ga50089dc7f9d67ec4e7563999a0e01a4b">SequenceNumber</a> sequence_number;</div>
<div class="line">    std::optional&lt;ConnectionID&gt; connection_id;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="agroup__CoreTypes_html_ga50089dc7f9d67ec4e7563999a0e01a4b"><div class="ttname"><a href="group__CoreTypes.html#ga50089dc7f9d67ec4e7563999a0e01a4b">dtls::v13::SequenceNumber</a></div><div class="ttdeci">uint64_t SequenceNumber</div><div class="ttdoc">64-bit sequence number for replay protection</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00047">types.h:47</a></div></div>
<div class="ttc" id="agroup__CoreTypes_html_gace5e728a8418b8695b245902009ffa77"><div class="ttname"><a href="group__CoreTypes.html#gace5e728a8418b8695b245902009ffa77">dtls::v13::Epoch</a></div><div class="ttdeci">uint16_t Epoch</div><div class="ttdoc">Epoch number for key generation sequencing</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00044">types.h:44</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md19"></a>
Handshake Manager</h2>
<p>High-level handshake protocol management:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>HandshakeManager {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;HandshakeManager&gt;</a>&gt; create_client(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a>&amp; config,</div>
<div class="line">        std::unique_ptr&lt;crypto::CryptoProvider&gt; crypto_provider</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;HandshakeManager&gt;</a>&gt; create_server(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a>&amp; config,</div>
<div class="line">        std::unique_ptr&lt;crypto::CryptoProvider&gt; crypto_provider</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Handshake execution</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> start_handshake();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;HandshakeState&gt;</a> process_message(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; message);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; get_next_message();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// State queries</span></div>
<div class="line">    <span class="keywordtype">bool</span> is_handshake_complete() <span class="keyword">const</span>;</div>
<div class="line">    ConnectionState get_connection_state() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Negotiated parameters</span></div>
<div class="line">    CipherSuite get_negotiated_cipher_suite() <span class="keyword">const</span>;</div>
<div class="line">    <a class="code hl_typedef" href="group__CoreTypes.html#gabc4372b1165cf4e20b612d50ff20e1bb">ProtocolVersion</a> get_negotiated_version() <span class="keyword">const</span>;</div>
<div class="line">    std::optional&lt;ConnectionID&gt; get_negotiated_connection_id() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Session management</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; export_session_ticket();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> import_session_ticket(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; ticket);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Early data support</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> send_early_data(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; receive_early_data();</div>
<div class="line">    <span class="keywordtype">bool</span> is_early_data_accepted() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Key material export</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> export_keying_material(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; label,</div>
<div class="line">        <span class="keywordtype">size_t</span> length,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; context = {}</div>
<div class="line">    ) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Certificate handling</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> set_certificate_chain(</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;std::vector&lt;uint8_t&gt;&gt;&amp; cert_chain</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> set_private_key(<span class="keyword">const</span> KeyMaterial&amp; private_key);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> set_certificate_verify_callback(</div>
<div class="line">        std::function&lt;<span class="keywordtype">bool</span>(<span class="keyword">const</span> std::vector&lt;std::vector&lt;uint8_t&gt;&gt;&amp;)&gt; callback</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    HandshakeManager() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum class</span> HandshakeState {</div>
<div class="line">    IN_PROGRESS,</div>
<div class="line">    COMPLETED,</div>
<div class="line">    FAILED,</div>
<div class="line">    NEED_MORE_DATA,</div>
<div class="line">    EARLY_DATA_READY,</div>
<div class="line">    HELLO_RETRY_REQUEST</div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md20"></a>
Memory Management</h1>
<h2><a class="anchor" id="autotoc_md21"></a>
Buffer Management</h2>
<p>Efficient memory handling for network operations:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13_1_1memory.html">dtls::v13::memory</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Buffer {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Construction</span></div>
<div class="line">    Buffer();</div>
<div class="line">    <span class="keyword">explicit</span> Buffer(<span class="keywordtype">size_t</span> capacity);</div>
<div class="line">    Buffer(<span class="keyword">const</span> uint8_t* data, <span class="keywordtype">size_t</span> size);</div>
<div class="line">    Buffer(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Data access</span></div>
<div class="line">    uint8_t* data();</div>
<div class="line">    <span class="keyword">const</span> uint8_t* data() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">size_t</span> size() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">size_t</span> capacity() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> empty() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Data manipulation</span></div>
<div class="line">    <span class="keywordtype">void</span> resize(<span class="keywordtype">size_t</span> new_size);</div>
<div class="line">    <span class="keywordtype">void</span> reserve(<span class="keywordtype">size_t</span> new_capacity);</div>
<div class="line">    <span class="keywordtype">void</span> clear();</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> append(<span class="keyword">const</span> uint8_t* data, <span class="keywordtype">size_t</span> size);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> append(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> append(<span class="keyword">const</span> Buffer&amp; other);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> prepend(<span class="keyword">const</span> uint8_t* data, <span class="keywordtype">size_t</span> size);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Zero-copy operations</span></div>
<div class="line">    Buffer slice(<span class="keywordtype">size_t</span> offset, <span class="keywordtype">size_t</span> length) <span class="keyword">const</span>;</div>
<div class="line">    std::vector&lt;Buffer&gt; split_at(<span class="keyword">const</span> std::vector&lt;size_t&gt;&amp; offsets) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Security features</span></div>
<div class="line">    <span class="keywordtype">void</span> secure_zero();  <span class="comment">// Secure memory clearing</span></div>
<div class="line">    <span class="keywordtype">bool</span> is_secure() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Conversion</span></div>
<div class="line">    std::vector&lt;uint8_t&gt; to_vector() <span class="keyword">const</span>;</div>
<div class="line">    std::string to_hex_string() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    std::unique_ptr&lt;uint8_t[]&gt; data_;</div>
<div class="line">    <span class="keywordtype">size_t</span> size_;</div>
<div class="line">    <span class="keywordtype">size_t</span> capacity_;</div>
<div class="line">    <span class="keywordtype">bool</span> secure_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>BufferPool {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> BufferPool&amp; instance();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Buffer acquisition and release</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;Buffer&gt;</a> acquire(<span class="keywordtype">size_t</span> min_size);</div>
<div class="line">    <span class="keywordtype">void</span> release(Buffer&amp;&amp; buffer);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Pool configuration</span></div>
<div class="line">    <span class="keywordtype">void</span> set_max_pool_size(<span class="keywordtype">size_t</span> max_buffers);</div>
<div class="line">    <span class="keywordtype">void</span> set_buffer_sizes(<span class="keyword">const</span> std::vector&lt;size_t&gt;&amp; sizes);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span>PoolStats {</div>
<div class="line">        <span class="keywordtype">size_t</span> total_buffers;</div>
<div class="line">        <span class="keywordtype">size_t</span> available_buffers;</div>
<div class="line">        <span class="keywordtype">size_t</span> allocations;</div>
<div class="line">        <span class="keywordtype">size_t</span> deallocations;</div>
<div class="line">        <span class="keywordtype">size_t</span> pool_hits;</div>
<div class="line">        <span class="keywordtype">size_t</span> pool_misses;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    PoolStats get_statistics() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> reset_statistics();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    BufferPool() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1memory_html"><div class="ttname"><a href="namespacedtls_1_1v13_1_1memory.html">dtls::v13::memory</a></div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00054">memory.h:54</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md22"></a>
Error Handling</h1>
<h2><a class="anchor" id="autotoc_md23"></a>
Error Types and Codes</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::v13 {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum class</span> ErrorCode {</div>
<div class="line">    <span class="comment">// Success</span></div>
<div class="line">    SUCCESS = 0,</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Network errors</span></div>
<div class="line">    NETWORK_ERROR = 1000,</div>
<div class="line">    CONNECTION_FAILED,</div>
<div class="line">    CONNECTION_TIMEOUT,</div>
<div class="line">    CONNECTION_CLOSED,</div>
<div class="line">    BIND_FAILED,</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Protocol errors</span></div>
<div class="line">    PROTOCOL_ERROR = 2000,</div>
<div class="line">    INVALID_MESSAGE,</div>
<div class="line">    INVALID_VERSION,</div>
<div class="line">    UNSUPPORTED_CIPHER_SUITE,</div>
<div class="line">    HANDSHAKE_FAILED,</div>
<div class="line">    CERTIFICATE_ERROR,</div>
<div class="line">    SIGNATURE_VERIFICATION_FAILED,</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Cryptographic errors</span></div>
<div class="line">    CRYPTO_ERROR = 3000,</div>
<div class="line">    KEY_GENERATION_FAILED,</div>
<div class="line">    ENCRYPTION_FAILED,</div>
<div class="line">    DECRYPTION_FAILED,</div>
<div class="line">    SIGNATURE_FAILED,</div>
<div class="line">    HASH_FAILED,</div>
<div class="line">    RANDOM_GENERATION_FAILED,</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Memory errors</span></div>
<div class="line">    MEMORY_ERROR = 4000,</div>
<div class="line">    OUT_OF_MEMORY,</div>
<div class="line">    BUFFER_OVERFLOW,</div>
<div class="line">    INVALID_BUFFER_SIZE,</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration errors</span></div>
<div class="line">    CONFIG_ERROR = 5000,</div>
<div class="line">    INVALID_CONFIGURATION,</div>
<div class="line">    MISSING_CONFIGURATION,</div>
<div class="line">    UNSUPPORTED_FEATURE</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Error {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    Error(ErrorCode code, <span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    Error(ErrorCode code, <span class="keyword">const</span> std::string&amp; message, </div>
<div class="line">          <span class="keyword">const</span> std::string&amp; detail);</div>
<div class="line">    </div>
<div class="line">    ErrorCode code() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keyword">const</span> std::string&amp; message() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keyword">const</span> std::string&amp; detail() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Error chaining</span></div>
<div class="line">    Error&amp; caused_by(<span class="keyword">const</span> Error&amp; cause);</div>
<div class="line">    <span class="keyword">const</span> Error* get_cause() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// String representation</span></div>
<div class="line">    std::string to_string() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Predefined error creators</span></div>
<div class="line">    <span class="keyword">static</span> Error network_error(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keyword">static</span> Error protocol_error(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keyword">static</span> Error crypto_error(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keyword">static</span> Error memory_error(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keyword">static</span> Error config_error(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    ErrorCode code_;</div>
<div class="line">    std::string message_;</div>
<div class="line">    std::string detail_;</div>
<div class="line">    std::unique_ptr&lt;Error&gt; cause_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24"></a>
Error Recovery</h2>
<p>Advanced error handling and recovery mechanisms:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structdtls_1_1v13_1_1ErrorRecoveryConfig.html">ErrorRecoveryConfig</a> {</div>
<div class="line">    uint32_t max_retries = 3;</div>
<div class="line">    std::chrono::milliseconds initial_retry_delay{1000};</div>
<div class="line">    std::chrono::milliseconds max_retry_delay{30000};</div>
<div class="line">    <span class="keywordtype">double</span> backoff_multiplier = 2.0;</div>
<div class="line">    </div>
<div class="line">    uint32_t max_consecutive_errors = 10;</div>
<div class="line">    uint32_t max_errors_per_minute = 50;</div>
<div class="line">    uint32_t degraded_mode_threshold = 5;</div>
<div class="line">    </div>
<div class="line">    RecoveryStrategy handshake_error_strategy = RecoveryStrategy::RETRY_WITH_BACKOFF;</div>
<div class="line">    RecoveryStrategy crypto_error_strategy = RecoveryStrategy::RETRY_IMMEDIATE;</div>
<div class="line">    RecoveryStrategy network_error_strategy = RecoveryStrategy::RETRY_WITH_BACKOFF;</div>
<div class="line">    RecoveryStrategy protocol_error_strategy = RecoveryStrategy::RESET_CONNECTION;</div>
<div class="line">    </div>
<div class="line">    std::chrono::seconds health_check_interval{60};</div>
<div class="line">    std::chrono::seconds error_rate_window{60};</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">bool</span> enable_automatic_recovery = <span class="keyword">true</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum class</span> RecoveryStrategy {</div>
<div class="line">    NONE,                    <span class="comment">// No recovery attempt</span></div>
<div class="line">    RETRY_IMMEDIATE,         <span class="comment">// Immediate retry</span></div>
<div class="line">    RETRY_WITH_BACKOFF,      <span class="comment">// Exponential backoff retry</span></div>
<div class="line">    GRACEFUL_DEGRADATION,    <span class="comment">// Reduce functionality</span></div>
<div class="line">    RESET_CONNECTION,        <span class="comment">// Reset and reconnect</span></div>
<div class="line">    FAILOVER,               <span class="comment">// Switch to backup</span></div>
<div class="line">    ABORT_CONNECTION        <span class="comment">// Terminate connection</span></div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md25"></a>
Configuration</h1>
<h2><a class="anchor" id="autotoc_md26"></a>
System Configuration</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::v13::config {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>SystemConfig {</div>
<div class="line">    <span class="comment">// Threading configuration</span></div>
<div class="line">    uint32_t worker_threads = std::thread::hardware_concurrency();</div>
<div class="line">    <span class="keywordtype">bool</span> enable_thread_pool = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">size_t</span> max_concurrent_handshakes = 1000;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Memory configuration</span></div>
<div class="line">    <span class="keywordtype">size_t</span> default_buffer_size = 16384;</div>
<div class="line">    <span class="keywordtype">size_t</span> max_buffer_pool_size = 10000;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_secure_memory = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_memory_debugging = <span class="keyword">false</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Security configuration</span></div>
<div class="line">    SecurityLevel default_security_level = SecurityLevel::HIGH;</div>
<div class="line">    <span class="keywordtype">bool</span> enforce_perfect_forward_secrecy = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> allow_weak_cipher_suites = <span class="keyword">false</span>;</div>
<div class="line">    std::chrono::seconds session_ticket_lifetime{7200};</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Performance configuration</span></div>
<div class="line">    <span class="keywordtype">bool</span> enable_zero_copy_operations = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_hardware_acceleration = <span class="keyword">true</span>;</div>
<div class="line">    uint32_t max_connections_per_thread = 100;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Logging and monitoring</span></div>
<div class="line">    LogLevel default_log_level = LogLevel::INFO;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_performance_metrics = <span class="keyword">true</span>;</div>
<div class="line">    std::chrono::seconds metrics_collection_interval{60};</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Load from configuration file</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;SystemConfig&gt;</a> from_file(<span class="keyword">const</span> std::string&amp; config_path);</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;SystemConfig&gt;</a> from_json(<span class="keyword">const</span> std::string&amp; json_config);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Validation</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> validate() <span class="keyword">const</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Global configuration access</span></div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> set_global_config(<span class="keyword">const</span> SystemConfig&amp; config);</div>
<div class="line"><span class="keyword">const</span> SystemConfig&amp; get_global_config();</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md27"></a>
Performance Monitoring</h1>
<h2><a class="anchor" id="autotoc_md28"></a>
Metrics Collection</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::v13::monitoring {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>ConnectionMetrics {</div>
<div class="line">    <span class="comment">// Timing metrics</span></div>
<div class="line">    std::chrono::nanoseconds handshake_time;</div>
<div class="line">    std::chrono::nanoseconds avg_round_trip_time;</div>
<div class="line">    std::chrono::nanoseconds crypto_operation_time;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Throughput metrics</span></div>
<div class="line">    uint64_t bytes_sent;</div>
<div class="line">    uint64_t bytes_received;</div>
<div class="line">    uint32_t records_sent;</div>
<div class="line">    uint32_t records_received;</div>
<div class="line">    <span class="keywordtype">double</span> throughput_mbps;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Error metrics</span></div>
<div class="line">    uint32_t handshake_failures;</div>
<div class="line">    uint32_t crypto_errors;</div>
<div class="line">    uint32_t network_errors;</div>
<div class="line">    uint32_t protocol_errors;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Security metrics</span></div>
<div class="line">    uint32_t replay_attacks_blocked;</div>
<div class="line">    uint32_t invalid_signatures;</div>
<div class="line">    uint32_t certificate_failures;</div>
<div class="line">    uint32_t dos_attacks_blocked;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>SystemMetrics {</div>
<div class="line">    <span class="comment">// Resource utilization</span></div>
<div class="line">    <span class="keywordtype">double</span> cpu_usage_percent;</div>
<div class="line">    <span class="keywordtype">size_t</span> memory_usage_bytes;</div>
<div class="line">    uint32_t active_connections;</div>
<div class="line">    uint32_t pending_handshakes;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Performance metrics</span></div>
<div class="line">    uint32_t connections_per_second;</div>
<div class="line">    uint32_t handshakes_per_second;</div>
<div class="line">    <span class="keywordtype">double</span> avg_handshake_time_ms;</div>
<div class="line">    <span class="keywordtype">double</span> avg_throughput_mbps;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// System health</span></div>
<div class="line">    uint32_t total_errors_per_minute;</div>
<div class="line">    <span class="keywordtype">double</span> error_rate_percent;</div>
<div class="line">    uint32_t degraded_connections;</div>
<div class="line">    uint32_t failed_connections;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>MetricsCollector {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> MetricsCollector&amp; instance();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Metrics collection</span></div>
<div class="line">    <span class="keywordtype">void</span> record_handshake_time(std::chrono::nanoseconds duration);</div>
<div class="line">    <span class="keywordtype">void</span> record_bytes_transferred(<span class="keywordtype">size_t</span> bytes, <span class="keywordtype">bool</span> sent);</div>
<div class="line">    <span class="keywordtype">void</span> record_error(ErrorCode error_code);</div>
<div class="line">    <span class="keywordtype">void</span> record_crypto_operation_time(std::chrono::nanoseconds duration);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Metrics retrieval</span></div>
<div class="line">    ConnectionMetrics get_connection_metrics(<span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp; connection) <span class="keyword">const</span>;</div>
<div class="line">    SystemMetrics get_system_metrics() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Reporting</span></div>
<div class="line">    std::string generate_metrics_report() <span class="keyword">const</span>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> export_metrics_to_file(<span class="keyword">const</span> std::string&amp; filepath) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration</span></div>
<div class="line">    <span class="keywordtype">void</span> set_collection_interval(std::chrono::seconds interval);</div>
<div class="line">    <span class="keywordtype">void</span> enable_detailed_metrics(<span class="keywordtype">bool</span> enable);</div>
<div class="line">    <span class="keywordtype">void</span> reset_all_metrics();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    MetricsCollector() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md29"></a>
Security Features</h1>
<h2><a class="anchor" id="autotoc_md30"></a>
DoS Protection</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::v13::security {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>DoSProtection {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">struct </span>DoSConfig {</div>
<div class="line">        <span class="comment">// Rate limiting</span></div>
<div class="line">        uint32_t max_connections_per_ip = 100;</div>
<div class="line">        uint32_t max_handshakes_per_second = 1000;</div>
<div class="line">        uint32_t max_requests_per_minute = 60000;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Resource limits</span></div>
<div class="line">        <span class="keywordtype">size_t</span> max_memory_per_connection = 65536;</div>
<div class="line">        <span class="keywordtype">size_t</span> max_total_memory = 100 * 1024 * 1024;  <span class="comment">// 100MB</span></div>
<div class="line">        uint32_t max_concurrent_handshakes = 10000;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Cookie verification</span></div>
<div class="line">        <span class="keywordtype">bool</span> enable_cookie_verification = <span class="keyword">true</span>;</div>
<div class="line">        std::chrono::seconds cookie_lifetime{300};</div>
<div class="line">        <span class="keywordtype">size_t</span> cookie_key_rotation_interval = 3600;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Timeout protection</span></div>
<div class="line">        std::chrono::seconds connection_timeout{300};</div>
<div class="line">        std::chrono::seconds handshake_timeout{30};</div>
<div class="line">        std::chrono::seconds idle_timeout{900};</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">explicit</span> DoSProtection(<span class="keyword">const</span> DoSConfig&amp; config);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Request validation</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> should_accept_connection(<span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; client_addr);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> validate_handshake_rate(<span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; client_addr);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> check_resource_limits() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Cookie verification</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; generate_cookie(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; client_addr,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; client_hello</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> verify_cookie(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; client_addr,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; client_hello,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; cookie</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span>DoSStats {</div>
<div class="line">        uint64_t total_connections_blocked;</div>
<div class="line">        uint64_t rate_limited_requests;</div>
<div class="line">        uint64_t cookie_verification_failures;</div>
<div class="line">        uint64_t resource_limit_violations;</div>
<div class="line">        uint32_t currently_blocked_ips;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    DoSStats <a class="code hl_function" href="classdtls_1_1v13_1_1security_1_1DoSProtection.html#a1cd1e9babaec1a647306787958885da1">get_statistics</a>() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> reset_statistics();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    DoSConfig config_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="aclassdtls_1_1v13_1_1security_1_1DoSProtection_html_a1cd1e9babaec1a647306787958885da1"><div class="ttname"><a href="classdtls_1_1v13_1_1security_1_1DoSProtection.html#a1cd1e9babaec1a647306787958885da1">dtls::v13::security::DoSProtection::get_statistics</a></div><div class="ttdeci">DoSProtectionStats get_statistics() const</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md31"></a>
Examples</h1>
<h2><a class="anchor" id="autotoc_md32"></a>
Complete Client Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;dtls/dtls.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">using namespace </span>dtls::v13;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        <span class="comment">// Initialize crypto provider</span></div>
<div class="line">        <span class="keyword">auto</span>&amp; factory = crypto::ProviderFactory::instance();</div>
<div class="line">        <span class="keyword">auto</span> crypto_result = factory.create_provider(<span class="stringliteral">&quot;openssl&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (!crypto_result) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to create crypto provider: &quot;</span> </div>
<div class="line">                      &lt;&lt; crypto_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Configure connection</span></div>
<div class="line">        <span class="keyword">auto</span> config = ConnectionConfig::default_client_config();</div>
<div class="line">        config.enable_early_data = <span class="keyword">true</span>;</div>
<div class="line">        config.handshake_timeout = std::chrono::seconds(10);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Create connection</span></div>
<div class="line">        <span class="keyword">auto</span> server_addr = NetworkAddress::from_string(<span class="stringliteral">&quot;example.com:4433&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (!server_addr) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Invalid server address&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">auto</span> conn_result = Connection::create_client(</div>
<div class="line">            *server_addr, config, std::move(*crypto_result)</div>
<div class="line">        );</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (!conn_result) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to create connection: &quot;</span> </div>
<div class="line">                      &lt;&lt; conn_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">auto</span> connection = std::move(*conn_result);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Set up event handling</span></div>
<div class="line">        connection-&gt;set_event_callback([](ConnectionEvent event, <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp; conn) {</div>
<div class="line">            <span class="keywordflow">switch</span> (event) {</div>
<div class="line">                <span class="keywordflow">case</span> ConnectionEvent::HANDSHAKE_COMPLETED:</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;Handshake completed successfully!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;Cipher suite: &quot;</span> </div>
<div class="line">                              &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(conn.get_negotiated_cipher_suite()) </div>
<div class="line">                              &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">case</span> ConnectionEvent::DATA_RECEIVED:</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;Data received from server&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">case</span> ConnectionEvent::ERROR_OCCURRED:</div>
<div class="line">                    std::cerr &lt;&lt; <span class="stringliteral">&quot;Connection error occurred&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                    </div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        });</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Perform handshake</span></div>
<div class="line">        <span class="keyword">auto</span> handshake_result = connection-&gt;handshake();</div>
<div class="line">        <span class="keywordflow">if</span> (!handshake_result) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Handshake failed: &quot;</span> </div>
<div class="line">                      &lt;&lt; handshake_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Send HTTP request</span></div>
<div class="line">        std::string http_request = </div>
<div class="line">            <span class="stringliteral">&quot;GET / HTTP/1.1\r\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;Host: example.com\r\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;Connection: close\r\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line">        </div>
<div class="line">        std::vector&lt;uint8_t&gt; request_data(http_request.begin(), http_request.end());</div>
<div class="line">        <span class="keyword">auto</span> send_result = connection-&gt;send(request_data);</div>
<div class="line">        <span class="keywordflow">if</span> (!send_result) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to send data: &quot;</span> </div>
<div class="line">                      &lt;&lt; send_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Sent &quot;</span> &lt;&lt; *send_result &lt;&lt; <span class="stringliteral">&quot; bytes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Receive response</span></div>
<div class="line">        <span class="keyword">auto</span> response_result = connection-&gt;receive();</div>
<div class="line">        <span class="keywordflow">if</span> (!response_result) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to receive data: &quot;</span> </div>
<div class="line">                      &lt;&lt; response_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Received &quot;</span> &lt;&lt; response_result-&gt;size() &lt;&lt; <span class="stringliteral">&quot; bytes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::string response(response_result-&gt;begin(), response_result-&gt;end());</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Response: &quot;</span> &lt;&lt; response &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Print connection statistics</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; stats = connection-&gt;get_statistics();</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Connection Statistics:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  Handshake duration: &quot;</span> </div>
<div class="line">                  &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div>
<div class="line">                      stats.handshake_duration).count() &lt;&lt; <span class="stringliteral">&quot;ms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  Bytes sent: &quot;</span> &lt;&lt; stats.bytes_sent &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  Bytes received: &quot;</span> &lt;&lt; stats.bytes_received &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  Records sent: &quot;</span> &lt;&lt; stats.records_sent &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  Records received: &quot;</span> &lt;&lt; stats.records_received &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Close connection gracefully</span></div>
<div class="line">        <span class="keyword">auto</span> close_result = connection-&gt;close();</div>
<div class="line">        <span class="keywordflow">if</span> (!close_result) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to close connection properly&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md33"></a>
Complete Server Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;dtls/dtls.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;thread&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"> </div>
<div class="line">std::atomic&lt;bool&gt; g_running{<span class="keyword">true</span>};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> signal_handler(<span class="keywordtype">int</span> signal) {</div>
<div class="line">    <span class="keywordflow">if</span> (signal == SIGINT || signal == SIGTERM) {</div>
<div class="line">        g_running = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>EchoServer {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    std::unique_ptr&lt;dtls::v13::ConnectionManager&gt; manager_;</div>
<div class="line">    std::vector&lt;std::shared_ptr&lt;dtls::v13::Connection&gt;&gt; active_connections_;</div>
<div class="line">    std::mutex connections_mutex_;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> start(<span class="keyword">const</span> std::string&amp; bind_address) {</div>
<div class="line">        <span class="keyword">using namespace </span>dtls::v13;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Configure server</span></div>
<div class="line">        <span class="keyword">auto</span> config = ConnectionConfig::default_server_config();</div>
<div class="line">        config.max_early_data_size = 16384;</div>
<div class="line">        config.enable_connection_id = <span class="keyword">true</span>;</div>
<div class="line">        config.connection_id_length = 8;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Create connection manager</span></div>
<div class="line">        <span class="keyword">auto</span> manager_result = ConnectionManager::create(config);</div>
<div class="line">        <span class="keywordflow">if</span> (!manager_result) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to create connection manager: &quot;</span> </div>
<div class="line">                      &lt;&lt; manager_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        manager_ = std::move(*manager_result);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Set up event callbacks</span></div>
<div class="line">        manager_-&gt;set_event_callback([<span class="keyword">this</span>](ConnectionEvent event, <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp; conn) {</div>
<div class="line">            this-&gt;handle_connection_event(event, conn);</div>
<div class="line">        });</div>
<div class="line">        </div>
<div class="line">        manager_-&gt;set_new_connection_callback([<span class="keyword">this</span>](std::shared_ptr&lt;Connection&gt; conn) {</div>
<div class="line">            this-&gt;handle_new_connection(std::move(conn));</div>
<div class="line">        });</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Bind to address</span></div>
<div class="line">        <span class="keyword">auto</span> addr_result = NetworkAddress::from_string(bind_address);</div>
<div class="line">        <span class="keywordflow">if</span> (!addr_result) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Invalid bind address: &quot;</span> &lt;&lt; bind_address &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">auto</span> bind_result = manager_-&gt;bind(*addr_result);</div>
<div class="line">        <span class="keywordflow">if</span> (!bind_result) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to bind to &quot;</span> &lt;&lt; bind_address &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> </div>
<div class="line">                      &lt;&lt; bind_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;DTLS server listening on &quot;</span> &lt;&lt; bind_address &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Start server loop</span></div>
<div class="line">        manager_-&gt;run();</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> stop() {</div>
<div class="line">        <span class="keywordflow">if</span> (manager_) {</div>
<div class="line">            manager_-&gt;stop();</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        std::lock_guard&lt;std::mutex&gt; lock(connections_mutex_);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; conn : active_connections_) {</div>
<div class="line">            conn-&gt;close();</div>
<div class="line">        }</div>
<div class="line">        active_connections_.clear();</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> handle_connection_event(dtls::v13::ConnectionEvent event, </div>
<div class="line">                                 <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">dtls::v13::Connection</a>&amp; conn) {</div>
<div class="line">        <span class="keyword">using namespace </span>dtls::v13;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">switch</span> (event) {</div>
<div class="line">            <span class="keywordflow">case</span> ConnectionEvent::HANDSHAKE_COMPLETED:</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Client handshake completed&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">            <span class="keywordflow">case</span> ConnectionEvent::DATA_RECEIVED: {</div>
<div class="line">                <span class="comment">// Echo received data back to client</span></div>
<div class="line">                <span class="keyword">auto</span> data_result = <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp;<span class="keyword">&gt;</span>(conn).receive();</div>
<div class="line">                <span class="keywordflow">if</span> (data_result) {</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;Received &quot;</span> &lt;&lt; data_result-&gt;size() </div>
<div class="line">                              &lt;&lt; <span class="stringliteral">&quot; bytes from client&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">// Echo the data back</span></div>
<div class="line">                    <span class="keyword">auto</span> send_result = <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp;<span class="keyword">&gt;</span>(conn).send(*data_result);</div>
<div class="line">                    <span class="keywordflow">if</span> (!send_result) {</div>
<div class="line">                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to echo data: &quot;</span> </div>
<div class="line">                                  &lt;&lt; send_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">                    } <span class="keywordflow">else</span> {</div>
<div class="line">                        std::cout &lt;&lt; <span class="stringliteral">&quot;Echoed &quot;</span> &lt;&lt; *send_result &lt;&lt; <span class="stringliteral">&quot; bytes back&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">case</span> ConnectionEvent::CONNECTION_CLOSED:</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Client disconnected&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                remove_connection(conn);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">            <span class="keywordflow">case</span> ConnectionEvent::ERROR_OCCURRED:</div>
<div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;Connection error occurred&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                remove_connection(conn);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">            <span class="keywordflow">case</span> ConnectionEvent::EARLY_DATA_RECEIVED:</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Early data received from client&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> handle_new_connection(std::shared_ptr&lt;dtls::v13::Connection&gt; conn) {</div>
<div class="line">        std::lock_guard&lt;std::mutex&gt; lock(connections_mutex_);</div>
<div class="line">        active_connections_.push_back(std::move(conn));</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;New client connected. Total connections: &quot;</span> </div>
<div class="line">                  &lt;&lt; active_connections_.size() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> remove_connection(<span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">dtls::v13::Connection</a>&amp; conn) {</div>
<div class="line">        std::lock_guard&lt;std::mutex&gt; lock(connections_mutex_);</div>
<div class="line">        active_connections_.erase(</div>
<div class="line">            std::remove_if(active_connections_.begin(), active_connections_.end(),</div>
<div class="line">                [&amp;conn](<span class="keyword">const</span> std::weak_ptr&lt;dtls::v13::Connection&gt;&amp; weak_conn) {</div>
<div class="line">                    auto shared_conn = weak_conn.lock();</div>
<div class="line">                    return !shared_conn || shared_conn.get() == &amp;conn;</div>
<div class="line">                }),</div>
<div class="line">            active_connections_.end()</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    <span class="comment">// Set up signal handling</span></div>
<div class="line">    signal(SIGINT, signal_handler);</div>
<div class="line">    signal(SIGTERM, signal_handler);</div>
<div class="line">    </div>
<div class="line">    std::string bind_address = <span class="stringliteral">&quot;0.0.0.0:4433&quot;</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (argc &gt; 1) {</div>
<div class="line">        bind_address = argv[1];</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    EchoServer server;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (!server.start(bind_address)) {</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Wait for shutdown signal</span></div>
<div class="line">    <span class="keywordflow">while</span> (g_running) {</div>
<div class="line">        std::this_thread::sleep_for(std::chrono::milliseconds(100));</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Shutting down server...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    server.stop();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md34"></a>
Early Data (0-RTT) Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;dtls/dtls.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">using namespace </span>dtls::v13;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configure client with early data support</span></div>
<div class="line">    <span class="keyword">auto</span> config = ConnectionConfig::default_client_config();</div>
<div class="line">    config.enable_early_data = <span class="keyword">true</span>;</div>
<div class="line">    config.max_early_data_size = 16384;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">auto</span> crypto_result = crypto::ProviderFactory::instance().create_provider(<span class="stringliteral">&quot;openssl&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span> addr_result = NetworkAddress::from_string(<span class="stringliteral">&quot;example.com:4433&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">auto</span> conn_result = Connection::create_client(</div>
<div class="line">        *addr_result, config, std::move(*crypto_result)</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">auto</span> connection = std::move(*conn_result);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// For 0-RTT, we need a previously established session</span></div>
<div class="line">    <span class="comment">// In practice, this would be loaded from storage</span></div>
<div class="line">    std::vector&lt;uint8_t&gt; session_ticket = load_previous_session_ticket();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (!session_ticket.empty()) {</div>
<div class="line">        <span class="comment">// Import previous session for resumption</span></div>
<div class="line">        <span class="keyword">auto</span> handshake_mgr = HandshakeManager::create_client(config, </div>
<div class="line">                                crypto::ProviderFactory::instance().create_provider(<span class="stringliteral">&quot;openssl&quot;</span>).value());</div>
<div class="line">        <span class="keyword">auto</span> import_result = handshake_mgr-&gt;import_session_ticket(session_ticket);</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (import_result) {</div>
<div class="line">            <span class="comment">// Send early data before completing handshake</span></div>
<div class="line">            std::string early_data = <span class="stringliteral">&quot;GET /early HTTP/1.1\r\nHost: example.com\r\n\r\n&quot;</span>;</div>
<div class="line">            std::vector&lt;uint8_t&gt; early_data_bytes(early_data.begin(), early_data.end());</div>
<div class="line">            </div>
<div class="line">            <span class="keyword">auto</span> early_send_result = connection-&gt;send_early_data(early_data_bytes);</div>
<div class="line">            <span class="keywordflow">if</span> (early_send_result) {</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Sent &quot;</span> &lt;&lt; *early_send_result &lt;&lt; <span class="stringliteral">&quot; bytes as early data&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Complete handshake</span></div>
<div class="line">    <span class="keyword">auto</span> handshake_result = connection-&gt;handshake();</div>
<div class="line">    <span class="keywordflow">if</span> (!handshake_result) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Handshake failed: &quot;</span> &lt;&lt; handshake_result.error().message() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Check if early data was accepted</span></div>
<div class="line">    <span class="keywordflow">if</span> (connection-&gt;is_early_data_accepted()) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Early data was accepted by server!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Early data was rejected, need to resend&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="comment">// Resend the data in normal mode</span></div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">std::vector&lt;uint8_t&gt; load_previous_session_ticket() {</div>
<div class="line">    <span class="comment">// Implementation would load from persistent storage</span></div>
<div class="line">    <span class="comment">// Return empty vector if no previous session available</span></div>
<div class="line">    <span class="keywordflow">return</span> {};</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md36"></a>
License</h1>
<p>This API documentation is part of the DTLS v1.3 implementation project.</p>
<h1><a class="anchor" id="autotoc_md37"></a>
Support</h1>
<p>For questions about API usage, please refer to the examples above or consult the project documentation. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>

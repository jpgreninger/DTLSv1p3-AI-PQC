<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DTLS v1.3 Implementation: dtls::v13::core_protocol::AntiReplayCore Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--BEGIN TREEVIEW-->
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<!--END TREEVIEW-->
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<!--BEGIN EXTRA_STYLESHEET-->
<link href="$extra_stylesheet" rel="stylesheet" type="text/css"/>
<!--END EXTRA_STYLESHEET-->
<!--BEGIN FORMULA_MACROS-->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { fonts: ["TeX"] }
  });
</script>
<!--END FORMULA_MACROS-->
<script type="text/javascript" async="async" src="path"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectname">DTLS v1.3 Implementation
  <span id="projectnumber">&#160;1.0.0</span>
  </td>
   <td>        ðŸ”’ Enterprise-grade DTLS v1.3 implementation with SystemC TLM modeling and comprehensive security features</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Doxygen Awesome features initialization -->
<script type="text/javascript">
    // Initialize doxygen-awesome features when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        // Enable dark mode toggle if available
        if (typeof doxygen_awesome_dark_mode_toggle !== 'undefined') {
            doxygen_awesome_dark_mode_toggle.init();
        }
        // Enable fragment copy button if available
        if (typeof doxygen_awesome_fragment_copy_button !== 'undefined') {
            doxygen_awesome_fragment_copy_button.init();
        }
        // Enable paragraph link if available
        if (typeof doxygen_awesome_paragraph_link !== 'undefined') {
            doxygen_awesome_paragraph_link.init();
        }
        // Enable interactive TOC if available
        if (typeof doxygen_awesome_interactive_toc !== 'undefined') {
            doxygen_awesome_interactive_toc.init();
        }
        // Enable tabs if available
        if (typeof doxygen_awesome_tabs !== 'undefined') {
            doxygen_awesome_tabs.init();
        }
    });
</script><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">dtls::v13::core_protocol::AntiReplayCore Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="anti__replay__core_8h_source.html">anti_replay_core.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowStats.html">WindowStats</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ac3e139f0a7b57f1cb5cc72a6af1add06" id="r_ac3e139f0a7b57f1cb5cc72a6af1add06"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore.html#ac3e139f0a7b57f1cb5cc72a6af1add06">is_valid_sequence_number</a> (uint64_t sequence_number, const <a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a> &amp;state)</td></tr>
<tr class="separator:ac3e139f0a7b57f1cb5cc72a6af1add06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bc4dda44bb18c08e334f589a0e9cb7d" id="r_a7bc4dda44bb18c08e334f589a0e9cb7d"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore.html#a7bc4dda44bb18c08e334f589a0e9cb7d">update_window</a> (uint64_t sequence_number, <a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a> &amp;state)</td></tr>
<tr class="separator:a7bc4dda44bb18c08e334f589a0e9cb7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae87d44fc5354d92bcb76ad032a0d848a" id="r_ae87d44fc5354d92bcb76ad032a0d848a"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore.html#ae87d44fc5354d92bcb76ad032a0d848a">check_and_update</a> (uint64_t sequence_number, <a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a> &amp;state)</td></tr>
<tr class="separator:ae87d44fc5354d92bcb76ad032a0d848a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa5c9550b0bf273b2a0c0534d5386a3a" id="r_afa5c9550b0bf273b2a0c0534d5386a3a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore.html#afa5c9550b0bf273b2a0c0534d5386a3a">reset_window</a> (<a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a> &amp;state)</td></tr>
<tr class="separator:afa5c9550b0bf273b2a0c0534d5386a3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9407770de88eeff33d196b1e090f9ad" id="r_ad9407770de88eeff33d196b1e090f9ad"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore.html#ad9407770de88eeff33d196b1e090f9ad">get_window_utilization</a> (const <a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a> &amp;state)</td></tr>
<tr class="separator:ad9407770de88eeff33d196b1e090f9ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa08bc472a48101c3f4a0b18ceeb7fa55" id="r_aa08bc472a48101c3f4a0b18ceeb7fa55"><td class="memItemLeft" align="right" valign="top"><a id="aa08bc472a48101c3f4a0b18ceeb7fa55" name="aa08bc472a48101c3f4a0b18ceeb7fa55"></a>
static <a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowStats.html">WindowStats</a>&#160;</td><td class="memItemRight" valign="bottom"><b>get_stats</b> (const <a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a> &amp;state)</td></tr>
<tr class="separator:aa08bc472a48101c3f4a0b18ceeb7fa55"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a23d800567984fe3e410b11f808b5de01" id="r_a23d800567984fe3e410b11f808b5de01"><td class="memItemLeft" align="right" valign="top">static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore.html#a23d800567984fe3e410b11f808b5de01">DEFAULT_WINDOW_SIZE</a> = 64</td></tr>
<tr class="separator:a23d800567984fe3e410b11f808b5de01"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Pure Anti-Replay Logic Core</p>
<p>Contains the core sliding window algorithm for replay detection with no dependencies on threading, SystemC, or networking. This implementation is used by both the production library and SystemC TLM model to ensure consistency.</p>
<p>Thread-safety: This class is NOT thread-safe by design. Users must provide their own synchronization if needed. </p>

<p class="definition">Definition at line <a class="el" href="anti__replay__core_8h_source.html#l00019">19</a> of file <a class="el" href="anti__replay__core_8h_source.html">anti_replay_core.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ae87d44fc5354d92bcb76ad032a0d848a" name="ae87d44fc5354d92bcb76ad032a0d848a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae87d44fc5354d92bcb76ad032a0d848a">&#9670;&#160;</a></span>check_and_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool dtls::v13::core_protocol::AntiReplayCore::check_and_update </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>sequence_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check and update in single operation (convenience method)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sequence_number</td><td>The sequence number to check and potentially mark </td></tr>
    <tr><td class="paramname">state</td><td>Window state to check and update </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if valid and marked, false if replay detected </dd></dl>

</div>
</div>
<a id="ad9407770de88eeff33d196b1e090f9ad" name="ad9407770de88eeff33d196b1e090f9ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9407770de88eeff33d196b1e090f9ad">&#9670;&#160;</a></span>get_window_utilization()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double dtls::v13::core_protocol::AntiReplayCore::get_window_utilization </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get window utilization ratio (0.0 to 1.0) </p>

</div>
</div>
<a id="ac3e139f0a7b57f1cb5cc72a6af1add06" name="ac3e139f0a7b57f1cb5cc72a6af1add06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3e139f0a7b57f1cb5cc72a6af1add06">&#9670;&#160;</a></span>is_valid_sequence_number()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool dtls::v13::core_protocol::AntiReplayCore::is_valid_sequence_number </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>sequence_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if sequence number is valid (not a replay) Does not modify state - use <a class="el" href="classdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore.html#a7bc4dda44bb18c08e334f589a0e9cb7d">update_window()</a> to record receipt</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sequence_number</td><td>The sequence number to check </td></tr>
    <tr><td class="paramname">state</td><td>Current window state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if valid, false if replay detected </dd></dl>

</div>
</div>
<a id="afa5c9550b0bf273b2a0c0534d5386a3a" name="afa5c9550b0bf273b2a0c0534d5386a3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa5c9550b0bf273b2a0c0534d5386a3a">&#9670;&#160;</a></span>reset_window()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void dtls::v13::core_protocol::AntiReplayCore::reset_window </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reset window state (for epoch changes) </p>

</div>
</div>
<a id="a7bc4dda44bb18c08e334f589a0e9cb7d" name="a7bc4dda44bb18c08e334f589a0e9cb7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bc4dda44bb18c08e334f589a0e9cb7d">&#9670;&#160;</a></span>update_window()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool dtls::v13::core_protocol::AntiReplayCore::update_window </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>sequence_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore_1_1WindowState.html">WindowState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update window state to mark sequence number as received This should only be called after <a class="el" href="classdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore.html#ac3e139f0a7b57f1cb5cc72a6af1add06">is_valid_sequence_number()</a> returns true</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sequence_number</td><td>The sequence number to mark as received </td></tr>
    <tr><td class="paramname">state</td><td>Window state to update </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if state was updated, false on error </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a23d800567984fe3e410b11f808b5de01" name="a23d800567984fe3e410b11f808b5de01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23d800567984fe3e410b11f808b5de01">&#9670;&#160;</a></span>DEFAULT_WINDOW_SIZE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t dtls::v13::core_protocol::AntiReplayCore::DEFAULT_WINDOW_SIZE = 64</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="anti__replay__core_8h_source.html#l00021">21</a> of file <a class="el" href="anti__replay__core_8h_source.html">anti_replay_core.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>dtls/core_protocol/<a class="el" href="anti__replay__core_8h_source.html">anti_replay_core.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedtls.html">dtls</a></li><li class="navelem"><b>v13</b></li><li class="navelem"><b>core_protocol</b></li><li class="navelem"><a class="el" href="classdtls_1_1v13_1_1core__protocol_1_1AntiReplayCore.html">AntiReplayCore</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>

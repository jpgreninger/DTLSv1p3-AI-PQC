<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DTLS v1.3 Implementation: DTLS v1.3 Error Handling System Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DTLS v1.3 Implementation<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Production-ready DTLS v1.3 implementation with RFC 9147 compliance and quantum-resistant cryptography</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_2ERROR__HANDLING.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">DTLS v1.3 Error Handling System Documentation</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md370"></a> </p>
<h1><a class="anchor" id="autotoc_md371"></a>
Overview</h1>
<p>This document describes the comprehensive error handling system implemented for DTLS v1.3 protocol compliance with RFC 9147. The system provides consistent error processing, secure diagnostic information, and RFC-compliant alert generation while maintaining security and performance requirements.</p>
<h1><a class="anchor" id="autotoc_md372"></a>
Architecture</h1>
<h2><a class="anchor" id="autotoc_md373"></a>
Core Components</h2>
<ol type="1">
<li><b>ErrorHandler</b> - Central error processing and coordination</li>
<li><b>ErrorContext</b> - Error tracking and attack pattern detection</li>
<li><b>AlertManager</b> - RFC 9147 compliant alert generation and processing</li>
<li><b>ErrorReporter</b> - Security-conscious logging and diagnostics</li>
<li><b>SystemC Integration</b> - Hardware/software co-design support</li>
</ol>
<h2><a class="anchor" id="autotoc_md374"></a>
Design Principles</h2>
<ul>
<li><b>RFC 9147 Compliance</b>: Strict adherence to DTLS v1.3 specification</li>
<li><b>Transport Awareness</b>: Different policies for UDP vs secure transports</li>
<li><b>Security First</b>: No sensitive information leakage in error reports</li>
<li><b>DoS Protection</b>: Built-in rate limiting and attack detection</li>
<li><b>Performance</b>: Minimal overhead on critical paths</li>
<li><b>Thread Safety</b>: Full concurrency support</li>
</ul>
<h1><a class="anchor" id="autotoc_md375"></a>
RFC 9147 Compliance Features</h1>
<h2><a class="anchor" id="autotoc_md376"></a>
Section 4.2.1: Invalid Record Handling</h2>
<div class="fragment"><div class="line"><span class="comment">// RFC 9147: &quot;In general, invalid records SHOULD be silently discarded&quot;</span></div>
<div class="line"><span class="keyword">auto</span> result = error_handler-&gt;handle_invalid_record(ContentType::INVALID, context);</div>
<div class="line"><span class="comment">// Records are silently discarded, optionally logged for diagnostics</span></div>
</div><!-- fragment --><p><b>Key Requirements Implemented:</b></p><ul>
<li>Invalid records are silently discarded by default</li>
<li>Error may be logged for diagnostic purposes</li>
<li>Association is preserved (no fatal errors)</li>
<li>DoS protection through rate limiting</li>
</ul>
<h2><a class="anchor" id="autotoc_md377"></a>
Transport-Specific Alert Policies</h2>
<p><b>UDP Transport (Default):</b> </p><div class="fragment"><div class="line">ErrorHandler::Configuration udp_config;</div>
<div class="line">udp_config.transport_type = ErrorHandler::Transport::UDP;</div>
<div class="line">udp_config.generate_alerts_on_invalid_records = <span class="keyword">false</span>; <span class="comment">// NOT RECOMMENDED per RFC</span></div>
</div><!-- fragment --><p><b>Secure Transport (SCTP with SCTP-AUTH):</b> </p><div class="fragment"><div class="line">ErrorHandler::Configuration secure_config;</div>
<div class="line">secure_config.transport_type = ErrorHandler::Transport::DTLS_OVER_SCTP;</div>
<div class="line">secure_config.generate_alerts_on_invalid_records = <span class="keyword">true</span>; <span class="comment">// Safe for secure transports</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md378"></a>
Fatal Alert Generation</h2>
<p>When alerts are generated, they MUST be fatal per RFC 9147: </p><div class="fragment"><div class="line"><span class="comment">// All generated alerts are fatal to prevent probing attacks</span></div>
<div class="line"><span class="keyword">auto</span> alert = AlertManager::serialize_alert(AlertLevel::FATAL, AlertDescription::BAD_RECORD_MAC);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md379"></a>
Authentication Failure Tracking</h2>
<div class="fragment"><div class="line"><span class="comment">// RFC 9147: Track records that fail authentication</span></div>
<div class="line"><span class="keyword">auto</span> result = error_handler-&gt;handle_authentication_failure(epoch, context);</div>
<div class="line"><span class="comment">// Returns false if connection should be closed due to excessive failures</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md380"></a>
API Reference</h1>
<h2><a class="anchor" id="autotoc_md381"></a>
ErrorHandler</h2>
<h3><a class="anchor" id="autotoc_md382"></a>
Core Configuration</h3>
<div class="fragment"><div class="line"><span class="keyword">struct </span>Configuration {</div>
<div class="line">    Transport transport_type = Transport::UDP;</div>
<div class="line">    SecurityLevel security_level = SecurityLevel::STANDARD;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Alert generation policy</span></div>
<div class="line">    <span class="keywordtype">bool</span> generate_alerts_on_invalid_records = <span class="keyword">false</span>;  <span class="comment">// RFC 9147 default for UDP</span></div>
<div class="line">    <span class="keywordtype">bool</span> log_invalid_records = <span class="keyword">true</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// DoS protection thresholds</span></div>
<div class="line">    uint32_t max_auth_failures_per_epoch = 10;</div>
<div class="line">    uint32_t max_invalid_records_per_second = 100;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Privacy and security</span></div>
<div class="line">    <span class="keywordtype">bool</span> log_sensitive_data = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> log_network_addresses = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> anonymize_peer_info = <span class="keyword">true</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md383"></a>
Primary Methods</h3>
<div class="fragment"><div class="line"><span class="comment">// Process any DTLS error with context</span></div>
<div class="line">Result&lt;bool&gt; process_error(DTLSError error, std::shared_ptr&lt;ErrorContext&gt; context);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Handle invalid record per RFC 9147</span></div>
<div class="line">Result&lt;void&gt; handle_invalid_record(ContentType record_type, </div>
<div class="line">                                  std::shared_ptr&lt;ErrorContext&gt; context);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Track authentication failures with DoS protection</span></div>
<div class="line">Result&lt;bool&gt; handle_authentication_failure(Epoch epoch,</div>
<div class="line">                                          std::shared_ptr&lt;ErrorContext&gt; context);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Generate alert if appropriate for transport</span></div>
<div class="line">Result&lt;std::vector&lt;uint8_t&gt;&gt; generate_alert_if_appropriate(</div>
<div class="line">    AlertDescription alert_desc, std::shared_ptr&lt;ErrorContext&gt; context);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md384"></a>
ErrorContext</h2>
<h3><a class="anchor" id="autotoc_md385"></a>
Error Tracking</h3>
<div class="fragment"><div class="line"><span class="comment">// Record error with categorization</span></div>
<div class="line">uint32_t record_error(DTLSError error, <span class="keyword">const</span> std::string&amp; category,</div>
<div class="line">                     <span class="keyword">const</span> std::string&amp; description, <span class="keywordtype">bool</span> is_security_relevant = <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Record security-specific error with confidence</span></div>
<div class="line">uint32_t record_security_error(DTLSError error, <span class="keyword">const</span> std::string&amp; attack_type,</div>
<div class="line">                              <span class="keywordtype">double</span> confidence);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Update connection state context</span></div>
<div class="line"><span class="keywordtype">void</span> update_connection_state(ConnectionState state, std::optional&lt;Epoch&gt; epoch);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md386"></a>
Pattern Analysis</h3>
<div class="fragment"><div class="line"><span class="comment">// Check for excessive error rates (DoS detection)</span></div>
<div class="line"><span class="keywordtype">bool</span> is_error_rate_excessive(std::chrono::seconds time_window, uint32_t max_errors);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Detect attack patterns with confidence scoring</span></div>
<div class="line"><span class="keywordtype">double</span> detect_attack_patterns() <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Get recent errors for analysis</span></div>
<div class="line">std::vector&lt;ErrorEvent&gt; get_recent_errors(std::chrono::seconds time_window);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md387"></a>
AlertManager</h2>
<h3><a class="anchor" id="autotoc_md388"></a>
Alert Generation</h3>
<div class="fragment"><div class="line"><span class="comment">// Generate alert with RFC 9147 policy enforcement</span></div>
<div class="line">Result&lt;std::optional&lt;std::vector&lt;uint8_t&gt;&gt;&gt; generate_alert_for_error(</div>
<div class="line">    DTLSError error, std::shared_ptr&lt;ErrorContext&gt; context);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Handle invalid record per RFC 9147 (silent discard)</span></div>
<div class="line">Result&lt;void&gt; handle_invalid_record(ContentType record_type,</div>
<div class="line">                                  <span class="keyword">const</span> std::string&amp; connection_id,</div>
<div class="line">                                  std::shared_ptr&lt;ErrorContext&gt; context);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md389"></a>
Alert Policy Configuration</h3>
<div class="fragment"><div class="line"><span class="keyword">struct </span>AlertPolicy {</div>
<div class="line">    TransportSecurity transport_security = TransportSecurity::INSECURE;</div>
<div class="line">    <span class="keywordtype">bool</span> generate_alerts_for_invalid_records = <span class="keyword">false</span>;  <span class="comment">// NOT RECOMMENDED for UDP</span></div>
<div class="line">    <span class="keywordtype">bool</span> generate_alerts_for_auth_failures = <span class="keyword">false</span>;</div>
<div class="line">    uint32_t max_alerts_per_minute = 10;</div>
<div class="line">    <span class="keywordtype">bool</span> randomize_alert_timing = <span class="keyword">true</span>;  <span class="comment">// Prevent timing attacks</span></div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md390"></a>
ErrorReporter</h2>
<h3><a class="anchor" id="autotoc_md391"></a>
Secure Reporting</h3>
<div class="fragment"><div class="line"><span class="comment">// Basic error reporting with privacy protection</span></div>
<div class="line">Result&lt;void&gt; report_error(LogLevel level, DTLSError error,</div>
<div class="line">                         <span class="keyword">const</span> std::string&amp; category, <span class="keyword">const</span> std::string&amp; message,</div>
<div class="line">                         std::shared_ptr&lt;ErrorContext&gt; context = <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Security incident reporting with threat assessment</span></div>
<div class="line">Result&lt;void&gt; report_security_incident(DTLSError error, <span class="keyword">const</span> std::string&amp; incident_type,</div>
<div class="line">                                     <span class="keywordtype">double</span> confidence, </div>
<div class="line">                                     std::shared_ptr&lt;ErrorContext&gt; context = <span class="keyword">nullptr</span>);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md392"></a>
Builder Pattern for Complex Reports</h3>
<div class="fragment"><div class="line"><span class="keyword">auto</span> result = error_reporter-&gt;create_report(LogLevel::SECURITY, DTLSError::TAMPERING_DETECTED)</div>
<div class="line">    .category(<span class="stringliteral">&quot;integrity_validation&quot;</span>)</div>
<div class="line">    .message(<span class="stringliteral">&quot;Message tampering detected&quot;</span>)</div>
<div class="line">    .security_incident(<span class="keyword">true</span>)</div>
<div class="line">    .threat_confidence(0.92)</div>
<div class="line">    .attack_vector(<span class="stringliteral">&quot;message_modification&quot;</span>)</div>
<div class="line">    .metadata(<span class="stringliteral">&quot;record_type&quot;</span>, <span class="stringliteral">&quot;handshake&quot;</span>)</div>
<div class="line">    .tag(<span class="stringliteral">&quot;security&quot;</span>).tag(<span class="stringliteral">&quot;attack&quot;</span>)</div>
<div class="line">    .submit();</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md393"></a>
Usage Examples</h1>
<h2><a class="anchor" id="autotoc_md394"></a>
Basic UDP Server Configuration</h2>
<div class="fragment"><div class="line"><span class="comment">// RFC 9147 compliant configuration for UDP transport</span></div>
<div class="line">ErrorHandler::Configuration config;</div>
<div class="line">config.transport_type = ErrorHandler::Transport::UDP;</div>
<div class="line">config.generate_alerts_on_invalid_records = <span class="keyword">false</span>; <span class="comment">// Per RFC recommendation</span></div>
<div class="line">config.log_invalid_records = <span class="keyword">true</span>;  <span class="comment">// Diagnostic logging allowed</span></div>
<div class="line">config.max_auth_failures_per_epoch = 5;  <span class="comment">// Strict limit</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> error_handler = std::make_unique&lt;ErrorHandler&gt;(config);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Configure alert manager for UDP</span></div>
<div class="line">AlertManager::AlertPolicy alert_policy;</div>
<div class="line">alert_policy.transport_security = AlertManager::TransportSecurity::INSECURE;</div>
<div class="line">alert_policy.generate_alerts_for_invalid_records = <span class="keyword">false</span>;</div>
<div class="line">alert_policy.generate_alerts_for_auth_failures = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> alert_manager = std::make_unique&lt;AlertManager&gt;(alert_policy);</div>
<div class="line">error_handler-&gt;set_alert_manager(alert_manager);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md395"></a>
Processing Invalid Records</h2>
<div class="fragment"><div class="line"><span class="keyword">auto</span> context = error_handler-&gt;create_error_context(<span class="stringliteral">&quot;client_001&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Invalid record received - handle per RFC 9147</span></div>
<div class="line"><span class="keyword">auto</span> result = error_handler-&gt;handle_invalid_record(ContentType::INVALID, context);</div>
<div class="line"><span class="keywordflow">if</span> (result.is_success()) {</div>
<div class="line">    <span class="comment">// Record was silently discarded per RFC 9147</span></div>
<div class="line">    <span class="comment">// Error was logged for diagnostic purposes</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check if DoS attack detected</span></div>
<div class="line"><span class="keyword">const</span> <span class="keyword">auto</span>&amp; stats = error_handler-&gt;get_error_statistics();</div>
<div class="line"><span class="keywordflow">if</span> (stats.dos_attacks_detected &gt; 0) {</div>
<div class="line">    <span class="comment">// Take appropriate defensive action</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md396"></a>
Security Incident Handling</h2>
<div class="fragment"><div class="line"><span class="comment">// Detect potential replay attack</span></div>
<div class="line"><span class="keywordflow">if</span> (<span class="comment">/* replay detection logic */</span>) {</div>
<div class="line">    context-&gt;record_security_error(</div>
<div class="line">        DTLSError::REPLAY_ATTACK_DETECTED, <span class="stringliteral">&quot;replay_pattern&quot;</span>, 0.9);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Report security incident</span></div>
<div class="line">    error_reporter-&gt;report_security_incident(</div>
<div class="line">        DTLSError::REPLAY_ATTACK_DETECTED, <span class="stringliteral">&quot;replay_attack&quot;</span>, 0.9, context);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Check if connection should be terminated</span></div>
<div class="line">    <span class="keywordflow">if</span> (error_handler-&gt;should_terminate_connection(DTLSError::REPLAY_ATTACK_DETECTED)) {</div>
<div class="line">        <span class="comment">// Terminate connection</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md397"></a>
Production Deployment</h2>
<div class="fragment"><div class="line"><span class="comment">// Production configuration with strict security</span></div>
<div class="line">ErrorHandler::Configuration prod_config;</div>
<div class="line">prod_config.transport_type = ErrorHandler::Transport::UDP;</div>
<div class="line">prod_config.security_level = ErrorHandler::SecurityLevel::STRICT;</div>
<div class="line">prod_config.max_auth_failures_per_epoch = 3;  <span class="comment">// Strict for production</span></div>
<div class="line">prod_config.enable_attack_detection = <span class="keyword">true</span>;</div>
<div class="line">prod_config.enable_error_correlation = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Production error reporting</span></div>
<div class="line">ErrorReporter::ReportingConfig reporter_config;</div>
<div class="line">reporter_config.minimum_level = ErrorReporter::LogLevel::WARNING;</div>
<div class="line">reporter_config.format = ErrorReporter::OutputFormat::SYSLOG;</div>
<div class="line">reporter_config.log_file_path = <span class="stringliteral">&quot;/var/log/dtls/error.log&quot;</span>;</div>
<div class="line">reporter_config.enable_audit_trail = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Strict privacy settings</span></div>
<div class="line">reporter_config.log_network_addresses = <span class="keyword">false</span>;</div>
<div class="line">reporter_config.log_connection_ids = <span class="keyword">false</span>;</div>
<div class="line">reporter_config.anonymize_peer_info = <span class="keyword">true</span>;</div>
<div class="line">reporter_config.log_sensitive_data = <span class="keyword">false</span>;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md398"></a>
SystemC Integration</h1>
<h2><a class="anchor" id="autotoc_md399"></a>
TLM Error Extension</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;systemc/include/dtls_error_handling.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create SystemC error handler module</span></div>
<div class="line">dtls_error_handler_sc error_handler(<span class="stringliteral">&quot;error_handler&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Configure for SystemC simulation</span></div>
<div class="line">error_handler.configure_for_simulation();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Connect to other SystemC modules</span></div>
<div class="line">error_handler.error_reporting_socket.bind(protocol_stack.error_port);</div>
<div class="line">protocol_stack.alert_port.bind(error_handler.alert_output_socket);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md400"></a>
Error Injection for Testing</h2>
<div class="fragment"><div class="line"><span class="comment">// SystemC error injection module for testing</span></div>
<div class="line">dtls_error_injector_sc injector(<span class="stringliteral">&quot;error_injector&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Configure injection profile</span></div>
<div class="line">injector.configure_injection_profile(<span class="stringliteral">&quot;dos_attack_simulation&quot;</span>);</div>
<div class="line">injector.enable_random_injection(0.05);  <span class="comment">// 5% error rate</span></div>
<div class="line">injector.enable_burst_injection(10, sc_time(1, SC_MS));</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md401"></a>
Performance Characteristics</h1>
<h2><a class="anchor" id="autotoc_md402"></a>
Memory Usage</h2>
<ul>
<li>ErrorContext: ~4KB per connection (with 1000 events limit)</li>
<li>ErrorHandler: ~16KB base overhead</li>
<li>AlertManager: ~8KB base overhead</li>
<li>ErrorReporter: ~32KB base overhead + log buffer</li>
</ul>
<h2><a class="anchor" id="autotoc_md403"></a>
Processing Overhead</h2>
<ul>
<li>Invalid record handling: &lt;100ns (silent discard)</li>
<li>Error context update: &lt;500ns</li>
<li>Alert generation: &lt;1μs (when enabled)</li>
<li>Security incident reporting: &lt;10μs</li>
</ul>
<h2><a class="anchor" id="autotoc_md404"></a>
Scalability</h2>
<ul>
<li>Supports &gt;10,000 concurrent error contexts</li>
<li>Thread-safe operations with minimal contention</li>
<li>Automatic context cleanup and memory management</li>
<li>Rate limiting prevents resource exhaustion</li>
</ul>
<h1><a class="anchor" id="autotoc_md405"></a>
Security Considerations</h1>
<h2><a class="anchor" id="autotoc_md406"></a>
Information Disclosure Prevention</h2>
<ul>
<li>No cryptographic material in error messages</li>
<li>Network addresses hashed for privacy</li>
<li><a class="el" href="classConnection.html" title="Main DTLS v1.3 Connection implementation.">Connection</a> IDs anonymized in logs</li>
<li>Timing attack prevention in alert generation</li>
</ul>
<h2><a class="anchor" id="autotoc_md407"></a>
DoS Protection</h2>
<ul>
<li>Rate limiting at multiple levels (per-second, per-minute, per-connection)</li>
<li>Attack pattern detection with confidence scoring</li>
<li>Automatic connection termination for persistent attackers</li>
<li>Resource exhaustion protection</li>
</ul>
<h2><a class="anchor" id="autotoc_md408"></a>
Audit and Compliance</h2>
<ul>
<li>Complete audit trail for security incidents</li>
<li>RFC 9147 compliance validation</li>
<li>Cryptographic signature support for audit logs</li>
<li>Integration with SIEM systems</li>
</ul>
<h1><a class="anchor" id="autotoc_md409"></a>
Testing</h1>
<h2><a class="anchor" id="autotoc_md410"></a>
Unit Tests</h2>
<div class="fragment"><div class="line">cd build</div>
<div class="line">./dtls_error_handling_test</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md411"></a>
RFC 9147 Compliance Tests</h2>
<div class="fragment"><div class="line">cd build</div>
<div class="line">./dtls_error_handling_test --gtest_filter=&quot;*RFC9147*&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md412"></a>
Integration Testing</h2>
<div class="fragment"><div class="line"># Run comprehensive error handling examples</div>
<div class="line">cd build</div>
<div class="line">./error_handling_example</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md413"></a>
Performance Benchmarking</h2>
<div class="fragment"><div class="line"># Include error handling in performance tests</div>
<div class="line">cd build</div>
<div class="line">./dtls_performance_test --include-error-handling</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md414"></a>
Migration Guide</h1>
<h2><a class="anchor" id="autotoc_md415"></a>
From Basic Error Handling</h2>
<div class="fragment"><div class="line"><span class="comment">// Old approach</span></div>
<div class="line"><span class="keywordflow">if</span> (error != DTLSError::SUCCESS) {</div>
<div class="line">    <span class="keywordflow">return</span> error;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// New approach with context</span></div>
<div class="line"><span class="keyword">auto</span> result = error_handler-&gt;process_error(error, context);</div>
<div class="line"><span class="keywordflow">if</span> (!result.is_success()) {</div>
<div class="line">    <span class="keywordflow">return</span> result.error();</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">bool</span> should_continue = result.value();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md416"></a>
From Custom Alert Generation</h2>
<div class="fragment"><div class="line"><span class="comment">// Old approach</span></div>
<div class="line"><span class="keywordflow">if</span> (should_send_alert) {</div>
<div class="line">    send_alert(AlertLevel::FATAL, AlertDescription::BAD_RECORD_MAC);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// New approach (RFC 9147 compliant)</span></div>
<div class="line"><span class="keyword">auto</span> alert_result = error_handler-&gt;generate_alert_if_appropriate(</div>
<div class="line">    AlertDescription::BAD_RECORD_MAC, context);</div>
<div class="line"><span class="keywordflow">if</span> (alert_result.is_success()) {</div>
<div class="line">    <span class="comment">// Alert generated according to transport policy</span></div>
<div class="line">    send_alert_data(alert_result.value());</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md417"></a>
Troubleshooting</h1>
<h2><a class="anchor" id="autotoc_md418"></a>
Common Issues</h2>
<ol type="1">
<li><b>Alerts not generated for UDP</b><ul>
<li>Expected behavior per RFC 9147</li>
<li>Use secure transport configuration if alerts needed</li>
</ul>
</li>
<li><b>High memory usage with many connections</b><ul>
<li>Adjust <code>max_events</code> limit in ErrorContext</li>
<li>Enable automatic context cleanup</li>
</ul>
</li>
<li><b>Performance impact from logging</b><ul>
<li>Increase log level threshold</li>
<li>Enable rate limiting for reports</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md419"></a>
Debug Configuration</h2>
<div class="fragment"><div class="line">ErrorHandler::Configuration debug_config;</div>
<div class="line">debug_config.security_level = ErrorHandler::SecurityLevel::PARANOID;</div>
<div class="line">debug_config.log_invalid_records = <span class="keyword">true</span>;</div>
<div class="line">debug_config.enable_attack_detection = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">ErrorReporter::ReportingConfig debug_reporter;</div>
<div class="line">debug_reporter.minimum_level = ErrorReporter::LogLevel::DEBUG;</div>
<div class="line">debug_reporter.include_stack_traces = <span class="keyword">true</span>;  <span class="comment">// Debug builds only</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md420"></a>
Future Enhancements</h1>
<ul>
<li>Machine learning-based attack detection</li>
<li>Integration with external threat intelligence</li>
<li>Real-time security dashboard</li>
<li>Advanced correlation across multiple connections</li>
<li>Automated incident response capabilities</li>
</ul>
<h1><a class="anchor" id="autotoc_md421"></a>
References</h1>
<ul>
<li><a href="https://www.rfc-editor.org/rfc/rfc9147.html">RFC 9147: DTLS Protocol Version 1.3</a></li>
<li><a href="https://www.rfc-editor.org/rfc/rfc6347.html">RFC 6347: DTLS Version 1.2</a></li>
<li><a href="https://www.rfc-editor.org/rfc/rfc8446.html">RFC 8446: TLS Protocol Version 1.3</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md422"></a>
Support</h1>
<p>For questions or issues with the error handling system:</p><ol type="1">
<li>Check the test suite for usage examples</li>
<li>Review the comprehensive examples in <code>examples/error_handling_example.cpp</code></li>
<li>Consult the SystemC integration documentation for hardware/software co-design </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>

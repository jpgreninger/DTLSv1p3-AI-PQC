<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DTLS v1.3 Implementation: DTLS v1.3 SystemC TLM API Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DTLS v1.3 Implementation<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Production-ready DTLS v1.3 implementation with RFC 9147 compliance and quantum-resistant cryptography</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_2SYSTEMC__API__DOCUMENTATION.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">DTLS v1.3 SystemC TLM API Documentation</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md857"></a> Complete reference for the SystemC Transaction Level Modeling (TLM) implementation of DTLS v1.3. This provides hardware/software co-design capabilities for verification and performance analysis.</p>
<h1><a class="anchor" id="autotoc_md858"></a>
Table of Contents</h1>
<ul>
<li>Overview</li>
<li>SystemC Components</li>
<li>TLM Interfaces</li>
<li>Protocol Stack Model</li>
<li>Timing Models</li>
<li>Communication Channels</li>
<li>Testbenches</li>
<li>Performance Analysis</li>
<li>Examples</li>
</ul>
<h1><a class="anchor" id="autotoc_md859"></a>
Overview</h1>
<p>The SystemC implementation provides:</p>
<ul>
<li><b>Transaction Level Modeling</b>: High-level protocol modeling with timing accuracy</li>
<li><b>TLM-2.0 Compliance</b>: Standard SystemC TLM interfaces and protocols</li>
<li><b>Configurable Timing</b>: Adjustable timing models for different hardware targets</li>
<li><b>Protocol Verification</b>: Comprehensive test infrastructure</li>
<li><b>Performance Analysis</b>: Detailed timing and throughput analysis</li>
</ul>
<h2><a class="anchor" id="autotoc_md860"></a>
Key Features</h2>
<ul>
<li>Full DTLS v1.3 protocol stack in SystemC</li>
<li>TLM-2.0 generic payload extensions for DTLS</li>
<li>Configurable timing models (approximate, loosely-timed, cycle-accurate)</li>
<li>Hardware acceleration modeling</li>
<li>Power consumption estimation</li>
<li>SystemC verification components</li>
</ul>
<h1><a class="anchor" id="autotoc_md861"></a>
SystemC Components</h1>
<h2><a class="anchor" id="autotoc_md862"></a>
Base Includes</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;systemc&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;tlm&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dtls_systemc/protocol_stack.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dtls_systemc/tlm_extensions.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dtls_systemc/timing_models.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dtls_systemc/channels.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>sc_core;</div>
<div class="line"><span class="keyword">using namespace </span>tlm;</div>
<div class="line"><span class="keyword">using namespace </span>dtls::systemc;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md863"></a>
Core Component Hierarchy</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::systemc {</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Base component for all DTLS modules</span></div>
<div class="line"><span class="keyword">class </span>dtls_module_base : <span class="keyword">public</span> sc_module {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Constructor with configurable timing</span></div>
<div class="line">    dtls_module_base(sc_module_name name, </div>
<div class="line">                     <span class="keyword">const</span> timing_config&amp; timing = timing_config::default_config());</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Common interfaces</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_timing_model(std::shared_ptr&lt;timing_model_base&gt; <a class="code hl_variable" href="hardware__acceleration_8cpp.html#a2e5f0c4b01fa6a42a6a2215b44a116d9">model</a>) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> timing_stats get_timing_statistics() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> reset() = 0;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    timing_config timing_cfg;</div>
<div class="line">    std::shared_ptr&lt;timing_model_base&gt; timing_model;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Timing annotation helpers</span></div>
<div class="line">    <span class="keywordtype">void</span> annotate_delay(sc_time delay);</div>
<div class="line">    <span class="keywordtype">void</span> annotate_timing_point(<span class="keyword">const</span> std::string&amp; label);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="ahardware__acceleration_8cpp_html_a2e5f0c4b01fa6a42a6a2215b44a116d9"><div class="ttname"><a href="hardware__acceleration_8cpp.html#a2e5f0c4b01fa6a42a6a2215b44a116d9">model</a></div><div class="ttdeci">std::string model</div><div class="ttdef"><b>Definition</b> <a href="hardware__acceleration_8cpp_source.html#l00053">hardware_acceleration.cpp:53</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md864"></a>
TLM Interfaces</h1>
<h2><a class="anchor" id="autotoc_md865"></a>
DTLS TLM Extensions</h2>
<p>Custom TLM generic payload extensions for DTLS-specific data:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::systemc {</div>
<div class="line"> </div>
<div class="line"><span class="comment">// DTLS message extension for TLM generic payload</span></div>
<div class="line"><span class="keyword">class </span>dtls_extension : <span class="keyword">public</span> tlm_extension&lt;dtls_extension&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    dtls_extension();</div>
<div class="line">    <span class="keyword">virtual</span> ~dtls_extension();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// TLM extension interface</span></div>
<div class="line">    <span class="keyword">virtual</span> tlm_extension_base* clone() <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> copy_from(<span class="keyword">const</span> tlm_extension_base&amp; ext) <span class="keyword">override</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// DTLS-specific data</span></div>
<div class="line">    <span class="keyword">struct </span>dtls_message {</div>
<div class="line">        ContentType content_type;</div>
<div class="line">        HandshakeType handshake_type;</div>
<div class="line">        Epoch epoch;</div>
<div class="line">        SequenceNumber sequence_number;</div>
<div class="line">        std::vector&lt;uint8_t&gt; payload;</div>
<div class="line">        std::optional&lt;ConnectionID&gt; connection_id;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Security context</span></div>
<div class="line">        <span class="keywordtype">bool</span> encrypted;</div>
<div class="line">        AEADCipher cipher;</div>
<div class="line">        std::vector&lt;uint8_t&gt; auth_tag;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Timing information</span></div>
<div class="line">        sc_time arrival_time;</div>
<div class="line">        sc_time processing_deadline;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Quality of service</span></div>
<div class="line">        <span class="keyword">enum class</span> priority { LOW, NORMAL, HIGH, CRITICAL } qos_priority;</div>
<div class="line">        </div>
<div class="line">        dtls_message() : encrypted(false), qos_priority(priority::NORMAL) {}</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Accessors</span></div>
<div class="line">    <span class="keywordtype">void</span> set_message(<span class="keyword">const</span> dtls_message&amp; msg);</div>
<div class="line">    <span class="keyword">const</span> dtls_message&amp; get_message() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Convenience methods</span></div>
<div class="line">    <span class="keywordtype">bool</span> is_handshake_message() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> is_application_data() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> requires_acknowledgment() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    dtls_message message_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Connection state extension</span></div>
<div class="line"><span class="keyword">class </span>dtls_connection_extension : <span class="keyword">public</span> tlm_extension&lt;dtls_connection_extension&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ad">ConnectionState</a> state;</div>
<div class="line">    std::optional&lt;ConnectionID&gt; connection_id;</div>
<div class="line">    std::optional&lt;ConnectionID&gt; peer_connection_id;</div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3">CipherSuite</a> negotiated_cipher_suite;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Performance metrics</span></div>
<div class="line">    <span class="keyword">struct </span>perf_metrics {</div>
<div class="line">        sc_time handshake_latency;</div>
<div class="line">        uint64_t bytes_transmitted;</div>
<div class="line">        uint64_t packets_transmitted;</div>
<div class="line">        uint32_t retransmission_count;</div>
<div class="line">        <span class="keywordtype">double</span> throughput_mbps;</div>
<div class="line">    } metrics;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Constructor and TLM interface methods</span></div>
<div class="line">    dtls_connection_extension();</div>
<div class="line">    <span class="keyword">virtual</span> ~dtls_connection_extension();</div>
<div class="line">    <span class="keyword">virtual</span> tlm_extension_base* clone() <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> copy_from(<span class="keyword">const</span> tlm_extension_base&amp; ext) <span class="keyword">override</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Security context extension</span></div>
<div class="line"><span class="keyword">class </span>dtls_security_extension : <span class="keyword">public</span> tlm_extension&lt;dtls_security_extension&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">struct </span>security_context {</div>
<div class="line">        <span class="comment">// Cryptographic state</span></div>
<div class="line">        <a class="code hl_typedef" href="group__CoreTypes.html#gace5e728a8418b8695b245902009ffa77">Epoch</a> current_epoch;</div>
<div class="line">        std::map&lt;Epoch, KeyMaterial&gt; read_keys;</div>
<div class="line">        std::map&lt;Epoch, KeyMaterial&gt; write_keys;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Anti-replay window</span></div>
<div class="line">        <span class="keyword">struct </span>replay_window {</div>
<div class="line">            uint64_t window_mask;</div>
<div class="line">            <a class="code hl_typedef" href="group__CoreTypes.html#ga50089dc7f9d67ec4e7563999a0e01a4b">SequenceNumber</a> highest_sequence;</div>
<div class="line">            <span class="keywordtype">size_t</span> window_size;</div>
<div class="line">        } anti_replay;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Security level</span></div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a454f2e2956822357a074530f22006b51">SecurityLevel</a> level;</div>
<div class="line">        <span class="keywordtype">bool</span> perfect_forward_secrecy;</div>
<div class="line">        </div>
<div class="line">        security_context() : current_epoch(0), level(<a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a454f2e2956822357a074530f22006b51">SecurityLevel</a>::<a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a454f2e2956822357a074530f22006b51ab89de3b4b81c4facfac906edf29aec8c">HIGH</a>), </div>
<div class="line">                           perfect_forward_secrecy(true) {}</div>
<div class="line">    } context;</div>
<div class="line">    </div>
<div class="line">    dtls_security_extension();</div>
<div class="line">    <span class="keyword">virtual</span> ~dtls_security_extension();</div>
<div class="line">    <span class="keyword">virtual</span> tlm_extension_base* clone() <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> copy_from(<span class="keyword">const</span> tlm_extension_base&amp; ext) <span class="keyword">override</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="agroup__CoreTypes_html_ga50089dc7f9d67ec4e7563999a0e01a4b"><div class="ttname"><a href="group__CoreTypes.html#ga50089dc7f9d67ec4e7563999a0e01a4b">dtls::v13::SequenceNumber</a></div><div class="ttdeci">uint64_t SequenceNumber</div><div class="ttdoc">64-bit sequence number for replay protection.</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00047">types.h:47</a></div></div>
<div class="ttc" id="agroup__CoreTypes_html_gace5e728a8418b8695b245902009ffa77"><div class="ttname"><a href="group__CoreTypes.html#gace5e728a8418b8695b245902009ffa77">dtls::v13::Epoch</a></div><div class="ttdeci">uint16_t Epoch</div><div class="ttdoc">Epoch number for key generation sequencing.</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00044">types.h:44</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a2c8cefcd0588652f47924c24935f52e3"><div class="ttname"><a href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3">dtls::v13::CipherSuite</a></div><div class="ttdeci">CipherSuite</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00153">types.h:153</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a454f2e2956822357a074530f22006b51"><div class="ttname"><a href="namespacedtls_1_1v13.html#a454f2e2956822357a074530f22006b51">dtls::v13::SecurityLevel</a></div><div class="ttdeci">SecurityLevel</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00285">types.h:285</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a454f2e2956822357a074530f22006b51ab89de3b4b81c4facfac906edf29aec8c"><div class="ttname"><a href="namespacedtls_1_1v13.html#a454f2e2956822357a074530f22006b51ab89de3b4b81c4facfac906edf29aec8c">dtls::v13::SecurityLevel::HIGH</a></div><div class="ttdeci">@ HIGH</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0ad"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ad">dtls::v13::ConnectionState</a></div><div class="ttdeci">ConnectionState</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00266">types.h:266</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md866"></a>
TLM Sockets and Interfaces</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::systemc {</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Forward declarations</span></div>
<div class="line"><span class="keyword">class </span>dtls_initiator_socket;</div>
<div class="line"><span class="keyword">class </span>dtls_target_socket;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// DTLS-specific TLM interface</span></div>
<div class="line"><span class="keyword">class </span>dtls_transport_if : <span class="keyword">public</span> <span class="keyword">virtual</span> tlm_transport_if&lt;&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Additional DTLS-specific transport methods</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_connection_id(<span class="keyword">const</span> ConnectionID&amp; cid) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::optional&lt;ConnectionID&gt; get_connection_id() <span class="keyword">const</span> = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> enable_early_data(<span class="keywordtype">bool</span> enable) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> is_early_data_enabled() <span class="keyword">const</span> = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> update_security_context(<span class="keyword">const</span> dtls_security_extension::security_context&amp; ctx) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> trigger_key_update() = 0;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// DTLS initiator socket (client side)</span></div>
<div class="line"><span class="keyword">class </span>dtls_initiator_socket : <span class="keyword">public</span> tlm_initiator_socket&lt;&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    dtls_initiator_socket(<span class="keyword">const</span> <span class="keywordtype">char</span>* name = <span class="stringliteral">&quot;dtls_initiator_socket&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// DTLS-specific operations</span></div>
<div class="line">    sync_enum_type dtls_send(dtls_extension::dtls_message&amp; message, </div>
<div class="line">                            sc_time&amp; delay);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> dtls_send_nb(dtls_extension::dtls_message&amp; message,</div>
<div class="line">                     sc_event&amp; completion_event);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection management</span></div>
<div class="line">    <span class="keywordtype">void</span> initiate_handshake();</div>
<div class="line">    <span class="keywordtype">void</span> send_application_data(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data);</div>
<div class="line">    <span class="keywordtype">void</span> close_connection(AlertDescription alert = AlertDescription::CLOSE_NOTIFY);</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    std::unique_ptr&lt;dtls_transport_if&gt; transport_impl;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// DTLS target socket (server side)</span></div>
<div class="line"><span class="keyword">class </span>dtls_target_socket : <span class="keyword">public</span> tlm_target_socket&lt;&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    dtls_target_socket(<span class="keyword">const</span> <span class="keywordtype">char</span>* name = <span class="stringliteral">&quot;dtls_target_socket&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// TLM-2.0 interface implementation</span></div>
<div class="line">    <span class="keyword">virtual</span> sync_enum_type nb_transport_fw(tlm_generic_payload&amp; payload,</div>
<div class="line">                                          tlm_phase&amp; phase,</div>
<div class="line">                                          sc_time&amp; delay) <span class="keyword">override</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> b_transport(tlm_generic_payload&amp; payload,</div>
<div class="line">                           sc_time&amp; delay) <span class="keyword">override</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> get_direct_mem_ptr(tlm_generic_payload&amp; payload,</div>
<div class="line">                                  tlm_dmi&amp; dmi_data) <span class="keyword">override</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> transport_dbg(tlm_generic_payload&amp; payload) <span class="keyword">override</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// DTLS-specific callbacks</span></div>
<div class="line">    <span class="keywordtype">void</span> register_handshake_callback(</div>
<div class="line">        std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> dtls_extension::dtls_message&amp;)&gt; callback);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> register_data_callback(</div>
<div class="line">        std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp;)&gt; callback);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> register_error_callback(</div>
<div class="line">        std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> std::string&amp;)&gt; callback);</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    std::function&lt;void(<span class="keyword">const</span> dtls_extension::dtls_message&amp;)&gt; handshake_cb;</div>
<div class="line">    std::function&lt;void(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp;)&gt; data_cb;</div>
<div class="line">    std::function&lt;void(<span class="keyword">const</span> std::string&amp;)&gt; error_cb;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md867"></a>
Protocol Stack Model</h1>
<h2><a class="anchor" id="autotoc_md868"></a>
Main Protocol Stack Component</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::systemc {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>dtls_protocol_stack : <span class="keyword">public</span> dtls_module_base {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Constructor</span></div>
<div class="line">    dtls_protocol_stack(sc_module_name name,</div>
<div class="line">                       <span class="keyword">const</span> protocol_config&amp; config = protocol_config::default_config(),</div>
<div class="line">                       <span class="keyword">const</span> timing_config&amp; timing = timing_config::default_config());</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// TLM sockets</span></div>
<div class="line">    dtls_initiator_socket initiator_socket;</div>
<div class="line">    dtls_target_socket target_socket;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration ports</span></div>
<div class="line">    sc_port&lt;tlm_fifo_get_if&lt;ConnectionConfig&gt;&gt; config_port;</div>
<div class="line">    sc_port&lt;tlm_fifo_put_if&lt;ConnectionStats&gt;&gt; stats_port;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Interrupt/event ports</span></div>
<div class="line">    sc_out&lt;bool&gt; handshake_complete_signal;</div>
<div class="line">    sc_out&lt;bool&gt; error_signal;</div>
<div class="line">    sc_out&lt;bool&gt; data_ready_signal;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Clock and reset</span></div>
<div class="line">    sc_in&lt;bool&gt; clk;</div>
<div class="line">    sc_in&lt;bool&gt; reset_n;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// SystemC process methods</span></div>
<div class="line">    <span class="keywordtype">void</span> protocol_thread();</div>
<div class="line">    <span class="keywordtype">void</span> handshake_thread();</div>
<div class="line">    <span class="keywordtype">void</span> record_processing_thread();</div>
<div class="line">    <span class="keywordtype">void</span> security_monitoring_thread();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration and control</span></div>
<div class="line">    <span class="keywordtype">void</span> configure(<span class="keyword">const</span> protocol_config&amp; config);</div>
<div class="line">    protocol_config get_configuration() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> set_role(<span class="keywordtype">bool</span> is_server);</div>
<div class="line">    <span class="keywordtype">bool</span> is_server_role() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> set_certificates(<span class="keyword">const</span> std::vector&lt;std::vector&lt;uint8_t&gt;&gt;&amp; cert_chain);</div>
<div class="line">    <span class="keywordtype">void</span> set_private_key(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; private_key);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics and monitoring</span></div>
<div class="line">    protocol_stack_stats get_statistics() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> reset_statistics();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Timing model interface</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_timing_model(std::shared_ptr&lt;timing_model_base&gt; <a class="code hl_variable" href="hardware__acceleration_8cpp.html#a2e5f0c4b01fa6a42a6a2215b44a116d9">model</a>) <span class="keyword">override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> timing_stats get_timing_statistics() <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> reset() <span class="keyword">override</span>;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    SC_HAS_PROCESS(dtls_protocol_stack);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Internal state</span></div>
<div class="line">    protocol_config config_;</div>
<div class="line">    ConnectionState current_state_;</div>
<div class="line">    <span class="keywordtype">bool</span> is_server_;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Subcomponents</span></div>
<div class="line">    std::unique_ptr&lt;record_layer_model&gt; record_layer_;</div>
<div class="line">    std::unique_ptr&lt;handshake_manager_model&gt; handshake_mgr_;</div>
<div class="line">    std::unique_ptr&lt;crypto_engine_model&gt; crypto_engine_;</div>
<div class="line">    std::unique_ptr&lt;security_monitor_model&gt; security_monitor_;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Internal FIFOs and channels</span></div>
<div class="line">    sc_fifo&lt;dtls_extension::dtls_message&gt; incoming_messages;</div>
<div class="line">    sc_fifo&lt;dtls_extension::dtls_message&gt; outgoing_messages;</div>
<div class="line">    sc_fifo&lt;handshake_state_event&gt; handshake_events;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Timing and performance</span></div>
<div class="line">    <span class="keyword">mutable</span> timing_stats timing_statistics_;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Helper methods</span></div>
<div class="line">    <span class="keywordtype">void</span> process_incoming_message(<span class="keyword">const</span> dtls_extension::dtls_message&amp; msg);</div>
<div class="line">    <span class="keywordtype">void</span> send_outgoing_message(<span class="keyword">const</span> dtls_extension::dtls_message&amp; msg);</div>
<div class="line">    <span class="keywordtype">void</span> update_connection_state(ConnectionState new_state);</div>
<div class="line">    <span class="keywordtype">void</span> handle_security_event(<span class="keyword">const</span> security_event&amp; event);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Configuration structures</span></div>
<div class="line"><span class="keyword">struct </span>protocol_config {</div>
<div class="line">    <span class="comment">// Basic configuration</span></div>
<div class="line">    std::vector&lt;CipherSuite&gt; supported_cipher_suites;</div>
<div class="line">    std::vector&lt;NamedGroup&gt; supported_groups;</div>
<div class="line">    std::vector&lt;SignatureScheme&gt; supported_signatures;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Timing parameters</span></div>
<div class="line">    sc_time handshake_timeout;</div>
<div class="line">    sc_time retransmission_timeout;</div>
<div class="line">    uint32_t max_retransmissions;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Feature flags</span></div>
<div class="line">    <span class="keywordtype">bool</span> enable_connection_id;</div>
<div class="line">    uint8_t connection_id_length;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_early_data;</div>
<div class="line">    uint32_t max_early_data_size;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_session_resumption;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Security settings</span></div>
<div class="line">    SecurityLevel security_level;</div>
<div class="line">    <span class="keywordtype">bool</span> enforce_perfect_forward_secrecy;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// SystemC-specific settings</span></div>
<div class="line">    <span class="keywordtype">bool</span> enable_timing_annotation;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_power_estimation;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_debug_trace;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">static</span> protocol_config default_config();</div>
<div class="line">    <span class="keyword">static</span> protocol_config server_config();</div>
<div class="line">    <span class="keyword">static</span> protocol_config client_config();</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Statistics structure</span></div>
<div class="line"><span class="keyword">struct </span>protocol_stack_stats {</div>
<div class="line">    <span class="comment">// Protocol statistics</span></div>
<div class="line">    uint64_t handshakes_completed;</div>
<div class="line">    uint64_t handshakes_failed;</div>
<div class="line">    uint64_t messages_sent;</div>
<div class="line">    uint64_t messages_received;</div>
<div class="line">    uint64_t bytes_sent;</div>
<div class="line">    uint64_t bytes_received;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Timing statistics</span></div>
<div class="line">    sc_time total_handshake_time;</div>
<div class="line">    sc_time average_handshake_time;</div>
<div class="line">    sc_time total_processing_time;</div>
<div class="line">    sc_time average_message_processing_time;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Security statistics</span></div>
<div class="line">    uint32_t replay_attacks_blocked;</div>
<div class="line">    uint32_t invalid_signatures_detected;</div>
<div class="line">    uint32_t key_updates_performed;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Performance metrics</span></div>
<div class="line">    <span class="keywordtype">double</span> throughput_mbps;</div>
<div class="line">    <span class="keywordtype">double</span> packet_rate_pps;</div>
<div class="line">    <span class="keywordtype">double</span> cpu_utilization_percent;</div>
<div class="line">    <span class="keywordtype">double</span> power_consumption_mw;</div>
<div class="line">    </div>
<div class="line">    protocol_stack_stats();</div>
<div class="line">    <span class="keywordtype">void</span> reset();</div>
<div class="line">    std::string <a class="code hl_function" href="namespacedtls_1_1v13.html#aaac42ceaa9423141c293c1fa726010d0">to_string</a>() <span class="keyword">const</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aaac42ceaa9423141c293c1fa726010d0"><div class="ttname"><a href="namespacedtls_1_1v13.html#aaac42ceaa9423141c293c1fa726010d0">dtls::v13::to_string</a></div><div class="ttdeci">std::string to_string(ContentType type)</div><div class="ttdef"><b>Definition</b> <a href="types_8cpp_source.html#l00011">types.cpp:11</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md869"></a>
Subcomponent Models</h2>
<h3><a class="anchor" id="autotoc_md870"></a>
Record Layer Model</h3>
<div class="fragment"><div class="line"><span class="keyword">class </span>record_layer_model : <span class="keyword">public</span> dtls_module_base {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    record_layer_model(sc_module_name name, <span class="keyword">const</span> timing_config&amp; timing);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// TLM interfaces</span></div>
<div class="line">    tlm_target_socket&lt;&gt; plaintext_in;</div>
<div class="line">    tlm_initiator_socket&lt;&gt; ciphertext_out;</div>
<div class="line">    tlm_target_socket&lt;&gt; ciphertext_in;</div>
<div class="line">    tlm_initiator_socket&lt;&gt; plaintext_out;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Control interface</span></div>
<div class="line">    sc_export&lt;record_layer_control_if&gt; control_export;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration</span></div>
<div class="line">    <span class="keywordtype">void</span> set_encryption_keys(Epoch epoch, </div>
<div class="line">                           <span class="keyword">const</span> KeyMaterial&amp; key, </div>
<div class="line">                           <span class="keyword">const</span> KeyMaterial&amp; iv,</div>
<div class="line">                           AEADCipher cipher);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> enable_sequence_number_encryption(<span class="keywordtype">bool</span> enable);</div>
<div class="line">    <span class="keywordtype">void</span> set_connection_id(<span class="keyword">const</span> ConnectionID&amp; cid);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span>record_layer_stats {</div>
<div class="line">        uint64_t records_encrypted;</div>
<div class="line">        uint64_t records_decrypted;</div>
<div class="line">        uint64_t encryption_failures;</div>
<div class="line">        uint64_t decryption_failures;</div>
<div class="line">        sc_time total_encryption_time;</div>
<div class="line">        sc_time total_decryption_time;</div>
<div class="line">    } statistics;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> encrypt_thread();</div>
<div class="line">    <span class="keywordtype">void</span> decrypt_thread();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    std::map&lt;Epoch, crypto_context&gt; encryption_contexts_;</div>
<div class="line">    std::optional&lt;ConnectionID&gt; connection_id_;</div>
<div class="line">    <span class="keywordtype">bool</span> sequence_encryption_enabled_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Record layer control interface</span></div>
<div class="line"><span class="keyword">class </span>record_layer_control_if : <span class="keyword">public</span> <span class="keyword">virtual</span> sc_interface {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_write_keys(Epoch epoch, <span class="keyword">const</span> KeyMaterial&amp; key, </div>
<div class="line">                               <span class="keyword">const</span> KeyMaterial&amp; iv, AEADCipher cipher) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_read_keys(Epoch epoch, <span class="keyword">const</span> KeyMaterial&amp; key, </div>
<div class="line">                              <span class="keyword">const</span> KeyMaterial&amp; iv, AEADCipher cipher) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> update_keys(<span class="keyword">const</span> KeyMaterial&amp; update_secret) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_typedef" href="group__CoreTypes.html#ga50089dc7f9d67ec4e7563999a0e01a4b">SequenceNumber</a> get_next_sequence_number(Epoch epoch) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> validate_sequence_number(Epoch epoch, SequenceNumber seq) = 0;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md871"></a>
Crypto Engine Model</h3>
<div class="fragment"><div class="line"><span class="keyword">class </span>crypto_engine_model : <span class="keyword">public</span> dtls_module_base {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    crypto_engine_model(sc_module_name name, </div>
<div class="line">                       <span class="keyword">const</span> crypto_config&amp; config,</div>
<div class="line">                       <span class="keyword">const</span> timing_config&amp; timing);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// TLM interfaces for crypto operations</span></div>
<div class="line">    tlm_target_socket&lt;&gt; hash_request_socket;</div>
<div class="line">    tlm_initiator_socket&lt;&gt; hash_response_socket;</div>
<div class="line">    tlm_target_socket&lt;&gt; encrypt_request_socket;</div>
<div class="line">    tlm_initiator_socket&lt;&gt; encrypt_response_socket;</div>
<div class="line">    tlm_target_socket&lt;&gt; sign_request_socket;</div>
<div class="line">    tlm_initiator_socket&lt;&gt; sign_response_socket;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Hardware acceleration interface</span></div>
<div class="line">    sc_port&lt;tlm_fifo_get_if&lt;crypto_request&gt;&gt; hw_accel_request_port;</div>
<div class="line">    sc_port&lt;tlm_fifo_put_if&lt;crypto_response&gt;&gt; hw_accel_response_port;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration</span></div>
<div class="line">    <span class="keyword">struct </span>crypto_config {</div>
<div class="line">        <span class="comment">// Provider selection</span></div>
<div class="line">        std::string provider_name;</div>
<div class="line">        <span class="keywordtype">bool</span> enable_hardware_acceleration;</div>
<div class="line">        <span class="keywordtype">bool</span> enable_constant_time_operations;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Performance settings</span></div>
<div class="line">        uint32_t max_concurrent_operations;</div>
<div class="line">        sc_time operation_timeout;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Security settings</span></div>
<div class="line">        <span class="keywordtype">bool</span> enable_side_channel_protection;</div>
<div class="line">        <span class="keywordtype">bool</span> enable_fault_injection_protection;</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">static</span> crypto_config default_config();</div>
<div class="line">        <span class="keyword">static</span> crypto_config hardware_accelerated_config();</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Operation interfaces</span></div>
<div class="line">    <span class="keywordtype">void</span> hash_async(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data, </div>
<div class="line">                   HashAlgorithm algorithm,</div>
<div class="line">                   std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp;)&gt; callback);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> encrypt_async(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; plaintext,</div>
<div class="line">                      <span class="keyword">const</span> KeyMaterial&amp; key,</div>
<div class="line">                      AEADCipher cipher,</div>
<div class="line">                      std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp;)&gt; callback);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> sign_async(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; message,</div>
<div class="line">                   <span class="keyword">const</span> KeyMaterial&amp; private_key,</div>
<div class="line">                   SignatureScheme scheme,</div>
<div class="line">                   std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp;)&gt; callback);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span>crypto_stats {</div>
<div class="line">        uint64_t hash_operations;</div>
<div class="line">        uint64_t encrypt_operations;</div>
<div class="line">        uint64_t decrypt_operations;</div>
<div class="line">        uint64_t sign_operations;</div>
<div class="line">        uint64_t verify_operations;</div>
<div class="line">        </div>
<div class="line">        sc_time total_hash_time;</div>
<div class="line">        sc_time total_encrypt_time;</div>
<div class="line">        sc_time total_decrypt_time;</div>
<div class="line">        sc_time total_sign_time;</div>
<div class="line">        sc_time total_verify_time;</div>
<div class="line">        </div>
<div class="line">        uint32_t hardware_acceleration_hits;</div>
<div class="line">        <span class="keywordtype">double</span> power_consumption_mw;</div>
<div class="line">    } statistics;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> crypto_operation_thread();</div>
<div class="line">    <span class="keywordtype">void</span> hardware_acceleration_thread();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    crypto_config config_;</div>
<div class="line">    std::queue&lt;crypto_request&gt; operation_queue_;</div>
<div class="line">    std::shared_ptr&lt;crypto_provider_model&gt; software_provider_;</div>
<div class="line">    std::shared_ptr&lt;hardware_crypto_model&gt; hardware_provider_;</div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md872"></a>
Timing Models</h1>
<h2><a class="anchor" id="autotoc_md873"></a>
Configurable Timing Framework</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::systemc {</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Base timing model interface</span></div>
<div class="line"><span class="keyword">class </span>timing_model_base {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> ~timing_model_base() = <span class="keywordflow">default</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Core timing methods</span></div>
<div class="line">    <span class="keyword">virtual</span> sc_time get_handshake_latency(HandshakeType type) <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> sc_time get_crypto_operation_latency(<span class="keyword">const</span> std::string&amp; operation,</div>
<div class="line">                                                <span class="keywordtype">size_t</span> data_size) <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> sc_time get_record_processing_latency(<span class="keywordtype">size_t</span> record_size) <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> sc_time get_network_transmission_latency(<span class="keywordtype">size_t</span> data_size) <span class="keyword">const</span> = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Advanced timing</span></div>
<div class="line">    <span class="keyword">virtual</span> sc_time get_power_on_latency() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> sc_time get_context_switch_latency() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">double</span> get_power_consumption(<span class="keyword">const</span> std::string&amp; operation) <span class="keyword">const</span> = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_clock_frequency(<span class="keywordtype">double</span> freq_mhz) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_memory_latency(sc_time latency) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> enable_power_modeling(<span class="keywordtype">bool</span> enable) = 0;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Approximate timing model (fast simulation)</span></div>
<div class="line"><span class="keyword">class </span>approximate_timing_model : <span class="keyword">public</span> timing_model_base {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    approximate_timing_model(<span class="keyword">const</span> approximate_timing_config&amp; config);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Implementation of timing interface</span></div>
<div class="line">    <span class="keyword">virtual</span> sc_time get_handshake_latency(HandshakeType type) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> sc_time get_crypto_operation_latency(<span class="keyword">const</span> std::string&amp; operation,</div>
<div class="line">                                                <span class="keywordtype">size_t</span> data_size) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="comment">// ... other methods</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration structure</span></div>
<div class="line">    <span class="keyword">struct </span>approximate_timing_config {</div>
<div class="line">        sc_time base_handshake_latency = sc_time(10, SC_MS);</div>
<div class="line">        sc_time base_crypto_latency = sc_time(100, SC_US);</div>
<div class="line">        sc_time base_record_latency = sc_time(10, SC_US);</div>
<div class="line">        sc_time base_network_latency = sc_time(1, SC_MS);</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">double</span> crypto_scaling_factor = 1.0;  <span class="comment">// per byte</span></div>
<div class="line">        <span class="keywordtype">double</span> network_scaling_factor = 0.001;  <span class="comment">// per byte</span></div>
<div class="line">        </div>
<div class="line">        <span class="keyword">static</span> approximate_timing_config default_config();</div>
<div class="line">        <span class="keyword">static</span> approximate_timing_config fast_simulation_config();</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    approximate_timing_config config_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Cycle-accurate timing model (detailed simulation)</span></div>
<div class="line"><span class="keyword">class </span>cycle_accurate_timing_model : <span class="keyword">public</span> timing_model_base {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    cycle_accurate_timing_model(<span class="keyword">const</span> cycle_accurate_config&amp; config);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Detailed timing implementation</span></div>
<div class="line">    <span class="keyword">virtual</span> sc_time get_handshake_latency(HandshakeType type) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> sc_time get_crypto_operation_latency(<span class="keyword">const</span> std::string&amp; operation,</div>
<div class="line">                                                <span class="keywordtype">size_t</span> data_size) <span class="keyword">const override</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Hardware-specific timing</span></div>
<div class="line">    sc_time get_cache_access_latency(cache_level level, cache_access_type type) <span class="keyword">const</span>;</div>
<div class="line">    sc_time get_instruction_execution_latency(instruction_type instr) <span class="keyword">const</span>;</div>
<div class="line">    sc_time get_memory_access_latency(memory_type mem_type, <span class="keywordtype">size_t</span> size) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration for specific hardware</span></div>
<div class="line">    <span class="keyword">struct </span>cycle_accurate_config {</div>
<div class="line">        <span class="keywordtype">double</span> cpu_frequency_mhz = 1000.0;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Cache configuration</span></div>
<div class="line">        <span class="keyword">struct </span>cache_config {</div>
<div class="line">            sc_time l1_hit_latency = sc_time(1, SC_NS);</div>
<div class="line">            sc_time l2_hit_latency = sc_time(10, SC_NS);</div>
<div class="line">            sc_time l3_hit_latency = sc_time(30, SC_NS);</div>
<div class="line">            sc_time main_memory_latency = sc_time(100, SC_NS);</div>
<div class="line">        } cache;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Crypto unit configuration</span></div>
<div class="line">        <span class="keyword">struct </span>crypto_unit_config {</div>
<div class="line">            sc_time aes_setup_latency = sc_time(50, SC_NS);</div>
<div class="line">            sc_time aes_per_block_latency = sc_time(5, SC_NS);</div>
<div class="line">            sc_time hash_per_block_latency = sc_time(3, SC_NS);</div>
<div class="line">            sc_time rng_latency = sc_time(100, SC_NS);</div>
<div class="line">        } crypto_unit;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Network interface configuration</span></div>
<div class="line">        <span class="keyword">struct </span>network_config {</div>
<div class="line">            <span class="keywordtype">double</span> bandwidth_mbps = 1000.0;  <span class="comment">// 1 Gbps</span></div>
<div class="line">            sc_time packet_processing_latency = sc_time(1, SC_US);</div>
<div class="line">            sc_time interrupt_latency = sc_time(500, SC_NS);</div>
<div class="line">        } network;</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">static</span> cycle_accurate_config arm_cortex_a75_config();</div>
<div class="line">        <span class="keyword">static</span> cycle_accurate_config intel_xeon_config();</div>
<div class="line">        <span class="keyword">static</span> cycle_accurate_config embedded_config();</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    cycle_accurate_config config_;</div>
<div class="line">    <span class="keyword">mutable</span> std::map&lt;std::string, sc_time&gt; operation_cache_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Power modeling extension</span></div>
<div class="line"><span class="keyword">class </span>power_model {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    power_model(<span class="keyword">const</span> power_config&amp; config);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Power consumption estimation</span></div>
<div class="line">    <span class="keywordtype">double</span> get_static_power_mw() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">double</span> get_dynamic_power_mw(<span class="keyword">const</span> std::string&amp; operation, </div>
<div class="line">                               <span class="keywordtype">double</span> activity_factor) <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">double</span> get_leakage_power_mw() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Energy consumption</span></div>
<div class="line">    <span class="keywordtype">double</span> get_operation_energy_uj(<span class="keyword">const</span> std::string&amp; operation, </div>
<div class="line">                                  sc_time duration) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">struct </span>power_config {</div>
<div class="line">        <span class="keywordtype">double</span> voltage_v = 1.2;</div>
<div class="line">        <span class="keywordtype">double</span> temperature_c = 25.0;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Component power characteristics</span></div>
<div class="line">        <span class="keyword">struct </span>component_power {</div>
<div class="line">            <span class="keywordtype">double</span> static_power_mw = 100.0;</div>
<div class="line">            <span class="keywordtype">double</span> dynamic_power_per_mhz_mw = 0.1;</div>
<div class="line">            <span class="keywordtype">double</span> leakage_coefficient = 0.01;</div>
<div class="line">        };</div>
<div class="line">        </div>
<div class="line">        component_power cpu_core;</div>
<div class="line">        component_power crypto_unit;</div>
<div class="line">        component_power memory_controller;</div>
<div class="line">        component_power network_interface;</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">static</span> power_config mobile_config();</div>
<div class="line">        <span class="keyword">static</span> power_config server_config();</div>
<div class="line">        <span class="keyword">static</span> power_config iot_config();</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    power_config config_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md874"></a>
Communication Channels</h1>
<h2><a class="anchor" id="autotoc_md875"></a>
DTLS-Specific Channels</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::systemc {</div>
<div class="line"> </div>
<div class="line"><span class="comment">// DTLS message channel with flow control</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T = dtls_extension::dtls_message&gt;</div>
<div class="line"><span class="keyword">class </span>dtls_message_channel : <span class="keyword">public</span> sc_channel, </div>
<div class="line">                            <span class="keyword">public</span> tlm_fifo_get_if&lt;T&gt;,</div>
<div class="line">                            <span class="keyword">public</span> tlm_fifo_put_if&lt;T&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">explicit</span> dtls_message_channel(<span class="keywordtype">size_t</span> size = 16);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// tlm_fifo_get_if implementation</span></div>
<div class="line">    <span class="keyword">virtual</span> T get(tlm_tag&lt;T&gt;* = <span class="keyword">nullptr</span>) <span class="keyword">override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> nb_get(T&amp; val) <span class="keyword">override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> nb_can_get(tlm_tag&lt;T&gt;* = <span class="keyword">nullptr</span>) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keyword">const</span> sc_event&amp; ok_to_get(tlm_tag&lt;T&gt;* = <span class="keyword">nullptr</span>) <span class="keyword">const override</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// tlm_fifo_put_if implementation</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> put(<span class="keyword">const</span> T&amp; val) <span class="keyword">override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> nb_put(<span class="keyword">const</span> T&amp; val) <span class="keyword">override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> nb_can_put(tlm_tag&lt;T&gt;* = <span class="keyword">nullptr</span>) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keyword">const</span> sc_event&amp; ok_to_put(tlm_tag&lt;T&gt;* = <span class="keyword">nullptr</span>) <span class="keyword">const override</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// DTLS-specific methods</span></div>
<div class="line">    <span class="keywordtype">void</span> set_priority_filter(std::function&lt;<span class="keywordtype">bool</span>(<span class="keyword">const</span> T&amp;)&gt; filter);</div>
<div class="line">    <span class="keywordtype">void</span> enable_flow_control(<span class="keywordtype">bool</span> enable);</div>
<div class="line">    <span class="keywordtype">void</span> set_backpressure_threshold(<span class="keywordtype">size_t</span> threshold);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span>channel_stats {</div>
<div class="line">        uint64_t messages_sent;</div>
<div class="line">        uint64_t messages_received;</div>
<div class="line">        uint64_t messages_dropped;</div>
<div class="line">        uint64_t backpressure_events;</div>
<div class="line">        sc_time total_latency;</div>
<div class="line">        <span class="keywordtype">size_t</span> peak_usage;</div>
<div class="line">    } statistics;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">const</span> channel_stats&amp; get_statistics()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> statistics_; }</div>
<div class="line">    <span class="keywordtype">void</span> reset_statistics() { statistics_ = channel_stats{}; }</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    std::queue&lt;T&gt; queue_;</div>
<div class="line">    <span class="keywordtype">size_t</span> max_size_;</div>
<div class="line">    <span class="keyword">mutable</span> sc_event ok_to_get_event_;</div>
<div class="line">    <span class="keyword">mutable</span> sc_event ok_to_put_event_;</div>
<div class="line">    std::function&lt;bool(<span class="keyword">const</span> T&amp;)&gt; priority_filter_;</div>
<div class="line">    <span class="keywordtype">bool</span> flow_control_enabled_;</div>
<div class="line">    <span class="keywordtype">size_t</span> backpressure_threshold_;</div>
<div class="line">    channel_stats statistics_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Network simulation channel</span></div>
<div class="line"><span class="keyword">class </span>network_channel : <span class="keyword">public</span> sc_channel {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    network_channel(sc_module_name name, <span class="keyword">const</span> network_config&amp; config);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Network interface</span></div>
<div class="line">    <span class="keywordtype">void</span> send_packet(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; packet, </div>
<div class="line">                    <span class="keyword">const</span> NetworkAddress&amp; dest,</div>
<div class="line">                    packet_priority priority = packet_priority::NORMAL);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> register_receiver(<span class="keyword">const</span> NetworkAddress&amp; addr,</div>
<div class="line">                          std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp;)&gt; callback);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Network characteristics</span></div>
<div class="line">    <span class="keyword">struct </span>network_config {</div>
<div class="line">        <span class="keywordtype">double</span> bandwidth_mbps = 100.0;</div>
<div class="line">        sc_time propagation_delay = sc_time(1, SC_MS);</div>
<div class="line">        <span class="keywordtype">double</span> packet_loss_rate = 0.001;  <span class="comment">// 0.1%</span></div>
<div class="line">        sc_time jitter_max = sc_time(100, SC_US);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Quality of Service</span></div>
<div class="line">        <span class="keywordtype">bool</span> enable_qos = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordtype">size_t</span> max_queue_size = 1000;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Error simulation</span></div>
<div class="line">        <span class="keywordtype">bool</span> enable_error_injection = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordtype">double</span> bit_error_rate = 1e-9;</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">static</span> network_config lan_config();</div>
<div class="line">        <span class="keyword">static</span> network_config wan_config();</div>
<div class="line">        <span class="keyword">static</span> network_config wireless_config();</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> set_network_config(<span class="keyword">const</span> network_config&amp; config);</div>
<div class="line">    network_config get_network_config()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> config_; }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics and monitoring</span></div>
<div class="line">    <span class="keyword">struct </span>network_stats {</div>
<div class="line">        uint64_t packets_sent;</div>
<div class="line">        uint64_t packets_received;</div>
<div class="line">        uint64_t packets_dropped;</div>
<div class="line">        uint64_t packets_corrupted;</div>
<div class="line">        uint64_t bytes_transmitted;</div>
<div class="line">        sc_time total_latency;</div>
<div class="line">        <span class="keywordtype">double</span> current_utilization;</div>
<div class="line">    } statistics;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">const</span> network_stats&amp; get_statistics()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> statistics_; }</div>
<div class="line">    </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> network_thread();</div>
<div class="line">    <span class="keywordtype">void</span> packet_corruption_thread();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    network_config config_;</div>
<div class="line">    std::map&lt;NetworkAddress, std::function&lt;void(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp;)&gt;&gt; receivers_;</div>
<div class="line">    std::queue&lt;network_packet&gt; packet_queue_;</div>
<div class="line">    network_stats statistics_;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">struct </span>network_packet {</div>
<div class="line">        std::vector&lt;uint8_t&gt; <a class="code hl_variable" href="namespacedtls_1_1v13_1_1crypto.html#a54dd791091de8efe4b57d9d26e14a2f2">data</a>;</div>
<div class="line">        NetworkAddress source;</div>
<div class="line">        NetworkAddress <a class="code hl_variable" href="namespacedtls_1_1v13_1_1memory_1_1utils.html#a5da6b7d0d20688d166ff3b9f280cdfac">destination</a>;</div>
<div class="line">        packet_priority priority;</div>
<div class="line">        sc_time timestamp;</div>
<div class="line">    };</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1crypto_html_a54dd791091de8efe4b57d9d26e14a2f2"><div class="ttname"><a href="namespacedtls_1_1v13_1_1crypto.html#a54dd791091de8efe4b57d9d26e14a2f2">dtls::v13::crypto::data</a></div><div class="ttdeci">__attribute__((visibility(&quot;default&quot;))) Result&lt; std __attribute__((visibility(&quot;default&quot;))) Result&lt; memory __attribute__((visibility(&quot;default&quot;))) Result&lt; memory __attribute__((visibility(&quot;default&quot;))) Result&lt; std __attribute__((visibility(&quot;default&quot;))) Result&lt; std __attribute__((visibility(&quot;default&quot;))) Result&lt; std __attribute__((visibility(&quot;default&quot;))) Result&lt; std __attribute__((visibility(&quot;default&quot;))) Result&lt; std __attribute__((visibility(&quot;default&quot;))) Result&lt; std const void * data</div><div class="ttdef"><b>Definition</b> <a href="hash_8h_source.html#l00109">hash.h:109</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1memory_1_1utils_html_a5da6b7d0d20688d166ff3b9f280cdfac"><div class="ttname"><a href="namespacedtls_1_1v13_1_1memory_1_1utils.html#a5da6b7d0d20688d166ff3b9f280cdfac">dtls::v13::memory::utils::destination</a></div><div class="ttdeci">MutableBufferView &amp; destination</div><div class="ttdef"><b>Definition</b> <a href="memory__utils_8h_source.html#l00132">memory_utils.h:132</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md876"></a>
Testbenches</h1>
<h2><a class="anchor" id="autotoc_md877"></a>
Protocol Verification Testbench</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::systemc::test {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>dtls_protocol_testbench : <span class="keyword">public</span> sc_module {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    dtls_protocol_testbench(sc_module_name name, <span class="keyword">const</span> testbench_config&amp; config);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Test components</span></div>
<div class="line">    std::unique_ptr&lt;dtls_protocol_stack&gt; client_stack;</div>
<div class="line">    std::unique_ptr&lt;dtls_protocol_stack&gt; server_stack;</div>
<div class="line">    std::unique_ptr&lt;network_channel&gt; network;</div>
<div class="line">    std::unique_ptr&lt;test_traffic_generator&gt; traffic_gen;</div>
<div class="line">    std::unique_ptr&lt;test_monitor&gt; monitor;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Test control</span></div>
<div class="line">    <span class="keywordtype">void</span> run_test_suite();</div>
<div class="line">    <span class="keywordtype">void</span> run_single_test(<span class="keyword">const</span> std::string&amp; test_name);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Test cases</span></div>
<div class="line">    <span class="keywordtype">void</span> test_basic_handshake();</div>
<div class="line">    <span class="keywordtype">void</span> test_session_resumption();</div>
<div class="line">    <span class="keywordtype">void</span> test_early_data();</div>
<div class="line">    <span class="keywordtype">void</span> test_connection_id_migration();</div>
<div class="line">    <span class="keywordtype">void</span> test_key_update();</div>
<div class="line">    <span class="keywordtype">void</span> test_error_recovery();</div>
<div class="line">    <span class="keywordtype">void</span> test_dos_protection();</div>
<div class="line">    <span class="keywordtype">void</span> test_interoperability();</div>
<div class="line">    <span class="keywordtype">void</span> test_performance_regression();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration</span></div>
<div class="line">    <span class="keyword">struct </span>testbench_config {</div>
<div class="line">        <span class="comment">// Test selection</span></div>
<div class="line">        std::set&lt;std::string&gt; enabled_tests;</div>
<div class="line">        <span class="keywordtype">bool</span> run_all_tests = <span class="keyword">true</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Simulation parameters</span></div>
<div class="line">        sc_time simulation_timeout = sc_time(10, SC_SEC);</div>
<div class="line">        <span class="keywordtype">bool</span> enable_logging = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordtype">bool</span> enable_waveform_dump = <span class="keyword">false</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Test data generation</span></div>
<div class="line">        <span class="keyword">struct </span>traffic_config {</div>
<div class="line">            <span class="keywordtype">size_t</span> min_message_size = 64;</div>
<div class="line">            <span class="keywordtype">size_t</span> max_message_size = 1500;</div>
<div class="line">            <span class="keywordtype">double</span> message_rate_hz = 100.0;</div>
<div class="line">            <span class="keywordtype">size_t</span> total_messages = 1000;</div>
<div class="line">        } traffic;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Network simulation</span></div>
<div class="line">        network_channel::network_config network;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Coverage collection</span></div>
<div class="line">        <span class="keywordtype">bool</span> enable_coverage = <span class="keyword">true</span>;</div>
<div class="line">        std::string coverage_db_path = <span class="stringliteral">&quot;coverage.db&quot;</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">static</span> testbench_config regression_config();</div>
<div class="line">        <span class="keyword">static</span> testbench_config performance_config();</div>
<div class="line">        <span class="keyword">static</span> testbench_config debug_config();</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Test results</span></div>
<div class="line">    <span class="keyword">struct </span>test_results {</div>
<div class="line">        <span class="keyword">struct </span>test_case_result {</div>
<div class="line">            std::string name;</div>
<div class="line">            <span class="keywordtype">bool</span> passed;</div>
<div class="line">            std::string failure_reason;</div>
<div class="line">            sc_time execution_time;</div>
<div class="line">            std::map&lt;std::string, double&gt; metrics;</div>
<div class="line">        };</div>
<div class="line">        </div>
<div class="line">        std::vector&lt;test_case_result&gt; test_cases;</div>
<div class="line">        <span class="keywordtype">size_t</span> total_tests = 0;</div>
<div class="line">        <span class="keywordtype">size_t</span> passed_tests = 0;</div>
<div class="line">        <span class="keywordtype">size_t</span> failed_tests = 0;</div>
<div class="line">        sc_time total_execution_time;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">void</span> print_summary() <span class="keyword">const</span>;</div>
<div class="line">        <span class="keywordtype">void</span> save_to_file(<span class="keyword">const</span> std::string&amp; filename) <span class="keyword">const</span>;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    test_results get_test_results()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> results_; }</div>
<div class="line">    </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    SC_HAS_PROCESS(dtls_protocol_testbench);</div>
<div class="line">    <span class="keywordtype">void</span> test_runner_thread();</div>
<div class="line">    <span class="keywordtype">void</span> timeout_monitor_thread();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    testbench_config config_;</div>
<div class="line">    test_results results_;</div>
<div class="line">    sc_event test_complete_event_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Traffic generator for testing</span></div>
<div class="line"><span class="keyword">class </span>test_traffic_generator : <span class="keyword">public</span> sc_module {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    test_traffic_generator(sc_module_name name, <span class="keyword">const</span> traffic_config&amp; config);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// TLM interface to connect to protocol stack</span></div>
<div class="line">    tlm_initiator_socket&lt;&gt; socket;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Control interface</span></div>
<div class="line">    sc_in&lt;bool&gt; start_signal;</div>
<div class="line">    sc_out&lt;bool&gt; complete_signal;</div>
<div class="line">    sc_in&lt;bool&gt; clk;</div>
<div class="line">    sc_in&lt;bool&gt; reset_n;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration</span></div>
<div class="line">    <span class="keyword">struct </span>traffic_config {</div>
<div class="line">        <span class="keyword">enum class</span> pattern { CONSTANT_RATE, BURSTY, RANDOM, TRACE_FILE } pattern;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Rate configuration</span></div>
<div class="line">        <span class="keywordtype">double</span> base_rate_hz = 100.0;</div>
<div class="line">        <span class="keywordtype">double</span> burst_rate_hz = 1000.0;</div>
<div class="line">        sc_time burst_duration = sc_time(100, SC_MS);</div>
<div class="line">        sc_time inter_burst_interval = sc_time(1, SC_SEC);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Message characteristics</span></div>
<div class="line">        <span class="keywordtype">size_t</span> min_size = 64;</div>
<div class="line">        <span class="keywordtype">size_t</span> max_size = 1500;</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13_1_1protocol.html#a62af73ef7cae0308f972faa7c917973a">ContentType</a> content_type = ContentType::APPLICATION_DATA;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Test duration</span></div>
<div class="line">        sc_time test_duration = sc_time(10, SC_SEC);</div>
<div class="line">        <span class="keywordtype">size_t</span> max_messages = 10000;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Trace file (if pattern == TRACE_FILE)</span></div>
<div class="line">        std::string trace_file_path;</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">static</span> traffic_config constant_rate_config(<span class="keywordtype">double</span> rate_hz);</div>
<div class="line">        <span class="keyword">static</span> traffic_config bursty_config();</div>
<div class="line">        <span class="keyword">static</span> traffic_config random_config();</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> configure(<span class="keyword">const</span> traffic_config&amp; config);</div>
<div class="line">    <span class="keywordtype">void</span> start_generation();</div>
<div class="line">    <span class="keywordtype">void</span> stop_generation();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span>generator_stats {</div>
<div class="line">        uint64_t messages_generated;</div>
<div class="line">        uint64_t bytes_generated;</div>
<div class="line">        <span class="keywordtype">double</span> actual_rate_hz;</div>
<div class="line">        sc_time generation_time;</div>
<div class="line">    } statistics;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> generation_thread();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    traffic_config config_;</div>
<div class="line">    <span class="keywordtype">bool</span> generating_;</div>
<div class="line">    generator_stats statistics_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1protocol_html_a62af73ef7cae0308f972faa7c917973a"><div class="ttname"><a href="namespacedtls_1_1v13_1_1protocol.html#a62af73ef7cae0308f972faa7c917973a">dtls::v13::protocol::ContentType</a></div><div class="ttdeci">ContentType</div><div class="ttdef"><b>Definition</b> <a href="record_8h_source.html#l00011">record.h:11</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md878"></a>
Performance Analysis</h1>
<h2><a class="anchor" id="autotoc_md879"></a>
Performance Monitoring and Analysis</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>dtls::systemc::analysis {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>performance_analyzer : <span class="keyword">public</span> sc_module {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    performance_analyzer(sc_module_name name);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Monitoring interfaces</span></div>
<div class="line">    <span class="keywordtype">void</span> register_protocol_stack(dtls_protocol_stack* stack, <span class="keyword">const</span> std::string&amp; name);</div>
<div class="line">    <span class="keywordtype">void</span> register_network_channel(network_channel* channel, <span class="keyword">const</span> std::string&amp; name);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Analysis methods</span></div>
<div class="line">    <span class="keywordtype">void</span> start_analysis();</div>
<div class="line">    <span class="keywordtype">void</span> stop_analysis();</div>
<div class="line">    <span class="keywordtype">void</span> generate_report();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Performance metrics</span></div>
<div class="line">    <span class="keyword">struct </span>performance_metrics {</div>
<div class="line">        <span class="comment">// Throughput metrics</span></div>
<div class="line">        <span class="keywordtype">double</span> peak_throughput_mbps;</div>
<div class="line">        <span class="keywordtype">double</span> average_throughput_mbps;</div>
<div class="line">        <span class="keywordtype">double</span> min_throughput_mbps;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Latency metrics</span></div>
<div class="line">        sc_time peak_latency;</div>
<div class="line">        sc_time average_latency;</div>
<div class="line">        sc_time min_latency;</div>
<div class="line">        sc_time p99_latency;  <span class="comment">// 99th percentile</span></div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Handshake performance</span></div>
<div class="line">        sc_time average_handshake_time;</div>
<div class="line">        <span class="keywordtype">double</span> handshake_success_rate;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Resource utilization</span></div>
<div class="line">        <span class="keywordtype">double</span> cpu_utilization;</div>
<div class="line">        <span class="keywordtype">double</span> memory_utilization;</div>
<div class="line">        <span class="keywordtype">double</span> network_utilization;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Power consumption</span></div>
<div class="line">        <span class="keywordtype">double</span> average_power_mw;</div>
<div class="line">        <span class="keywordtype">double</span> peak_power_mw;</div>
<div class="line">        <span class="keywordtype">double</span> total_energy_mj;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Error rates</span></div>
<div class="line">        <span class="keywordtype">double</span> packet_loss_rate;</div>
<div class="line">        <span class="keywordtype">double</span> retransmission_rate;</div>
<div class="line">        <span class="keywordtype">double</span> crypto_error_rate;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    performance_metrics get_current_metrics() <span class="keyword">const</span>;</div>
<div class="line">    std::vector&lt;performance_metrics&gt; get_historical_metrics() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Bottleneck analysis</span></div>
<div class="line">    <span class="keyword">struct </span>bottleneck_analysis {</div>
<div class="line">        <span class="keyword">enum class</span> bottleneck_type {</div>
<div class="line">            CPU_BOUND, MEMORY_BOUND, NETWORK_BOUND, </div>
<div class="line">            CRYPTO_BOUND, PROTOCOL_BOUND</div>
<div class="line">        } primary_bottleneck;</div>
<div class="line">        </div>
<div class="line">        std::map&lt;std::string, double&gt; component_utilization;</div>
<div class="line">        std::vector&lt;std::string&gt; optimization_suggestions;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    bottleneck_analysis analyze_bottlenecks() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Comparison and regression analysis</span></div>
<div class="line">    <span class="keyword">struct </span>comparison_result {</div>
<div class="line">        <span class="keywordtype">double</span> throughput_improvement_percent;</div>
<div class="line">        sc_time latency_improvement;</div>
<div class="line">        <span class="keywordtype">double</span> power_efficiency_improvement;</div>
<div class="line">        <span class="keywordtype">bool</span> performance_regression_detected;</div>
<div class="line">        std::vector&lt;std::string&gt; regression_details;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    comparison_result compare_with_baseline(<span class="keyword">const</span> performance_metrics&amp; baseline) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Report generation</span></div>
<div class="line">    <span class="keywordtype">void</span> save_metrics_csv(<span class="keyword">const</span> std::string&amp; filename) <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> save_performance_report(<span class="keyword">const</span> std::string&amp; filename) <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> generate_plots(<span class="keyword">const</span> std::string&amp; output_dir) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> monitoring_thread();</div>
<div class="line">    <span class="keywordtype">void</span> analysis_thread();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">struct </span>monitored_stack {</div>
<div class="line">        dtls_protocol_stack* stack;</div>
<div class="line">        std::string name;</div>
<div class="line">        std::vector&lt;performance_metrics&gt; history;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">struct </span>monitored_channel {</div>
<div class="line">        network_channel* channel;</div>
<div class="line">        std::string name;</div>
<div class="line">        std::vector&lt;network_channel::network_stats&gt; history;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    std::vector&lt;monitored_stack&gt; protocol_stacks_;</div>
<div class="line">    std::vector&lt;monitored_channel&gt; network_channels_;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">bool</span> analyzing_;</div>
<div class="line">    sc_time analysis_interval_;</div>
<div class="line">    performance_metrics current_metrics_;</div>
<div class="line">    std::vector&lt;performance_metrics&gt; historical_metrics_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md880"></a>
Examples</h1>
<h2><a class="anchor" id="autotoc_md881"></a>
Basic SystemC DTLS Client-Server</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;systemc&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dtls_systemc/protocol_stack.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dtls_systemc/channels.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>sc_core;</div>
<div class="line"><span class="keyword">using namespace </span>dtls::systemc;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> sc_main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    <span class="comment">// Create clock and reset</span></div>
<div class="line">    sc_clock clk(<span class="stringliteral">&quot;clk&quot;</span>, 10, SC_NS);</div>
<div class="line">    sc_signal&lt;bool&gt; reset_n(<span class="stringliteral">&quot;reset_n&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Network simulation</span></div>
<div class="line">    network_channel::network_config net_config = network_channel::network_config::lan_config();</div>
<div class="line">    network_channel network(<span class="stringliteral">&quot;network&quot;</span>, net_config);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Client configuration</span></div>
<div class="line">    protocol_config client_config = protocol_config::client_config();</div>
<div class="line">    client_config.enable_early_data = <span class="keyword">true</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Server configuration</span></div>
<div class="line">    protocol_config server_config = protocol_config::server_config();</div>
<div class="line">    server_config.enable_connection_id = <span class="keyword">true</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Create protocol stacks</span></div>
<div class="line">    dtls_protocol_stack client(<span class="stringliteral">&quot;client&quot;</span>, client_config);</div>
<div class="line">    dtls_protocol_stack server(<span class="stringliteral">&quot;server&quot;</span>, server_config);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connect clocks and resets</span></div>
<div class="line">    client.clk(clk);</div>
<div class="line">    client.reset_n(reset_n);</div>
<div class="line">    server.clk(clk);</div>
<div class="line">    server.reset_n(reset_n);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connect to network</span></div>
<div class="line">    <span class="comment">// Note: In real implementation, this would involve more complex networking</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configure addresses</span></div>
<div class="line">    NetworkAddress server_addr = NetworkAddress::from_string(<span class="stringliteral">&quot;192.168.1.100:4433&quot;</span>).value();</div>
<div class="line">    NetworkAddress client_addr = NetworkAddress::from_string(<span class="stringliteral">&quot;192.168.1.101:12345&quot;</span>).value();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Register network receivers</span></div>
<div class="line">    network.register_receiver(server_addr, [&amp;server](<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; packet) {</div>
<div class="line">        <span class="comment">// Process incoming packet in server</span></div>
<div class="line">        dtls_extension::dtls_message msg;</div>
<div class="line">        <span class="comment">// ... deserialize packet to message ...</span></div>
<div class="line">        <span class="comment">// server.process_message(msg);</span></div>
<div class="line">    });</div>
<div class="line">    </div>
<div class="line">    network.register_receiver(client_addr, [&amp;client](<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; packet) {</div>
<div class="line">        <span class="comment">// Process incoming packet in client</span></div>
<div class="line">        dtls_extension::dtls_message msg;</div>
<div class="line">        <span class="comment">// ... deserialize packet to message ...</span></div>
<div class="line">        <span class="comment">// client.process_message(msg);</span></div>
<div class="line">    });</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Set up event handlers</span></div>
<div class="line">    client.handshake_complete_signal.bind(sc_signal&lt;bool&gt;(<span class="stringliteral">&quot;client_handshake_complete&quot;</span>));</div>
<div class="line">    server.handshake_complete_signal.bind(sc_signal&lt;bool&gt;(<span class="stringliteral">&quot;server_handshake_complete&quot;</span>));</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Initialize simulation</span></div>
<div class="line">    reset_n = <span class="keyword">false</span>;</div>
<div class="line">    sc_start(100, SC_NS);  <span class="comment">// Reset period</span></div>
<div class="line">    reset_n = <span class="keyword">true</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Run simulation</span></div>
<div class="line">    sc_start(10, SC_SEC);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Print statistics</span></div>
<div class="line">    <span class="keyword">auto</span> client_stats = client.get_statistics();</div>
<div class="line">    <span class="keyword">auto</span> server_stats = server.get_statistics();</div>
<div class="line">    <span class="keyword">auto</span> network_stats = network.get_statistics();</div>
<div class="line">    </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Client Statistics:\n&quot;</span> &lt;&lt; client_stats.to_string() &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Server Statistics:\n&quot;</span> &lt;&lt; server_stats.to_string() &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Network Statistics:\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;  Packets sent: &quot;</span> &lt;&lt; network_stats.packets_sent &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;  Packets received: &quot;</span> &lt;&lt; network_stats.packets_received &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;  Utilization: &quot;</span> &lt;&lt; network_stats.current_utilization * 100 &lt;&lt; <span class="stringliteral">&quot;%&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md882"></a>
Performance Benchmarking Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;systemc&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dtls_systemc/protocol_stack.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dtls_systemc/test/testbench.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dtls_systemc/analysis/performance_analyzer.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>sc_core;</div>
<div class="line"><span class="keyword">using namespace </span>dtls::systemc;</div>
<div class="line"><span class="keyword">using namespace </span>dtls::systemc::test;</div>
<div class="line"><span class="keyword">using namespace </span>dtls::systemc::analysis;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>performance_benchmark : <span class="keyword">public</span> sc_module {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    performance_benchmark(sc_module_name name) : sc_module(name) {</div>
<div class="line">        <span class="comment">// Create testbench configuration for performance testing</span></div>
<div class="line">        testbench_config config = testbench_config::performance_config();</div>
<div class="line">        config.traffic.message_rate_hz = 10000.0;  <span class="comment">// High rate for stress testing</span></div>
<div class="line">        config.traffic.total_messages = 100000;</div>
<div class="line">        config.simulation_timeout = sc_time(30, SC_SEC);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Create testbench</span></div>
<div class="line">        testbench = std::make_unique&lt;dtls_protocol_testbench&gt;(<span class="stringliteral">&quot;testbench&quot;</span>, config);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Create performance analyzer</span></div>
<div class="line">        analyzer = std::make_unique&lt;performance_analyzer&gt;(<span class="stringliteral">&quot;analyzer&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Register components for monitoring</span></div>
<div class="line">        analyzer-&gt;register_protocol_stack(testbench-&gt;client_stack.get(), <span class="stringliteral">&quot;client&quot;</span>);</div>
<div class="line">        analyzer-&gt;register_protocol_stack(testbench-&gt;server_stack.get(), <span class="stringliteral">&quot;server&quot;</span>);</div>
<div class="line">        analyzer-&gt;register_network_channel(testbench-&gt;network.get(), <span class="stringliteral">&quot;network&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Start analysis thread</span></div>
<div class="line">        SC_THREAD(benchmark_thread);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> benchmark_thread() {</div>
<div class="line">        <span class="comment">// Wait for reset deassertion</span></div>
<div class="line">        wait(100, SC_NS);</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Starting performance benchmark...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Start performance analysis</span></div>
<div class="line">        analyzer-&gt;start_analysis();</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Run different test scenarios</span></div>
<div class="line">        run_throughput_test();</div>
<div class="line">        run_latency_test();</div>
<div class="line">        run_scalability_test();</div>
<div class="line">        run_power_efficiency_test();</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Stop analysis</span></div>
<div class="line">        analyzer-&gt;stop_analysis();</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Generate comprehensive report</span></div>
<div class="line">        generate_benchmark_report();</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Performance benchmark completed.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    std::unique_ptr&lt;dtls_protocol_testbench&gt; testbench;</div>
<div class="line">    std::unique_ptr&lt;performance_analyzer&gt; analyzer;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> run_throughput_test() {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Running throughput test...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Configure high-rate traffic</span></div>
<div class="line">        test_traffic_generator::traffic_config traffic_config;</div>
<div class="line">        traffic_config.pattern = test_traffic_generator::traffic_config::pattern::CONSTANT_RATE;</div>
<div class="line">        traffic_config.base_rate_hz = 50000.0;  <span class="comment">// 50k messages/sec</span></div>
<div class="line">        traffic_config.min_size = 1400;  <span class="comment">// Large messages for throughput</span></div>
<div class="line">        traffic_config.max_size = 1400;</div>
<div class="line">        traffic_config.test_duration = sc_time(5, SC_SEC);</div>
<div class="line">        </div>
<div class="line">        testbench-&gt;traffic_gen-&gt;configure(traffic_config);</div>
<div class="line">        testbench-&gt;traffic_gen-&gt;start_generation();</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Wait for test completion</span></div>
<div class="line">        wait(traffic_config.test_duration + sc_time(1, SC_SEC));</div>
<div class="line">        </div>
<div class="line">        testbench-&gt;traffic_gen-&gt;stop_generation();</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Collect metrics</span></div>
<div class="line">        <span class="keyword">auto</span> metrics = analyzer-&gt;get_current_metrics();</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Peak throughput: &quot;</span> &lt;&lt; metrics.peak_throughput_mbps &lt;&lt; <span class="stringliteral">&quot; Mbps&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Average throughput: &quot;</span> &lt;&lt; metrics.average_throughput_mbps &lt;&lt; <span class="stringliteral">&quot; Mbps&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> run_latency_test() {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Running latency test...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Configure low-rate, small messages for latency measurement</span></div>
<div class="line">        test_traffic_generator::traffic_config traffic_config;</div>
<div class="line">        traffic_config.pattern = test_traffic_generator::traffic_config::pattern::CONSTANT_RATE;</div>
<div class="line">        traffic_config.base_rate_hz = 1000.0;  <span class="comment">// 1k messages/sec</span></div>
<div class="line">        traffic_config.min_size = 64;   <span class="comment">// Small messages for latency</span></div>
<div class="line">        traffic_config.max_size = 64;</div>
<div class="line">        traffic_config.test_duration = sc_time(5, SC_SEC);</div>
<div class="line">        </div>
<div class="line">        testbench-&gt;traffic_gen-&gt;configure(traffic_config);</div>
<div class="line">        testbench-&gt;traffic_gen-&gt;start_generation();</div>
<div class="line">        </div>
<div class="line">        wait(traffic_config.test_duration + sc_time(1, SC_SEC));</div>
<div class="line">        </div>
<div class="line">        testbench-&gt;traffic_gen-&gt;stop_generation();</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Collect metrics</span></div>
<div class="line">        <span class="keyword">auto</span> metrics = analyzer-&gt;get_current_metrics();</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Average latency: &quot;</span> &lt;&lt; metrics.average_latency &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;P99 latency: &quot;</span> &lt;&lt; metrics.p99_latency &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> run_scalability_test() {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Running scalability test...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Test with increasing connection counts</span></div>
<div class="line">        <span class="comment">// This would require multiple client stacks in a real implementation</span></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Scalability test placeholder - would test multiple connections&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> run_power_efficiency_test() {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Running power efficiency test...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Test different power optimization settings</span></div>
<div class="line">        <span class="keyword">auto</span> metrics = analyzer-&gt;get_current_metrics();</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Average power consumption: &quot;</span> &lt;&lt; metrics.average_power_mw &lt;&lt; <span class="stringliteral">&quot; mW&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Energy per message: &quot;</span> &lt;&lt; </div>
<div class="line">                     (metrics.total_energy_mj * 1000.0) / </div>
<div class="line">                     testbench-&gt;traffic_gen-&gt;statistics.messages_generated &lt;&lt; <span class="stringliteral">&quot; J&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> generate_benchmark_report() {</div>
<div class="line">        <span class="comment">// Generate comprehensive performance report</span></div>
<div class="line">        analyzer-&gt;save_performance_report(<span class="stringliteral">&quot;performance_benchmark_report.html&quot;</span>);</div>
<div class="line">        analyzer-&gt;save_metrics_csv(<span class="stringliteral">&quot;performance_metrics.csv&quot;</span>);</div>
<div class="line">        analyzer-&gt;generate_plots(<span class="stringliteral">&quot;benchmark_plots/&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Bottleneck analysis</span></div>
<div class="line">        <span class="keyword">auto</span> bottleneck = analyzer-&gt;analyze_bottlenecks();</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Primary bottleneck: &quot;</span>;</div>
<div class="line">        <span class="keywordflow">switch</span> (bottleneck.primary_bottleneck) {</div>
<div class="line">            <span class="keywordflow">case</span> performance_analyzer::bottleneck_analysis::bottleneck_type::CPU_BOUND:</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;CPU&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> performance_analyzer::bottleneck_analysis::bottleneck_type::MEMORY_BOUND:</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Memory&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> performance_analyzer::bottleneck_analysis::bottleneck_type::NETWORK_BOUND:</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Network&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> performance_analyzer::bottleneck_analysis::bottleneck_type::CRYPTO_BOUND:</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Cryptography&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> performance_analyzer::bottleneck_analysis::bottleneck_type::PROTOCOL_BOUND:</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Protocol&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        std::cout &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Optimization suggestions:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; suggestion : bottleneck.optimization_suggestions) {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; suggestion &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> sc_main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    performance_benchmark bench(<span class="stringliteral">&quot;benchmark&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    sc_start();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md884"></a>
Building and Running SystemC Models</h1>
<h2><a class="anchor" id="autotoc_md885"></a>
CMake Integration</h2>
<div class="fragment"><div class="line"># Find SystemC</div>
<div class="line">find_package(SystemCLanguage CONFIG REQUIRED)</div>
<div class="line"> </div>
<div class="line"># DTLS SystemC library</div>
<div class="line">add_library(dtls_systemc</div>
<div class="line">    systemc/src/protocol_stack.cpp</div>
<div class="line">    systemc/src/tlm_extensions.cpp</div>
<div class="line">    systemc/src/timing_models.cpp</div>
<div class="line">    systemc/src/channels.cpp</div>
<div class="line">    # ... other SystemC sources</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">target_link_libraries(dtls_systemc </div>
<div class="line">    SystemC::systemc</div>
<div class="line">    dtlsv13  # Main C++ library</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">target_include_directories(dtls_systemc PUBLIC</div>
<div class="line">    systemc/include</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"># Test executables</div>
<div class="line">add_executable(systemc_test</div>
<div class="line">    systemc/tests/basic_test.cpp</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">target_link_libraries(systemc_test dtls_systemc)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md886"></a>
Compilation and Execution</h2>
<div class="fragment"><div class="line"># Build SystemC model</div>
<div class="line">cd systemc &amp;&amp; mkdir -p build &amp;&amp; cd build</div>
<div class="line">cmake .. -DSYSTEMC_ROOT=/path/to/systemc</div>
<div class="line">make -j$(nproc)</div>
<div class="line"> </div>
<div class="line"># Run basic test</div>
<div class="line">./systemc_test</div>
<div class="line"> </div>
<div class="line"># Run performance benchmark</div>
<div class="line">./performance_benchmark</div>
<div class="line"> </div>
<div class="line"># Generate waveforms (if VCD enabled)</div>
<div class="line">gtkwave simulation.vcd</div>
</div><!-- fragment --><p>This SystemC API provides comprehensive transaction-level modeling capabilities for DTLS v1.3, enabling detailed performance analysis, verification, and hardware/software co-design workflows. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>

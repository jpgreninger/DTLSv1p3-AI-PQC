<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DTLS v1.3 Implementation: DTLS v1.3 API Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DTLS v1.3 Implementation<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Production-ready DTLS v1.3 implementation with RFC 9147 compliance and quantum-resistant cryptography</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_2API__DOCUMENTATION.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">DTLS v1.3 API Documentation</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md122"></a> Complete reference for the DTLS v1.3 C++ library public API. This implementation follows RFC 9147 specifications and provides both high-level convenience APIs and low-level control interfaces.</p>
<h1><a class="anchor" id="autotoc_md123"></a>
Table of Contents</h1>
<ul>
<li>Quick Start</li>
<li>Core API</li>
<li>Connection Management</li>
<li>Cryptographic Interface</li>
<li>Protocol Layer</li>
<li>Memory Management</li>
<li>Error Handling</li>
<li>Configuration</li>
<li>Performance Monitoring</li>
<li>Security Features</li>
<li>Examples</li>
</ul>
<h1><a class="anchor" id="autotoc_md124"></a>
Quick Start</h1>
<h2><a class="anchor" id="autotoc_md125"></a>
Basic Client Connection</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="connection_8h.html">dtls/connection.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="provider__factory_8h.html">dtls/crypto/provider_factory.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13.html">dtls::v13</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Initialize crypto provider</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_manager</a> = crypto::ProviderFactory::instance()</div>
<div class="line">    .create_provider(<span class="stringliteral">&quot;openssl&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Configure connection</span></div>
<div class="line"><a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>;</div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>.handshake_timeout = std::chrono::seconds(10);</div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>.enable_early_data = <span class="keyword">true</span>;</div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>.supported_cipher_suites = {</div>
<div class="line">    CipherSuite::TLS_AES_256_GCM_SHA384,</div>
<div class="line">    CipherSuite::TLS_CHACHA20_POLY1305_SHA256</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create connection</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">connection_result</a> = Connection::create_client(</div>
<div class="line">    NetworkAddress::from_string(<span class="stringliteral">&quot;192.168.1.100:4433&quot;</span>),</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>,</div>
<div class="line">    std::move(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_manager</a>)</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">connection_result</a>) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to create connection: &quot;</span> </div>
<div class="line">              &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">connection_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> connection = std::move(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">connection_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#ab19678eb3fabf2a575b1a8e742f1a541">value</a>());</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Perform handshake</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_result</a> = connection-&gt;handshake();</div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_result</a>) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Handshake failed: &quot;</span> </div>
<div class="line">              &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Send application data</span></div>
<div class="line">std::vector&lt;uint8_t&gt; data = {<span class="charliteral">&#39;H&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;l&#39;</span>, <span class="charliteral">&#39;l&#39;</span>, <span class="charliteral">&#39;o&#39;</span>};</div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">send_result</a> = connection-&gt;send(data);</div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">send_result</a>) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Send failed: &quot;</span> </div>
<div class="line">              &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">send_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="ttc" id="aclassdtls_1_1v13_1_1Result_html"><div class="ttname"><a href="classdtls_1_1v13_1_1Result.html">dtls::v13::Result</a></div><div class="ttdoc">Forward declaration for Result template class.</div><div class="ttdef"><b>Definition</b> <a href="result_8h_source.html#l00027">result.h:27</a></div></div>
<div class="ttc" id="aclassdtls_1_1v13_1_1Result_html_ab19678eb3fabf2a575b1a8e742f1a541"><div class="ttname"><a href="classdtls_1_1v13_1_1Result.html#ab19678eb3fabf2a575b1a8e742f1a541">dtls::v13::Result::value</a></div><div class="ttdeci">const T &amp; value() const &amp;</div><div class="ttdef"><b>Definition</b> <a href="result_8h_source.html#l00068">result.h:68</a></div></div>
<div class="ttc" id="aclassdtls_1_1v13_1_1Result_html_acae6b3edbb83a4098261519bc9f8e2a3"><div class="ttname"><a href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">dtls::v13::Result::error</a></div><div class="ttdeci">DTLSError error() const</div><div class="ttdef"><b>Definition</b> <a href="result_8h_source.html#l00107">result.h:107</a></div></div>
<div class="ttc" id="aconnection_8h_html"><div class="ttname"><a href="connection_8h.html">connection.h</a></div><div class="ttdoc">DTLS v1.3 Connection Management API.</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html"><div class="ttname"><a href="namespacedtls_1_1v13.html">dtls::v13</a></div><div class="ttdoc">Main namespace for DTLS v1.3 implementation.</div><div class="ttdef"><b>Definition</b> <a href="alert__manager_8h_source.html#l00017">alert_manager.h:17</a></div></div>
<div class="ttc" id="aprovider__factory_8h_html"><div class="ttname"><a href="provider__factory_8h.html">provider_factory.h</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1ConnectionConfig_html"><div class="ttname"><a href="structdtls_1_1v13_1_1ConnectionConfig.html">dtls::v13::ConnectionConfig</a></div><div class="ttdoc">Connection configuration parameters.</div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00158">connection.h:158</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md126"></a>
Basic Server Setup</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="connection_8h.html">dtls/connection.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="provider__factory_8h.html">dtls/crypto/provider_factory.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13.html">dtls::v13</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Server configuration</span></div>
<div class="line"><a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server_config</a>;</div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server_config</a>.enable_connection_id = <span class="keyword">true</span>;</div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server_config</a>.connection_id_length = 8;</div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server_config</a>.max_early_data_size = 16384;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create connection manager</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">manager_result</a> = ConnectionManager::create(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server_config</a>);</div>
<div class="line"><span class="keyword">auto</span>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">manager</a> = <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">manager_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#ab19678eb3fabf2a575b1a8e742f1a541">value</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set up event callbacks</span></div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">manager</a>.set_event_callback([](<a class="code hl_enumeration" href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1ea">ConnectionEvent</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">event</a>, <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>) {</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">event</a>) {</div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::HANDSHAKE_COMPLETED:</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Client connected successfully&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::DATA_RECEIVED:</div>
<div class="line">            <span class="comment">// Handle incoming data</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::CONNECTION_CLOSED:</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Client disconnected&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Start server</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_result</a> = <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">manager</a>.bind(NetworkAddress::from_string(<span class="stringliteral">&quot;0.0.0.0:4433&quot;</span>));</div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_result</a>) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to bind server&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Run server loop</span></div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">manager</a>.run();</div>
<div class="ttc" id="aclassdtls_1_1v13_1_1Connection_html"><div class="ttname"><a href="classdtls_1_1v13_1_1Connection.html">dtls::v13::Connection</a></div><div class="ttdoc">Main DTLS v1.3 Connection implementation.</div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00304">connection.h:304</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ae6e8032c12417cb62fd44f38dfe5a1ea"><div class="ttname"><a href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1ea">dtls::v13::ConnectionEvent</a></div><div class="ttdeci">ConnectionEvent</div><div class="ttdoc">Connection event types for callbacks.</div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00236">connection.h:236</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md127"></a>
Core API</h1>
<h2><a class="anchor" id="autotoc_md128"></a>
Types and Constants</h2>
<p>The core types are defined in <code><a class="el" href="types_8h.html" title="Core DTLS v1.3 Protocol Types and Constants.">include/dtls/types.h</a></code>:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13.html">dtls::v13</a> {</div>
<div class="line">    <span class="comment">// Protocol version constants</span></div>
<div class="line">    <span class="keyword">constexpr</span> <a class="code hl_typedef" href="group__CoreTypes.html#gabc4372b1165cf4e20b612d50ff20e1bb">ProtocolVersion</a> <a class="code hl_variable" href="group__VersionConstants.html#gaa155c2c1b01c7c98909d43aaa2c84247">DTLS_V13</a>{254, 252};</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection identifiers and session data</span></div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="namespacedtls_1_1v13.html#afae06ac9662074deb5027d3dbab33c27">ConnectionID</a> = std::vector&lt;uint8_t&gt;;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="namespacedtls_1_1v13.html#a13dd97420d84c58f54896562112fd1a3">SessionID</a> = std::vector&lt;uint8_t&gt;;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="namespacedtls_1_1v13.html#a47d65e492f61d2e0eb509b59c5a48e58">Random</a> = std::array&lt;uint8_t, 32&gt;;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a> = std::vector&lt;uint8_t&gt;;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Network addressing</span></div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a> {</div>
<div class="line">        <span class="keyword">enum class</span> <a class="code hl_enumeration" href="structdtls_1_1v13_1_1NetworkAddress.html#a2b2e95fba7d775daaba7aa54a9e5168c">Family</a> { <a class="code hl_enumvalue" href="structdtls_1_1v13_1_1NetworkAddress.html#a2b2e95fba7d775daaba7aa54a9e5168ca42a9137a05a60eb752dcdf982e717626">IPv4</a>, <a class="code hl_enumvalue" href="structdtls_1_1v13_1_1NetworkAddress.html#a2b2e95fba7d775daaba7aa54a9e5168cafdb7cb8f657426e7c409bfd6d1a36ce4">IPv6</a> } <a class="code hl_variable" href="structdtls_1_1v13_1_1NetworkAddress.html#a53f8440a44290279a6247af77914e326">family</a>;</div>
<div class="line">        std::array&lt;uint8_t, 16&gt; <a class="code hl_variable" href="structdtls_1_1v13_1_1NetworkAddress.html#a1af548b6951d10e64dc22a6a456e80fe">address</a>;</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint16_t</a> <a class="code hl_variable" href="structdtls_1_1v13_1_1NetworkAddress.html#a3dce93c02a760d3f078031c23db87caa">port</a>;</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">static</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a> <a class="code hl_function" href="structdtls_1_1v13_1_1NetworkAddress.html#a4c614a5358170b88483e865fd624dbba">from_ipv4</a>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ip</a>, <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint16_t</a> <a class="code hl_variable" href="structdtls_1_1v13_1_1NetworkAddress.html#a3dce93c02a760d3f078031c23db87caa">port</a>);</div>
<div class="line">        <span class="keyword">static</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a> <a class="code hl_function" href="structdtls_1_1v13_1_1NetworkAddress.html#ac53dede32076f7e105e1cec48df8a373">from_ipv6</a>(<span class="keyword">const</span> std::array&lt;uint8_t, 16&gt;&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ip</a>, <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint16_t</a> <a class="code hl_variable" href="structdtls_1_1v13_1_1NetworkAddress.html#a3dce93c02a760d3f078031c23db87caa">port</a>);</div>
<div class="line">        <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;NetworkAddress&gt;</a> <a class="code hl_function" href="structdtls_1_1v13_1_1NetworkAddress.html#ad649fdeea52f15dbc76b4a9b21c34fac">from_string</a>(<span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">addr</a>);</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">bool</span> <a class="code hl_function" href="structdtls_1_1v13_1_1NetworkAddress.html#adb21dea69dfe851173ff2977c7c07217">is_ipv4</a>() <span class="keyword">const</span>;</div>
<div class="line">        <span class="keywordtype">bool</span> <a class="code hl_function" href="structdtls_1_1v13_1_1NetworkAddress.html#a6818769a1c80e4d719b47e9e0838f07c">is_ipv6</a>() <span class="keyword">const</span>;</div>
<div class="line">        std::string <a class="code hl_function" href="namespacedtls_1_1v13.html#aaac42ceaa9423141c293c1fa726010d0">to_string</a>() <span class="keyword">const</span>;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Protocol enums</span></div>
<div class="line">    <span class="keyword">enum class</span> <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeb">ContentType</a> : <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint8_t</a> {</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdebaccc0377a8afbf50e7094f5c23a8af223">INVALID</a> = 0,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba5072f00cf2e09874dbaaced8bcf35252">CHANGE_CIPHER_SPEC</a> = 20,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba320f86f60f25459ba5550e000b2c3929">ALERT</a> = 21,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba84fcef12cce95eb15cffe4338ecf5d29">HANDSHAKE</a> = 22,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba704d52e4b4b32ea4145af26445eef741">APPLICATION_DATA</a> = 23,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba0d895a0a05a7cce9b2c0c8bb252f78cc">HEARTBEAT</a> = 24,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdebabb35aa992e751610da90ad678880a42d">TLS12_CID</a> = 25,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba0fc437bc317835cad5faafc12a83fad5">ACK</a> = 26</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">enum class</span> <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6">HandshakeType</a> : <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint8_t</a> {</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a68f215961d3807b1f3e363ab9dc3b9fd">CLIENT_HELLO</a> = 1,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a2d5adf374790a99688888f051f235cf0">SERVER_HELLO</a> = 2,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6af3863563483b64670cecf9ba1cfbbfdf">NEW_SESSION_TICKET</a> = 4,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a5034b792d7e19175b7990116d3dcaac4">END_OF_EARLY_DATA</a> = 5,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a266c966a23020795dd739f02358b011a">HELLO_RETRY_REQUEST</a> = 6,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a660649ff163f64a8481d80ab2a4eb08d">ENCRYPTED_EXTENSIONS</a> = 8,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6aad1694fa18786504d416601fa3e96d01">CERTIFICATE</a> = 11,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6ad3d3b002c0022969e52f9b0e87b8823e">CERTIFICATE_REQUEST</a> = 13,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a801ddf185cd220c74b534265c82ed937">CERTIFICATE_VERIFY</a> = 15,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a2c616b2713e2e0aed04b4c4752c88133">FINISHED</a> = 20,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6aedcd1838730b9cf56c1a686d482cb52d">KEY_UPDATE</a> = 24,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba0fc437bc317835cad5faafc12a83fad5">ACK</a> = 26,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a63cd4892307fe3cb50a670304109155d">MESSAGE_HASH</a> = 254</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">enum class</span> <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3">CipherSuite</a> : <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint16_t</a> {</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3a8a3c1b321499beacc45a33fd42758929">TLS_AES_128_GCM_SHA256</a> = 0x1301,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3a3399189c01a6f55e6ddbbeb65514d504">TLS_AES_256_GCM_SHA384</a> = 0x1302,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3a7f56ad966fda13e8563f6faf577e85d7">TLS_CHACHA20_POLY1305_SHA256</a> = 0x1303,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3a3765038fe68b9b41a5909fe0e942ff83">TLS_AES_128_CCM_SHA256</a> = 0x1304,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3a4ab9d1f5c5fff3da463fbf1857c67b9b">TLS_AES_128_CCM_8_SHA256</a> = 0x1305</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">enum class</span> <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ad">ConnectionState</a> {</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada91d26e4b2b105c74655093c9becd30b7">INITIAL</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada1f9fa6b0c8984c44b5b72a001978393c">WAIT_SERVER_HELLO</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada154266a5002aa597a2755dbd4c26243e">WAIT_ENCRYPTED_EXTENSIONS</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada21fd784f623c769344c512474e44ed00">WAIT_CERTIFICATE_OR_CERT_REQUEST</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada4b48d587a0736de5511e49cbb303ae62">WAIT_CERTIFICATE_VERIFY</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0adabac9461b4f516422c33e7b2698d3a1a6">WAIT_SERVER_FINISHED</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada686b12b19e743ad1521252ac520ba0b5">WAIT_CLIENT_CERTIFICATE</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada2cbd8dee445b6d6cea89e2c9ba8bfe67">WAIT_CLIENT_CERTIFICATE_VERIFY</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0adab0d63453cd6b2958a3cbe1db03a29d85">WAIT_CLIENT_FINISHED</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0adaa5afd6edd5336d91316964e493936858">CONNECTED</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada110ccf2f5d2ff4eda1fd1a494293467d">CLOSED</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a839280e4cc780587c70004ece2d2f569aecf87f303825708058755698247dccee">EARLY_DATA</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0adaaf2483d6476307454e14573f8b72b06a">WAIT_END_OF_EARLY_DATA</a>,</div>
<div class="line">        <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1eaa0b11f9649b7300d89d9497c0ba2175b8">EARLY_DATA_REJECTED</a></div>
<div class="line">    };</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CoreTypes_html_gabc4372b1165cf4e20b612d50ff20e1bb"><div class="ttname"><a href="group__CoreTypes.html#gabc4372b1165cf4e20b612d50ff20e1bb">dtls::v13::ProtocolVersion</a></div><div class="ttdeci">uint16_t ProtocolVersion</div><div class="ttdoc">Protocol version identifier (network byte order).</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00041">types.h:41</a></div></div>
<div class="ttc" id="agroup__VersionConstants_html_gaa155c2c1b01c7c98909d43aaa2c84247"><div class="ttname"><a href="group__VersionConstants.html#gaa155c2c1b01c7c98909d43aaa2c84247">dtls::v13::DTLS_V13</a></div><div class="ttdeci">constexpr ProtocolVersion DTLS_V13</div><div class="ttdoc">DTLS v1.3 version identifier (primary target)</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00067">types.h:67</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a13dd97420d84c58f54896562112fd1a3"><div class="ttname"><a href="namespacedtls_1_1v13.html#a13dd97420d84c58f54896562112fd1a3">dtls::v13::SessionID</a></div><div class="ttdeci">std::vector&lt; uint8_t &gt; SessionID</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00300">types.h:300</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a2c8cefcd0588652f47924c24935f52e3"><div class="ttname"><a href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3">dtls::v13::CipherSuite</a></div><div class="ttdeci">CipherSuite</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00153">types.h:153</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a2c8cefcd0588652f47924c24935f52e3a3399189c01a6f55e6ddbbeb65514d504"><div class="ttname"><a href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3a3399189c01a6f55e6ddbbeb65514d504">dtls::v13::CipherSuite::TLS_AES_256_GCM_SHA384</a></div><div class="ttdeci">@ TLS_AES_256_GCM_SHA384</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a2c8cefcd0588652f47924c24935f52e3a3765038fe68b9b41a5909fe0e942ff83"><div class="ttname"><a href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3a3765038fe68b9b41a5909fe0e942ff83">dtls::v13::CipherSuite::TLS_AES_128_CCM_SHA256</a></div><div class="ttdeci">@ TLS_AES_128_CCM_SHA256</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a2c8cefcd0588652f47924c24935f52e3a4ab9d1f5c5fff3da463fbf1857c67b9b"><div class="ttname"><a href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3a4ab9d1f5c5fff3da463fbf1857c67b9b">dtls::v13::CipherSuite::TLS_AES_128_CCM_8_SHA256</a></div><div class="ttdeci">@ TLS_AES_128_CCM_8_SHA256</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a2c8cefcd0588652f47924c24935f52e3a7f56ad966fda13e8563f6faf577e85d7"><div class="ttname"><a href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3a7f56ad966fda13e8563f6faf577e85d7">dtls::v13::CipherSuite::TLS_CHACHA20_POLY1305_SHA256</a></div><div class="ttdeci">@ TLS_CHACHA20_POLY1305_SHA256</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a2c8cefcd0588652f47924c24935f52e3a8a3c1b321499beacc45a33fd42758929"><div class="ttname"><a href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3a8a3c1b321499beacc45a33fd42758929">dtls::v13::CipherSuite::TLS_AES_128_GCM_SHA256</a></div><div class="ttdeci">@ TLS_AES_128_GCM_SHA256</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a47d65e492f61d2e0eb509b59c5a48e58"><div class="ttname"><a href="namespacedtls_1_1v13.html#a47d65e492f61d2e0eb509b59c5a48e58">dtls::v13::Random</a></div><div class="ttdeci">std::array&lt; uint8_t, 32 &gt; Random</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00297">types.h:297</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0ad"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ad">dtls::v13::ConnectionState</a></div><div class="ttdeci">ConnectionState</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00266">types.h:266</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0ada110ccf2f5d2ff4eda1fd1a494293467d"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada110ccf2f5d2ff4eda1fd1a494293467d">dtls::v13::ConnectionState::CLOSED</a></div><div class="ttdeci">@ CLOSED</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0ada154266a5002aa597a2755dbd4c26243e"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada154266a5002aa597a2755dbd4c26243e">dtls::v13::ConnectionState::WAIT_ENCRYPTED_EXTENSIONS</a></div><div class="ttdeci">@ WAIT_ENCRYPTED_EXTENSIONS</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0ada1f9fa6b0c8984c44b5b72a001978393c"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada1f9fa6b0c8984c44b5b72a001978393c">dtls::v13::ConnectionState::WAIT_SERVER_HELLO</a></div><div class="ttdeci">@ WAIT_SERVER_HELLO</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0ada21fd784f623c769344c512474e44ed00"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada21fd784f623c769344c512474e44ed00">dtls::v13::ConnectionState::WAIT_CERTIFICATE_OR_CERT_REQUEST</a></div><div class="ttdeci">@ WAIT_CERTIFICATE_OR_CERT_REQUEST</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0ada2cbd8dee445b6d6cea89e2c9ba8bfe67"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada2cbd8dee445b6d6cea89e2c9ba8bfe67">dtls::v13::ConnectionState::WAIT_CLIENT_CERTIFICATE_VERIFY</a></div><div class="ttdeci">@ WAIT_CLIENT_CERTIFICATE_VERIFY</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0ada4b48d587a0736de5511e49cbb303ae62"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada4b48d587a0736de5511e49cbb303ae62">dtls::v13::ConnectionState::WAIT_CERTIFICATE_VERIFY</a></div><div class="ttdeci">@ WAIT_CERTIFICATE_VERIFY</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0ada686b12b19e743ad1521252ac520ba0b5"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada686b12b19e743ad1521252ac520ba0b5">dtls::v13::ConnectionState::WAIT_CLIENT_CERTIFICATE</a></div><div class="ttdeci">@ WAIT_CLIENT_CERTIFICATE</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0ada91d26e4b2b105c74655093c9becd30b7"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ada91d26e4b2b105c74655093c9becd30b7">dtls::v13::ConnectionState::INITIAL</a></div><div class="ttdeci">@ INITIAL</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0adaa5afd6edd5336d91316964e493936858"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0adaa5afd6edd5336d91316964e493936858">dtls::v13::ConnectionState::CONNECTED</a></div><div class="ttdeci">@ CONNECTED</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0adaaf2483d6476307454e14573f8b72b06a"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0adaaf2483d6476307454e14573f8b72b06a">dtls::v13::ConnectionState::WAIT_END_OF_EARLY_DATA</a></div><div class="ttdeci">@ WAIT_END_OF_EARLY_DATA</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0adab0d63453cd6b2958a3cbe1db03a29d85"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0adab0d63453cd6b2958a3cbe1db03a29d85">dtls::v13::ConnectionState::WAIT_CLIENT_FINISHED</a></div><div class="ttdeci">@ WAIT_CLIENT_FINISHED</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a68896fa2f4ab2bfbb152b31cf949f0adabac9461b4f516422c33e7b2698d3a1a6"><div class="ttname"><a href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0adabac9461b4f516422c33e7b2698d3a1a6">dtls::v13::ConnectionState::WAIT_SERVER_FINISHED</a></div><div class="ttdeci">@ WAIT_SERVER_FINISHED</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a839280e4cc780587c70004ece2d2f569aecf87f303825708058755698247dccee"><div class="ttname"><a href="namespacedtls_1_1v13.html#a839280e4cc780587c70004ece2d2f569aecf87f303825708058755698247dccee">dtls::v13::ExtensionType::EARLY_DATA</a></div><div class="ttdeci">@ EARLY_DATA</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aaac42ceaa9423141c293c1fa726010d0"><div class="ttname"><a href="namespacedtls_1_1v13.html#aaac42ceaa9423141c293c1fa726010d0">dtls::v13::to_string</a></div><div class="ttdeci">DTLS_API std::string to_string(ContentType type)</div><div class="ttdef"><b>Definition</b> <a href="types_8cpp_source.html#l00011">types.cpp:11</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ab9c84107809224041465427557aafdeb"><div class="ttname"><a href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeb">dtls::v13::ContentType</a></div><div class="ttdeci">ContentType</div><div class="ttdoc">DTLS record content types per @rfc{9147} Section 5.</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00077">types.h:77</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ab9c84107809224041465427557aafdeba0d895a0a05a7cce9b2c0c8bb252f78cc"><div class="ttname"><a href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba0d895a0a05a7cce9b2c0c8bb252f78cc">dtls::v13::ContentType::HEARTBEAT</a></div><div class="ttdeci">@ HEARTBEAT</div><div class="ttdoc">Heartbeat extension messages.</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ab9c84107809224041465427557aafdeba0fc437bc317835cad5faafc12a83fad5"><div class="ttname"><a href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba0fc437bc317835cad5faafc12a83fad5">dtls::v13::ContentType::ACK</a></div><div class="ttdeci">@ ACK</div><div class="ttdoc">Acknowledgment messages (DTLS 1.3 feature)</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ab9c84107809224041465427557aafdeba320f86f60f25459ba5550e000b2c3929"><div class="ttname"><a href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba320f86f60f25459ba5550e000b2c3929">dtls::v13::ContentType::ALERT</a></div><div class="ttdeci">@ ALERT</div><div class="ttdoc">Alert messages for error reporting.</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ab9c84107809224041465427557aafdeba5072f00cf2e09874dbaaced8bcf35252"><div class="ttname"><a href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba5072f00cf2e09874dbaaced8bcf35252">dtls::v13::ContentType::CHANGE_CIPHER_SPEC</a></div><div class="ttdeci">@ CHANGE_CIPHER_SPEC</div><div class="ttdoc">Legacy cipher spec change (DTLS 1.2 compat)</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ab9c84107809224041465427557aafdeba704d52e4b4b32ea4145af26445eef741"><div class="ttname"><a href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba704d52e4b4b32ea4145af26445eef741">dtls::v13::ContentType::APPLICATION_DATA</a></div><div class="ttdeci">@ APPLICATION_DATA</div><div class="ttdoc">Encrypted application payload data.</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ab9c84107809224041465427557aafdeba84fcef12cce95eb15cffe4338ecf5d29"><div class="ttname"><a href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeba84fcef12cce95eb15cffe4338ecf5d29">dtls::v13::ContentType::HANDSHAKE</a></div><div class="ttdeci">@ HANDSHAKE</div><div class="ttdoc">Handshake protocol messages.</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ab9c84107809224041465427557aafdebabb35aa992e751610da90ad678880a42d"><div class="ttname"><a href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdebabb35aa992e751610da90ad678880a42d">dtls::v13::ContentType::TLS12_CID</a></div><div class="ttdeci">@ TLS12_CID</div><div class="ttdoc">Connection ID for DTLS 1.2 compatibility.</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ab9c84107809224041465427557aafdebaccc0377a8afbf50e7094f5c23a8af223"><div class="ttname"><a href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdebaccc0377a8afbf50e7094f5c23a8af223">dtls::v13::ContentType::INVALID</a></div><div class="ttdeci">@ INVALID</div><div class="ttdoc">Invalid content type (error indicator)</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ad85d4a54164cded6e84c6f301708d48d"><div class="ttname"><a href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">dtls::v13::KeyMaterial</a></div><div class="ttdeci">std::vector&lt; uint8_t &gt; KeyMaterial</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00306">types.h:306</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ae6e8032c12417cb62fd44f38dfe5a1eaa0b11f9649b7300d89d9497c0ba2175b8"><div class="ttname"><a href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1eaa0b11f9649b7300d89d9497c0ba2175b8">dtls::v13::ConnectionEvent::EARLY_DATA_REJECTED</a></div><div class="ttdeci">@ EARLY_DATA_REJECTED</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6">dtls::v13::HandshakeType</a></div><div class="ttdeci">HandshakeType</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00089">types.h:89</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6a266c966a23020795dd739f02358b011a"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a266c966a23020795dd739f02358b011a">dtls::v13::HandshakeType::HELLO_RETRY_REQUEST</a></div><div class="ttdeci">@ HELLO_RETRY_REQUEST</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6a2c616b2713e2e0aed04b4c4752c88133"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a2c616b2713e2e0aed04b4c4752c88133">dtls::v13::HandshakeType::FINISHED</a></div><div class="ttdeci">@ FINISHED</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6a2d5adf374790a99688888f051f235cf0"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a2d5adf374790a99688888f051f235cf0">dtls::v13::HandshakeType::SERVER_HELLO</a></div><div class="ttdeci">@ SERVER_HELLO</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6a5034b792d7e19175b7990116d3dcaac4"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a5034b792d7e19175b7990116d3dcaac4">dtls::v13::HandshakeType::END_OF_EARLY_DATA</a></div><div class="ttdeci">@ END_OF_EARLY_DATA</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6a63cd4892307fe3cb50a670304109155d"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a63cd4892307fe3cb50a670304109155d">dtls::v13::HandshakeType::MESSAGE_HASH</a></div><div class="ttdeci">@ MESSAGE_HASH</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6a660649ff163f64a8481d80ab2a4eb08d"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a660649ff163f64a8481d80ab2a4eb08d">dtls::v13::HandshakeType::ENCRYPTED_EXTENSIONS</a></div><div class="ttdeci">@ ENCRYPTED_EXTENSIONS</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6a68f215961d3807b1f3e363ab9dc3b9fd"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a68f215961d3807b1f3e363ab9dc3b9fd">dtls::v13::HandshakeType::CLIENT_HELLO</a></div><div class="ttdeci">@ CLIENT_HELLO</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6a801ddf185cd220c74b534265c82ed937"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a801ddf185cd220c74b534265c82ed937">dtls::v13::HandshakeType::CERTIFICATE_VERIFY</a></div><div class="ttdeci">@ CERTIFICATE_VERIFY</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6aad1694fa18786504d416601fa3e96d01"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6aad1694fa18786504d416601fa3e96d01">dtls::v13::HandshakeType::CERTIFICATE</a></div><div class="ttdeci">@ CERTIFICATE</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6ad3d3b002c0022969e52f9b0e87b8823e"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6ad3d3b002c0022969e52f9b0e87b8823e">dtls::v13::HandshakeType::CERTIFICATE_REQUEST</a></div><div class="ttdeci">@ CERTIFICATE_REQUEST</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6aedcd1838730b9cf56c1a686d482cb52d"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6aedcd1838730b9cf56c1a686d482cb52d">dtls::v13::HandshakeType::KEY_UPDATE</a></div><div class="ttdeci">@ KEY_UPDATE</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeab29ce11310dc76ad87e254511f69d6af3863563483b64670cecf9ba1cfbbfdf"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6af3863563483b64670cecf9ba1cfbbfdf">dtls::v13::HandshakeType::NEW_SESSION_TICKET</a></div><div class="ttdeci">@ NEW_SESSION_TICKET</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_afae06ac9662074deb5027d3dbab33c27"><div class="ttname"><a href="namespacedtls_1_1v13.html#afae06ac9662074deb5027d3dbab33c27">dtls::v13::ConnectionID</a></div><div class="ttdeci">std::vector&lt; uint8_t &gt; ConnectionID</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00294">types.h:294</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html">dtls::v13::NetworkAddress</a></div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00316">types.h:316</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html_a1af548b6951d10e64dc22a6a456e80fe"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html#a1af548b6951d10e64dc22a6a456e80fe">dtls::v13::NetworkAddress::address</a></div><div class="ttdeci">std::array&lt; uint8_t, 16 &gt; address</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00323">types.h:323</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html_a2b2e95fba7d775daaba7aa54a9e5168c"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html#a2b2e95fba7d775daaba7aa54a9e5168c">dtls::v13::NetworkAddress::Family</a></div><div class="ttdeci">Family</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00317">types.h:317</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html_a2b2e95fba7d775daaba7aa54a9e5168ca42a9137a05a60eb752dcdf982e717626"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html#a2b2e95fba7d775daaba7aa54a9e5168ca42a9137a05a60eb752dcdf982e717626">dtls::v13::NetworkAddress::Family::IPv4</a></div><div class="ttdeci">@ IPv4</div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html_a2b2e95fba7d775daaba7aa54a9e5168cafdb7cb8f657426e7c409bfd6d1a36ce4"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html#a2b2e95fba7d775daaba7aa54a9e5168cafdb7cb8f657426e7c409bfd6d1a36ce4">dtls::v13::NetworkAddress::Family::IPv6</a></div><div class="ttdeci">@ IPv6</div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html_a3dce93c02a760d3f078031c23db87caa"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html#a3dce93c02a760d3f078031c23db87caa">dtls::v13::NetworkAddress::port</a></div><div class="ttdeci">uint16_t port</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00324">types.h:324</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html_a4c614a5358170b88483e865fd624dbba"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html#a4c614a5358170b88483e865fd624dbba">dtls::v13::NetworkAddress::from_ipv4</a></div><div class="ttdeci">static NetworkAddress from_ipv4(uint32_t ipv4_addr, uint16_t port_num)</div><div class="ttdef"><b>Definition</b> <a href="types_8cpp_source.html#l00277">types.cpp:277</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html_a53f8440a44290279a6247af77914e326"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html#a53f8440a44290279a6247af77914e326">dtls::v13::NetworkAddress::family</a></div><div class="ttdeci">Family family</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00322">types.h:322</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html_a6818769a1c80e4d719b47e9e0838f07c"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html#a6818769a1c80e4d719b47e9e0838f07c">dtls::v13::NetworkAddress::is_ipv6</a></div><div class="ttdeci">bool is_ipv6() const noexcept</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00327">types.h:327</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html_ac53dede32076f7e105e1cec48df8a373"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html#ac53dede32076f7e105e1cec48df8a373">dtls::v13::NetworkAddress::from_ipv6</a></div><div class="ttdeci">static NetworkAddress from_ipv6(const std::array&lt; uint8_t, 16 &gt; &amp;ipv6_addr, uint16_t port_num)</div><div class="ttdef"><b>Definition</b> <a href="types_8cpp_source.html#l00289">types.cpp:289</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html_ad649fdeea52f15dbc76b4a9b21c34fac"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html#ad649fdeea52f15dbc76b4a9b21c34fac">dtls::v13::NetworkAddress::from_string</a></div><div class="ttdeci">static Result&lt; NetworkAddress &gt; from_string(const std::string &amp;address_with_port)</div><div class="ttdef"><b>Definition</b> <a href="types_8cpp_source.html#l00354">types.cpp:354</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1NetworkAddress_html_adb21dea69dfe851173ff2977c7c07217"><div class="ttname"><a href="structdtls_1_1v13_1_1NetworkAddress.html#adb21dea69dfe851173ff2977c7c07217">dtls::v13::NetworkAddress::is_ipv4</a></div><div class="ttdeci">bool is_ipv4() const noexcept</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00326">types.h:326</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md129"></a>
Result Type System</h2>
<p>The library uses a Result&lt;T&gt; type for error handling instead of exceptions:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Check if result contains a value</span></div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">has_value</a>() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keyword">explicit</span> <span class="keyword">operator</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bool</a>() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Access value (only if has_value() == true)</span></div>
<div class="line">    T&amp; value();</div>
<div class="line">    <span class="keyword">const</span> T&amp; value() <span class="keyword">const</span>;</div>
<div class="line">    T&amp; operator*();</div>
<div class="line">    <span class="keyword">const</span> T&amp; operator*() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Access error (only if has_value() == false)</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a>&amp; error() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Convenience methods</span></div>
<div class="line">    T value_or(T&amp;&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">default_value</a>) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Factory methods</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;T&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">success</a>(T&amp;&amp; value);</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;T&gt;</a> failure(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a> error);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Usage examples</span></div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;Connection&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn_result</a> = Connection::create_client(...);</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn_result</a>) {</div>
<div class="line">    <span class="keyword">auto</span>&amp; connection = *<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn_result</a>;</div>
<div class="line">    <span class="comment">// Use connection</span></div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md130"></a>
Connection Management</h1>
<h2><a class="anchor" id="autotoc_md131"></a>
Connection Class</h2>
<p>The main interface for DTLS connections:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Factory methods</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;Connection&gt;</a>&gt; create_client(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server_address</a>,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>,</div>
<div class="line">        std::unique_ptr&lt;crypto::CryptoProvider&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_provider</a></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;Connection&gt;</a>&gt; create_server(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_address</a>,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>,</div>
<div class="line">        std::unique_ptr&lt;crypto::CryptoProvider&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_provider</a></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection lifecycle</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake</a>();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_async</a>(std::function&lt;<span class="keywordtype">void</span>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a>)&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">callback</a>);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> close();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> close(<a class="code hl_enumeration" href="namespacedtls_1_1v13.html#aa1e690285dfa4c975cd5eef269224a1b">AlertDescription</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">alert</a> = AlertDescription::CLOSE_NOTIFY);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Data transmission</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;size_t&gt;</a> send(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;size_t&gt;</a> send(<span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint8_t</a>* data, <span class="keywordtype">size_t</span> length);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; receive();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;size_t&gt;</a> receive(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint8_t</a>* buffer, <span class="keywordtype">size_t</span> buffer_size);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Early data (0-RTT) support</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;size_t&gt;</a> send_early_data(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> is_early_data_accepted() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Key management</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> update_keys();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">request_post_handshake_auth</a>();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// State information</span></div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ad">ConnectionState</a> get_state() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> is_connected() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> is_handshake_complete() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection properties</span></div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3">CipherSuite</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_negotiated_cipher_suite</a>() <span class="keyword">const</span>;</div>
<div class="line">    <a class="code hl_typedef" href="group__CoreTypes.html#gabc4372b1165cf4e20b612d50ff20e1bb">ProtocolVersion</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_negotiated_version</a>() <span class="keyword">const</span>;</div>
<div class="line">    std::optional&lt;ConnectionID&gt; get_connection_id() <span class="keyword">const</span>;</div>
<div class="line">    std::optional&lt;ConnectionID&gt; get_peer_connection_id() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics and monitoring</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionStats.html">ConnectionStats</a>&amp; get_statistics() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> reset_statistics();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Advanced features</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> set_connection_id(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#afae06ac9662074deb5027d3dbab33c27">ConnectionID</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">cid</a>);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> migrate_connection(<span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">new_address</a>);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">export_keying_material</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">label</a>,</div>
<div class="line">        <span class="keywordtype">size_t</span> length,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; context = {}</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Event handling</span></div>
<div class="line">    <span class="keywordtype">void</span> set_event_callback(<a class="code hl_typedef" href="namespacedtls_1_1v13.html#a0822f6ecebdf163c5b140d5e15f949c9">ConnectionEventCallback</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">callback</a>);</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a0822f6ecebdf163c5b140d5e15f949c9"><div class="ttname"><a href="namespacedtls_1_1v13.html#a0822f6ecebdf163c5b140d5e15f949c9">dtls::v13::ConnectionEventCallback</a></div><div class="ttdeci">std::function&lt; void(ConnectionEvent event, const std::vector&lt; uint8_t &gt; &amp;data)&gt; ConnectionEventCallback</div><div class="ttdoc">Connection event callback function type.</div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00261">connection.h:262</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aa1e690285dfa4c975cd5eef269224a1b"><div class="ttname"><a href="namespacedtls_1_1v13.html#aa1e690285dfa4c975cd5eef269224a1b">dtls::v13::AlertDescription</a></div><div class="ttdeci">AlertDescription</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00120">types.h:120</a></div></div>
<div class="ttc" id="astructdtls_1_1v13_1_1ConnectionStats_html"><div class="ttname"><a href="structdtls_1_1v13_1_1ConnectionStats.html">dtls::v13::ConnectionStats</a></div><div class="ttdoc">Connection statistics and metrics.</div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00198">connection.h:198</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md132"></a>
Connection Configuration</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a> {</div>
<div class="line">    <span class="comment">// Cryptographic preferences</span></div>
<div class="line">    std::vector&lt;CipherSuite&gt; supported_cipher_suites = {</div>
<div class="line">        CipherSuite::TLS_AES_256_GCM_SHA384,</div>
<div class="line">        CipherSuite::TLS_AES_128_GCM_SHA256,</div>
<div class="line">        CipherSuite::TLS_CHACHA20_POLY1305_SHA256</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    std::vector&lt;NamedGroup&gt; supported_groups = {</div>
<div class="line">        NamedGroup::X25519,</div>
<div class="line">        NamedGroup::SECP256R1,</div>
<div class="line">        NamedGroup::SECP384R1</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    std::vector&lt;SignatureScheme&gt; supported_signatures = {</div>
<div class="line">        SignatureScheme::RSA_PSS_RSAE_SHA256,</div>
<div class="line">        SignatureScheme::ECDSA_SECP256R1_SHA256,</div>
<div class="line">        SignatureScheme::ED25519</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Timing configuration</span></div>
<div class="line">    std::chrono::milliseconds handshake_timeout{10000};</div>
<div class="line">    std::chrono::milliseconds retransmission_timeout{1000};</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> max_retransmissions = 5;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection ID support</span></div>
<div class="line">    <span class="keywordtype">bool</span> enable_connection_id = <span class="keyword">true</span>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint8_t</a> connection_id_length = 8;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Early data (0-RTT) configuration</span></div>
<div class="line">    <span class="keywordtype">bool</span> enable_early_data = <span class="keyword">true</span>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> max_early_data_size = 16384;</div>
<div class="line">    std::chrono::milliseconds early_data_timeout{5000};</div>
<div class="line">    <span class="keywordtype">bool</span> allow_early_data_replay_protection = <span class="keyword">true</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Session management</span></div>
<div class="line">    <span class="keywordtype">bool</span> enable_session_resumption = <span class="keyword">true</span>;</div>
<div class="line">    std::chrono::seconds session_lifetime{7200};</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Buffer sizes</span></div>
<div class="line">    <span class="keywordtype">size_t</span> receive_buffer_size = 65536;</div>
<div class="line">    <span class="keywordtype">size_t</span> send_buffer_size = 65536;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Error recovery configuration</span></div>
<div class="line">    <a class="code hl_struct" href="structdtls_1_1v13_1_1ErrorRecoveryConfig.html">ErrorRecoveryConfig</a> error_recovery;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Factory method with defaults</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">default_client_config</a>();</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">default_server_config</a>();</div>
<div class="line">};</div>
<div class="ttc" id="astructdtls_1_1v13_1_1ErrorRecoveryConfig_html"><div class="ttname"><a href="structdtls_1_1v13_1_1ErrorRecoveryConfig.html">dtls::v13::ErrorRecoveryConfig</a></div><div class="ttdoc">Error recovery configuration.</div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00098">connection.h:98</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md133"></a>
Connection Events</h2>
<div class="fragment"><div class="line"><span class="keyword">enum class</span> <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1ea">ConnectionEvent</a> {</div>
<div class="line">    HANDSHAKE_STARTED,</div>
<div class="line">    HANDSHAKE_COMPLETED,</div>
<div class="line">    HANDSHAKE_FAILED,</div>
<div class="line">    DATA_RECEIVED,</div>
<div class="line">    CONNECTION_CLOSED,</div>
<div class="line">    ERROR_OCCURRED,</div>
<div class="line">    ALERT_RECEIVED,</div>
<div class="line">    KEY_UPDATE_COMPLETED,</div>
<div class="line">    EARLY_DATA_ACCEPTED,</div>
<div class="line">    EARLY_DATA_REJECTED,</div>
<div class="line">    EARLY_DATA_RECEIVED,</div>
<div class="line">    NEW_SESSION_TICKET_RECEIVED,</div>
<div class="line">    RECOVERY_STARTED,</div>
<div class="line">    RECOVERY_SUCCEEDED,</div>
<div class="line">    RECOVERY_FAILED,</div>
<div class="line">    CONNECTION_DEGRADED,</div>
<div class="line">    CONNECTION_RESTORED</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="namespacedtls_1_1v13.html#a0822f6ecebdf163c5b140d5e15f949c9">ConnectionEventCallback</a> = std::function&lt;<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">void</a>(<a class="code hl_enumeration" href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1ea">ConnectionEvent</a>, <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp;)&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Example usage</span></div>
<div class="line">connection-&gt;set_event_callback([](<a class="code hl_enumeration" href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1ea">ConnectionEvent</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">event</a>, <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>) {</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">event</a>) {</div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::HANDSHAKE_COMPLETED:</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Handshake completed with cipher suite: &quot;</span> </div>
<div class="line">                      &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>.get_negotiated_cipher_suite()) &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::DATA_RECEIVED:</div>
<div class="line">            <span class="comment">// Handle incoming application data</span></div>
<div class="line">            <span class="keyword">auto</span> data = <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>.receive();</div>
<div class="line">            <span class="keywordflow">if</span> (data) {</div>
<div class="line">                <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">process_application_data</a>(*data);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">case</span> ConnectionEvent::ERROR_OCCURRED:</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Connection error occurred&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">});</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md134"></a>
Connection Manager</h2>
<p>For server applications managing multiple connections:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="classdtls_1_1v13_1_1ConnectionManager.html">ConnectionManager</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;ConnectionManager&gt;</a>&gt; create(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Server lifecycle</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> bind(<span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; address);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">listen</a>(<span class="keywordtype">int</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">backlog</a> = 128);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">run</a>();</div>
<div class="line">    <span class="keywordtype">void</span> stop();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection management</span></div>
<div class="line">    std::vector&lt;std::shared_ptr&lt;Connection&gt;&gt; get_active_connections();</div>
<div class="line">    <span class="keywordtype">size_t</span> get_connection_count() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Event handling</span></div>
<div class="line">    <span class="keywordtype">void</span> set_event_callback(<a class="code hl_typedef" href="namespacedtls_1_1v13.html#a0822f6ecebdf163c5b140d5e15f949c9">ConnectionEventCallback</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">callback</a>);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">set_new_connection_callback</a>(</div>
<div class="line">        std::function&lt;<span class="keywordtype">void</span>(std::shared_ptr&lt;Connection&gt;)&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">callback</a></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration</span></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">set_max_connections</a>(<span class="keywordtype">size_t</span> max_connections);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">set_connection_timeout</a>(std::chrono::seconds timeout);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ServerStats</a> {</div>
<div class="line">        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">total_connections_accepted</a>;</div>
<div class="line">        <span class="keywordtype">size_t</span> active_connections;</div>
<div class="line">        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">failed_handshakes</a>;</div>
<div class="line">        <span class="keywordtype">size_t</span> bytes_sent;</div>
<div class="line">        <span class="keywordtype">size_t</span> bytes_received;</div>
<div class="line">        std::chrono::steady_clock::time_point start_time;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ServerStats</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_server_statistics</a>() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1ConnectionManager.html">ConnectionManager</a>() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="ttc" id="aclassdtls_1_1v13_1_1ConnectionManager_html"><div class="ttname"><a href="classdtls_1_1v13_1_1ConnectionManager.html">dtls::v13::ConnectionManager</a></div><div class="ttdoc">Connection Manager for handling multiple connections.</div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00696">connection.h:696</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md135"></a>
Cryptographic Interface</h1>
<h2><a class="anchor" id="autotoc_md136"></a>
Provider Factory</h2>
<p>The cryptographic operations are abstracted through a provider system:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13_1_1crypto.html">dtls::v13::crypto</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ProviderFactory {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> ProviderFactory&amp; <a class="code hl_function" href="classdtls_1_1v13_1_1crypto_1_1ProviderFactory.html#ad2b541c4657f0d00dfedd7c0e8224a2a">instance</a>();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider registration</span></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="classdtls_1_1v13_1_1crypto_1_1ProviderFactory.html#ada63a757f4c1810f62d1169d16e8b7ac">register_provider</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; name,</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; description,</div>
<div class="line">        std::function&lt;std::unique_ptr&lt;CryptoProvider&gt;()&gt; factory,</div>
<div class="line">        <span class="keywordtype">int</span> priority = 0</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider creation</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;CryptoProvider&gt;</a>&gt; <a class="code hl_function" href="classdtls_1_1v13_1_1crypto_1_1ProviderFactory.html#aa6bfee72476dd27f1270cee0efac9d39">create_provider</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; name = <span class="stringliteral">&quot;default&quot;</span></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;CryptoProvider&gt;</a>&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">create_best_available_provider</a>();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider information</span></div>
<div class="line">    std::vector&lt;std::string&gt; get_available_providers() <span class="keyword">const</span>;</div>
<div class="line">    std::vector&lt;ProviderRegistration&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_provider_registrations</a>() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_function" href="classdtls_1_1v13_1_1crypto_1_1ProviderFactory.html#a1b3428b1c9dff6336697754641867d80">is_provider_available</a>(<span class="keyword">const</span> std::string&amp; name) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider management</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">load_plugin</a>(<span class="keyword">const</span> std::string&amp; plugin_path);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">unload_all_plugins</a>();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Health monitoring</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;ProviderCompatibilityResult&gt;</a> <a class="code hl_function" href="classdtls_1_1v13_1_1crypto_1_1ProviderFactory.html#a06ce0477e8dd64c1434861e38237b0d0">check_compatibility</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; provider_name,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;CipherSuite&gt;&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">required_suites</a></div>
<div class="line">    ) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    ProviderFactory() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Built-in provider availability check</span></div>
<div class="line"><span class="keyword">namespace </span>builtin {</div>
<div class="line">    <span class="keywordtype">bool</span> is_openssl_available();</div>
<div class="line">    <span class="keywordtype">bool</span> is_botan_available();</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">is_hardware_acceleration_available</a>();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="aclassdtls_1_1v13_1_1crypto_1_1ProviderFactory_html_a06ce0477e8dd64c1434861e38237b0d0"><div class="ttname"><a href="classdtls_1_1v13_1_1crypto_1_1ProviderFactory.html#a06ce0477e8dd64c1434861e38237b0d0">dtls::v13::crypto::ProviderFactory::check_compatibility</a></div><div class="ttdeci">Result&lt; ProviderCompatibilityResult &gt; check_compatibility(const std::string &amp;provider_name, const ProviderSelection &amp;criteria) const</div></div>
<div class="ttc" id="aclassdtls_1_1v13_1_1crypto_1_1ProviderFactory_html_a1b3428b1c9dff6336697754641867d80"><div class="ttname"><a href="classdtls_1_1v13_1_1crypto_1_1ProviderFactory.html#a1b3428b1c9dff6336697754641867d80">dtls::v13::crypto::ProviderFactory::is_provider_available</a></div><div class="ttdeci">bool is_provider_available(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="provider__factory_8cpp_source.html#l00379">provider_factory.cpp:379</a></div></div>
<div class="ttc" id="aclassdtls_1_1v13_1_1crypto_1_1ProviderFactory_html_aa6bfee72476dd27f1270cee0efac9d39"><div class="ttname"><a href="classdtls_1_1v13_1_1crypto_1_1ProviderFactory.html#aa6bfee72476dd27f1270cee0efac9d39">dtls::v13::crypto::ProviderFactory::create_provider</a></div><div class="ttdeci">Result&lt; std::unique_ptr&lt; CryptoProvider &gt; &gt; create_provider(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="provider__factory_8cpp_source.html#l00122">provider_factory.cpp:122</a></div></div>
<div class="ttc" id="aclassdtls_1_1v13_1_1crypto_1_1ProviderFactory_html_ad2b541c4657f0d00dfedd7c0e8224a2a"><div class="ttname"><a href="classdtls_1_1v13_1_1crypto_1_1ProviderFactory.html#ad2b541c4657f0d00dfedd7c0e8224a2a">dtls::v13::crypto::ProviderFactory::instance</a></div><div class="ttdeci">static ProviderFactory &amp; instance()</div><div class="ttdef"><b>Definition</b> <a href="provider__factory_8cpp_source.html#l00015">provider_factory.cpp:15</a></div></div>
<div class="ttc" id="aclassdtls_1_1v13_1_1crypto_1_1ProviderFactory_html_ada63a757f4c1810f62d1169d16e8b7ac"><div class="ttname"><a href="classdtls_1_1v13_1_1crypto_1_1ProviderFactory.html#ada63a757f4c1810f62d1169d16e8b7ac">dtls::v13::crypto::ProviderFactory::register_provider</a></div><div class="ttdeci">Result&lt; void &gt; register_provider(const std::string &amp;name, const std::string &amp;description, ProviderFactoryFunction factory, int priority=0)</div><div class="ttdef"><b>Definition</b> <a href="provider__factory_8cpp_source.html#l00020">provider_factory.cpp:20</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1crypto_html"><div class="ttname"><a href="namespacedtls_1_1v13_1_1crypto.html">dtls::v13::crypto</a></div><div class="ttdoc">Crypto namespace contains all cryptographic functionality for DTLS v1.3 implementation.</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00075">crypto.h:75</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md137"></a>
Crypto Provider Interface</h2>
<div class="fragment"><div class="line"><span class="keyword">class </span>CryptoProvider {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> ~CryptoProvider() = <span class="keywordflow">default</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider information</span></div>
<div class="line">    <span class="keyword">virtual</span> std::string <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_name</a>() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::string get_version() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::vector&lt;CipherSuite&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_supported_cipher_suites</a>() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::vector&lt;NamedGroup&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_supported_groups</a>() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::vector&lt;SignatureScheme&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_supported_signatures</a>() <span class="keyword">const</span> = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Key generation and management</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> generate_key_pair(<a class="code hl_enumeration" href="namespacedtls_1_1v13.html#aa8dc4e9aaf0e18a4d8934a385f8a4c34">NamedGroup</a> group) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">derive_shared_secret</a>(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; private_key,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; peer_public_key,</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#aa8dc4e9aaf0e18a4d8934a385f8a4c34">NamedGroup</a> group</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// HKDF operations (RFC 5869)</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> hkdf_extract(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; salt,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ikm</a>,</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#af7e51131da5c1ff9d96eeeb0451975fb">HashAlgorithm</a> hash</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> hkdf_expand_label(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">prk</a>,</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">label</a>,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; context,</div>
<div class="line">        <span class="keywordtype">size_t</span> length,</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#af7e51131da5c1ff9d96eeeb0451975fb">HashAlgorithm</a> hash</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// AEAD encryption/decryption</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; aead_encrypt(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; key,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; nonce,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; plaintext,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; additional_data,</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a7d733538060c2ee2b12bf5b99a8c6c23">AEADCipher</a> cipher</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; aead_decrypt(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; key,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; nonce,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; ciphertext,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; additional_data,</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a7d733538060c2ee2b12bf5b99a8c6c23">AEADCipher</a> cipher</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Digital signatures</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; sign(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; private_key,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; message,</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a804753027a2e9918057d4f4fb5423d61">SignatureScheme</a> scheme</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> verify(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; public_key,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; message,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; signature,</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a804753027a2e9918057d4f4fb5423d61">SignatureScheme</a> scheme</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Hash functions</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; hash(</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data,</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#af7e51131da5c1ff9d96eeeb0451975fb">HashAlgorithm</a> algorithm</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; hmac(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; key,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data,</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#af7e51131da5c1ff9d96eeeb0451975fb">HashAlgorithm</a> algorithm</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Random number generation</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; generate_random(<span class="keywordtype">size_t</span> length) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Certificate operations</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">parse_certificate</a>(</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; cert_data</div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> extract_public_key(</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">certificate</a></div>
<div class="line">    ) = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Hardware acceleration support</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">supports_hardware_acceleration</a>() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> enable_hardware_acceleration() = 0;</div>
<div class="line">};</div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a7d733538060c2ee2b12bf5b99a8c6c23"><div class="ttname"><a href="namespacedtls_1_1v13.html#a7d733538060c2ee2b12bf5b99a8c6c23">dtls::v13::AEADCipher</a></div><div class="ttdeci">AEADCipher</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00228">types.h:228</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a804753027a2e9918057d4f4fb5423d61"><div class="ttname"><a href="namespacedtls_1_1v13.html#a804753027a2e9918057d4f4fb5423d61">dtls::v13::SignatureScheme</a></div><div class="ttdeci">SignatureScheme</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00189">types.h:189</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aa8dc4e9aaf0e18a4d8934a385f8a4c34"><div class="ttname"><a href="namespacedtls_1_1v13.html#aa8dc4e9aaf0e18a4d8934a385f8a4c34">dtls::v13::NamedGroup</a></div><div class="ttdeci">NamedGroup</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00162">types.h:162</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_af7e51131da5c1ff9d96eeeb0451975fb"><div class="ttname"><a href="namespacedtls_1_1v13.html#af7e51131da5c1ff9d96eeeb0451975fb">dtls::v13::HashAlgorithm</a></div><div class="ttdeci">HashAlgorithm</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00214">types.h:214</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md138"></a>
Provider Manager</h2>
<p>For advanced provider management and load balancing:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>ProviderManager {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">explicit</span> ProviderManager(ProviderPoolConfig <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a> = {});</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Provider pool management</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">add_provider</a>(std::unique_ptr&lt;CryptoProvider&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">provider</a>);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">remove_provider</a>(<span class="keyword">const</span> std::string&amp; name);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Operation delegation with load balancing</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;CryptoProvider&gt;</a>&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_provider</a>();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;CryptoProvider&gt;</a>&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_provider_for_operation</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">operation_type</a></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Health monitoring</span></div>
<div class="line">    <span class="keywordtype">void</span> enable_health_monitoring(std::chrono::seconds <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">interval</a>);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">disable_health_monitoring</a>();</div>
<div class="line">    std::vector&lt;ProviderHealth&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_provider_health</a>() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Performance metrics</span></div>
<div class="line">    <span class="keyword">struct </span>PerformanceMetrics {</div>
<div class="line">        std::chrono::nanoseconds <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">avg_operation_time</a>;</div>
<div class="line">        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">operations_per_second</a>;</div>
<div class="line">        <span class="keywordtype">double</span> success_rate;</div>
<div class="line">        <span class="keywordtype">size_t</span> total_operations;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    PerformanceMetrics get_performance_metrics(<span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">provider</a>) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    ProviderPoolConfig config_;</div>
<div class="line">    std::vector&lt;std::unique_ptr&lt;CryptoProvider&gt;&gt; providers_;</div>
<div class="line">    <span class="keyword">mutable</span> std::mutex <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">providers_mutex_</a>;</div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md139"></a>
Protocol Layer</h1>
<h2><a class="anchor" id="autotoc_md140"></a>
Record Layer Interface</h2>
<p>Low-level record processing:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13_1_1protocol.html">dtls::v13::protocol</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>RecordLayer {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;RecordLayer&gt;</a>&gt; create(</div>
<div class="line">        std::unique_ptr&lt;crypto::CryptoProvider&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_provider</a></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Record processing</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; encrypt_record(</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeb">ContentType</a> content_type,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; plaintext,</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Epoch</a> epoch,</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SequenceNumber</a> sequence_number,</div>
<div class="line">        <span class="keyword">const</span> std::optional&lt;ConnectionID&gt;&amp; connection_id = std::nullopt</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;DecryptedRecord&gt;</a> decrypt_record(</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; encrypted_record</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Key management</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">set_write_keys</a>(</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Epoch</a> epoch,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; write_key,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; write_iv,</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a7d733538060c2ee2b12bf5b99a8c6c23">AEADCipher</a> cipher</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">set_read_keys</a>(</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Epoch</a> epoch,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; read_key,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; read_iv,</div>
<div class="line">        <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a7d733538060c2ee2b12bf5b99a8c6c23">AEADCipher</a> cipher</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> update_keys(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">update_secret</a>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Sequence number management</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SequenceNumber</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_next_write_sequence</a>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Epoch</a> epoch);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">validate_read_sequence</a>(</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Epoch</a> epoch,</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SequenceNumber</a> sequence_number</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Connection ID support</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> set_connection_id(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#afae06ac9662074deb5027d3dbab33c27">ConnectionID</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">cid</a>);</div>
<div class="line">    std::optional&lt;ConnectionID&gt; get_connection_id() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Anti-replay protection</span></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">enable_anti_replay_protection</a>(<span class="keywordtype">size_t</span> window_size = 64);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">disable_anti_replay_protection</a>();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    RecordLayer() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">DecryptedRecord</a> {</div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#ab9c84107809224041465427557aafdeb">ContentType</a> content_type;</div>
<div class="line">    std::vector&lt;uint8_t&gt; plaintext;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Epoch</a> epoch;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SequenceNumber</a> sequence_number;</div>
<div class="line">    std::optional&lt;ConnectionID&gt; connection_id;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1protocol_html"><div class="ttname"><a href="namespacedtls_1_1v13_1_1protocol.html">dtls::v13::protocol</a></div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00049">connection.h:49</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md141"></a>
Handshake Manager</h2>
<p>High-level handshake protocol management:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>HandshakeManager {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;HandshakeManager&gt;</a>&gt; create_client(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>,</div>
<div class="line">        std::unique_ptr&lt;crypto::CryptoProvider&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_provider</a></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::unique_ptr&lt;HandshakeManager&gt;</a>&gt; create_server(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1ConnectionConfig.html">ConnectionConfig</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>,</div>
<div class="line">        std::unique_ptr&lt;crypto::CryptoProvider&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_provider</a></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Handshake execution</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> start_handshake();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;HandshakeState&gt;</a> process_message(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; message);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_next_message</a>();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// State queries</span></div>
<div class="line">    <span class="keywordtype">bool</span> is_handshake_complete() <span class="keyword">const</span>;</div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a68896fa2f4ab2bfbb152b31cf949f0ad">ConnectionState</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_connection_state</a>() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Negotiated parameters</span></div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a2c8cefcd0588652f47924c24935f52e3">CipherSuite</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_negotiated_cipher_suite</a>() <span class="keyword">const</span>;</div>
<div class="line">    <a class="code hl_typedef" href="group__CoreTypes.html#gabc4372b1165cf4e20b612d50ff20e1bb">ProtocolVersion</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_negotiated_version</a>() <span class="keyword">const</span>;</div>
<div class="line">    std::optional&lt;ConnectionID&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_negotiated_connection_id</a>() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Session management</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">export_session_ticket</a>();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">import_session_ticket</a>(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; ticket);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Early data support</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> send_early_data(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">receive_early_data</a>();</div>
<div class="line">    <span class="keywordtype">bool</span> is_early_data_accepted() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Key material export</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;KeyMaterial&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">export_keying_material</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">label</a>,</div>
<div class="line">        <span class="keywordtype">size_t</span> length,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; context = {}</div>
<div class="line">    ) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Certificate handling</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">set_certificate_chain</a>(</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;std::vector&lt;uint8_t&gt;&gt;&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">cert_chain</a></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">set_private_key</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13.html#ad85d4a54164cded6e84c6f301708d48d">KeyMaterial</a>&amp; private_key);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">set_certificate_verify_callback</a>(</div>
<div class="line">        std::function&lt;<span class="keywordtype">bool</span>(<span class="keyword">const</span> std::vector&lt;std::vector&lt;uint8_t&gt;&gt;&amp;)&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">callback</a></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    HandshakeManager() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum class</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">HandshakeState</a> {</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">IN_PROGRESS</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13_1_1protocol.html#aae2a41dcd164452dfb58b5b373346e64a8f7afecbc8fbc4cd0f50a57d1172482e">COMPLETED</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a7546637dd240d5746d9f4b5ff3f14fd1ab9e14d9b2886bcff408b85aefa780419">FAILED</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">NEED_MORE_DATA</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">EARLY_DATA_READY</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeab29ce11310dc76ad87e254511f69d6a266c966a23020795dd739f02358b011a">HELLO_RETRY_REQUEST</a></div>
<div class="line">};</div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1protocol_html_aae2a41dcd164452dfb58b5b373346e64a8f7afecbc8fbc4cd0f50a57d1172482e"><div class="ttname"><a href="namespacedtls_1_1v13_1_1protocol.html#aae2a41dcd164452dfb58b5b373346e64a8f7afecbc8fbc4cd0f50a57d1172482e">dtls::v13::protocol::EarlyDataState::COMPLETED</a></div><div class="ttdeci">@ COMPLETED</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a7546637dd240d5746d9f4b5ff3f14fd1ab9e14d9b2886bcff408b85aefa780419"><div class="ttname"><a href="namespacedtls_1_1v13.html#a7546637dd240d5746d9f4b5ff3f14fd1ab9e14d9b2886bcff408b85aefa780419">dtls::v13::ConnectionHealth::FAILED</a></div><div class="ttdeci">@ FAILED</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md142"></a>
Memory Management</h1>
<h2><a class="anchor" id="autotoc_md143"></a>
Buffer Management</h2>
<p>Efficient memory handling for network operations:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13_1_1memory.html">dtls::v13::memory</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_typedef" href="namespacedtls_1_1v13_1_1memory.html#a81d132a373816db91abf5908e3955313">Buffer</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Construction</span></div>
<div class="line">    <a class="code hl_typedef" href="namespacedtls_1_1v13_1_1memory.html#a81d132a373816db91abf5908e3955313">Buffer</a>();</div>
<div class="line">    <span class="keyword">explicit</span> <a class="code hl_typedef" href="namespacedtls_1_1v13_1_1memory.html#a81d132a373816db91abf5908e3955313">Buffer</a>(<span class="keywordtype">size_t</span> capacity);</div>
<div class="line">    <a class="code hl_typedef" href="namespacedtls_1_1v13_1_1memory.html#a81d132a373816db91abf5908e3955313">Buffer</a>(<span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint8_t</a>* data, <span class="keywordtype">size_t</span> size);</div>
<div class="line">    <a class="code hl_typedef" href="namespacedtls_1_1v13_1_1memory.html#a81d132a373816db91abf5908e3955313">Buffer</a>(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Data access</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint8_t</a>* data();</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint8_t</a>* data() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">size_t</span> size() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">size_t</span> capacity() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> empty() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Data manipulation</span></div>
<div class="line">    <span class="keywordtype">void</span> resize(<span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">new_size</a>);</div>
<div class="line">    <span class="keywordtype">void</span> reserve(<span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">new_capacity</a>);</div>
<div class="line">    <span class="keywordtype">void</span> clear();</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> append(<span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint8_t</a>* data, <span class="keywordtype">size_t</span> size);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> append(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> append(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacedtls_1_1v13_1_1memory.html#a81d132a373816db91abf5908e3955313">Buffer</a>&amp; other);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> prepend(<span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint8_t</a>* data, <span class="keywordtype">size_t</span> size);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Zero-copy operations</span></div>
<div class="line">    <a class="code hl_typedef" href="namespacedtls_1_1v13_1_1memory.html#a81d132a373816db91abf5908e3955313">Buffer</a> slice(<span class="keywordtype">size_t</span> offset, <span class="keywordtype">size_t</span> length) <span class="keyword">const</span>;</div>
<div class="line">    std::vector&lt;Buffer&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">split_at</a>(<span class="keyword">const</span> std::vector&lt;size_t&gt;&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">offsets</a>) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Security features</span></div>
<div class="line">    <span class="keywordtype">void</span> secure_zero();  <span class="comment">// Secure memory clearing</span></div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">is_secure</a>() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Conversion</span></div>
<div class="line">    std::vector&lt;uint8_t&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">to_vector</a>() <span class="keyword">const</span>;</div>
<div class="line">    std::string <a class="code hl_function" href="namespacedtls_1_1v13_1_1memory.html#a7b070ad658e02261d11829064bf80bb2">to_hex_string</a>() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    std::unique_ptr&lt;uint8_t[]&gt; data_;</div>
<div class="line">    <span class="keywordtype">size_t</span> size_;</div>
<div class="line">    <span class="keywordtype">size_t</span> capacity_;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">secure_</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>BufferPool {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> BufferPool&amp; instance();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Buffer acquisition and release</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;Buffer&gt;</a> <a class="code hl_function" href="classdtls_1_1v13_1_1memory_1_1BufferPool.html#a1c747816bc02351e1f4138ee107788e9">acquire</a>(<span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">min_size</a>);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="classdtls_1_1v13_1_1memory_1_1BufferPool.html#a4dddc45921800858b3a69f58663d9a11">release</a>(<a class="code hl_typedef" href="namespacedtls_1_1v13_1_1memory.html#a81d132a373816db91abf5908e3955313">Buffer</a>&amp;&amp; buffer);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Pool configuration</span></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="classdtls_1_1v13_1_1memory_1_1BufferPool.html#ad32a9da15863c85af91d98c8797d73a9">set_max_pool_size</a>(<span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">max_buffers</a>);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">set_buffer_sizes</a>(<span class="keyword">const</span> std::vector&lt;size_t&gt;&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">sizes</a>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span>PoolStats {</div>
<div class="line">        <span class="keywordtype">size_t</span> total_buffers;</div>
<div class="line">        <span class="keywordtype">size_t</span> available_buffers;</div>
<div class="line">        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">allocations</a>;</div>
<div class="line">        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">deallocations</a>;</div>
<div class="line">        <span class="keywordtype">size_t</span> pool_hits;</div>
<div class="line">        <span class="keywordtype">size_t</span> pool_misses;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    PoolStats <a class="code hl_function" href="classdtls_1_1v13_1_1memory_1_1BufferPool.html#a4577195a7f73facd0bebe38f97d3c1d8">get_statistics</a>() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> reset_statistics();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_function" href="classdtls_1_1v13_1_1memory_1_1BufferPool.html#a4a6a477b2ab9361f4a5dff9be2f8c2ae">BufferPool</a>() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="aclassdtls_1_1v13_1_1memory_1_1BufferPool_html_a1c747816bc02351e1f4138ee107788e9"><div class="ttname"><a href="classdtls_1_1v13_1_1memory_1_1BufferPool.html#a1c747816bc02351e1f4138ee107788e9">dtls::v13::memory::BufferPool::acquire</a></div><div class="ttdeci">std::unique_ptr&lt; ZeroCopyBuffer &gt; acquire()</div><div class="ttdef"><b>Definition</b> <a href="pool_8cpp_source.html#l00038">pool.cpp:38</a></div></div>
<div class="ttc" id="aclassdtls_1_1v13_1_1memory_1_1BufferPool_html_a4577195a7f73facd0bebe38f97d3c1d8"><div class="ttname"><a href="classdtls_1_1v13_1_1memory_1_1BufferPool.html#a4577195a7f73facd0bebe38f97d3c1d8">dtls::v13::memory::BufferPool::get_statistics</a></div><div class="ttdeci">PoolStats get_statistics() const</div><div class="ttdef"><b>Definition</b> <a href="pool_8cpp_source.html#l00161">pool.cpp:161</a></div></div>
<div class="ttc" id="aclassdtls_1_1v13_1_1memory_1_1BufferPool_html_a4a6a477b2ab9361f4a5dff9be2f8c2ae"><div class="ttname"><a href="classdtls_1_1v13_1_1memory_1_1BufferPool.html#a4a6a477b2ab9361f4a5dff9be2f8c2ae">dtls::v13::memory::BufferPool::BufferPool</a></div><div class="ttdeci">BufferPool(size_t buffer_size, size_t pool_size=32)</div><div class="ttdef"><b>Definition</b> <a href="pool_8cpp_source.html#l00011">pool.cpp:11</a></div></div>
<div class="ttc" id="aclassdtls_1_1v13_1_1memory_1_1BufferPool_html_a4dddc45921800858b3a69f58663d9a11"><div class="ttname"><a href="classdtls_1_1v13_1_1memory_1_1BufferPool.html#a4dddc45921800858b3a69f58663d9a11">dtls::v13::memory::BufferPool::release</a></div><div class="ttdeci">void release(std::unique_ptr&lt; ZeroCopyBuffer &gt; buffer)</div><div class="ttdef"><b>Definition</b> <a href="pool_8cpp_source.html#l00074">pool.cpp:74</a></div></div>
<div class="ttc" id="aclassdtls_1_1v13_1_1memory_1_1BufferPool_html_ad32a9da15863c85af91d98c8797d73a9"><div class="ttname"><a href="classdtls_1_1v13_1_1memory_1_1BufferPool.html#ad32a9da15863c85af91d98c8797d73a9">dtls::v13::memory::BufferPool::set_max_pool_size</a></div><div class="ttdeci">void set_max_pool_size(size_t max_size)</div><div class="ttdef"><b>Definition</b> <a href="pool_8cpp_source.html#l00203">pool.cpp:203</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1memory_html"><div class="ttname"><a href="namespacedtls_1_1v13_1_1memory.html">dtls::v13::memory</a></div><div class="ttdoc">Memory namespace contains all memory management functionality for DTLS v1.3 implementation.</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00054">memory.h:54</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1memory_html_a7b070ad658e02261d11829064bf80bb2"><div class="ttname"><a href="namespacedtls_1_1v13_1_1memory.html#a7b070ad658e02261d11829064bf80bb2">dtls::v13::memory::to_hex_string</a></div><div class="ttdeci">DTLS_API std::string to_hex_string(const BufferView &amp;buffer)</div><div class="ttdef"><b>Definition</b> <a href="buffer_8cpp_source.html#l00602">buffer.cpp:602</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1memory_html_a81d132a373816db91abf5908e3955313"><div class="ttname"><a href="namespacedtls_1_1v13_1_1memory.html#a81d132a373816db91abf5908e3955313">dtls::v13::memory::Buffer</a></div><div class="ttdeci">ZeroCopyBuffer Buffer</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00293">memory.h:293</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md144"></a>
Error Handling</h1>
<h2><a class="anchor" id="autotoc_md145"></a>
Error Types and Codes</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13.html">dtls::v13</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum class</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ErrorCode</a> {</div>
<div class="line">    <span class="comment">// Success</span></div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243ad0749aaba8b833466dfcbb0428e4f89c">SUCCESS</a> = 0,</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Network errors</span></div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243a547ba52b62f9302ee1b6950111c36f9f">NETWORK_ERROR</a> = 1000,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">CONNECTION_FAILED</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243ad094d5806cc309e317fd3420bbd30fb5">CONNECTION_TIMEOUT</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1eaa7009c19a45f0ebd4b14300665df173c5">CONNECTION_CLOSED</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">BIND_FAILED</a>,</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Protocol errors</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">PROTOCOL_ERROR</a> = 2000,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">INVALID_MESSAGE</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">INVALID_VERSION</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">UNSUPPORTED_CIPHER_SUITE</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1eaa031450236028a5f782ed0cb7745935b3">HANDSHAKE_FAILED</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">CERTIFICATE_ERROR</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243a1118268b6de447759048435aba947f80">SIGNATURE_VERIFICATION_FAILED</a>,</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Cryptographic errors</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">CRYPTO_ERROR</a> = 3000,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">KEY_GENERATION_FAILED</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ENCRYPTION_FAILED</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">DECRYPTION_FAILED</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SIGNATURE_FAILED</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">HASH_FAILED</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243a3e467d9307d99e96554d1746b77504e1">RANDOM_GENERATION_FAILED</a>,</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Memory errors</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">MEMORY_ERROR</a> = 4000,</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243ac56ddb8056b120c9d5fee05981f219c6">OUT_OF_MEMORY</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">BUFFER_OVERFLOW</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">INVALID_BUFFER_SIZE</a>,</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration errors</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">CONFIG_ERROR</a> = 5000,</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243a8c0d68af13898dae2b6cbbafd8fbac93">INVALID_CONFIGURATION</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243afa885049b3e0acdd7f002a8af61c7036">MISSING_CONFIGURATION</a>,</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">UNSUPPORTED_FEATURE</a></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ErrorCode</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">code</a>, <span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ErrorCode</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">code</a>, <span class="keyword">const</span> std::string&amp; message, </div>
<div class="line">          <span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">detail</a>);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ErrorCode</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">code</a>() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keyword">const</span> std::string&amp; message() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">detail</a>() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Error chaining</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">caused_by</a>(<span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">cause</a>);</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a>* <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_cause</a>() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// String representation</span></div>
<div class="line">    std::string <a class="code hl_function" href="namespacedtls_1_1v13.html#aaac42ceaa9423141c293c1fa726010d0">to_string</a>() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Predefined error creators</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">network_error</a>(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">protocol_error</a>(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_error</a>(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">memory_error</a>(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Error</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config_error</a>(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ErrorCode</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">code_</a>;</div>
<div class="line">    std::string message_;</div>
<div class="line">    std::string <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">detail_</a>;</div>
<div class="line">    std::unique_ptr&lt;Error&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">cause_</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ae6e8032c12417cb62fd44f38dfe5a1eaa031450236028a5f782ed0cb7745935b3"><div class="ttname"><a href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1eaa031450236028a5f782ed0cb7745935b3">dtls::v13::ConnectionEvent::HANDSHAKE_FAILED</a></div><div class="ttdeci">@ HANDSHAKE_FAILED</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_ae6e8032c12417cb62fd44f38dfe5a1eaa7009c19a45f0ebd4b14300665df173c5"><div class="ttname"><a href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1eaa7009c19a45f0ebd4b14300665df173c5">dtls::v13::ConnectionEvent::CONNECTION_CLOSED</a></div><div class="ttdeci">@ CONNECTION_CLOSED</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeaab1a668f345648ec3f402f6d41a243a1118268b6de447759048435aba947f80"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243a1118268b6de447759048435aba947f80">dtls::v13::DTLSError::SIGNATURE_VERIFICATION_FAILED</a></div><div class="ttdeci">@ SIGNATURE_VERIFICATION_FAILED</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeaab1a668f345648ec3f402f6d41a243a3e467d9307d99e96554d1746b77504e1"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243a3e467d9307d99e96554d1746b77504e1">dtls::v13::DTLSError::RANDOM_GENERATION_FAILED</a></div><div class="ttdeci">@ RANDOM_GENERATION_FAILED</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeaab1a668f345648ec3f402f6d41a243a547ba52b62f9302ee1b6950111c36f9f"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243a547ba52b62f9302ee1b6950111c36f9f">dtls::v13::DTLSError::NETWORK_ERROR</a></div><div class="ttdeci">@ NETWORK_ERROR</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeaab1a668f345648ec3f402f6d41a243a8c0d68af13898dae2b6cbbafd8fbac93"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243a8c0d68af13898dae2b6cbbafd8fbac93">dtls::v13::DTLSError::INVALID_CONFIGURATION</a></div><div class="ttdeci">@ INVALID_CONFIGURATION</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeaab1a668f345648ec3f402f6d41a243ac56ddb8056b120c9d5fee05981f219c6"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243ac56ddb8056b120c9d5fee05981f219c6">dtls::v13::DTLSError::OUT_OF_MEMORY</a></div><div class="ttdeci">@ OUT_OF_MEMORY</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeaab1a668f345648ec3f402f6d41a243ad0749aaba8b833466dfcbb0428e4f89c"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243ad0749aaba8b833466dfcbb0428e4f89c">dtls::v13::DTLSError::SUCCESS</a></div><div class="ttdeci">@ SUCCESS</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeaab1a668f345648ec3f402f6d41a243ad094d5806cc309e317fd3420bbd30fb5"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243ad094d5806cc309e317fd3420bbd30fb5">dtls::v13::DTLSError::CONNECTION_TIMEOUT</a></div><div class="ttdeci">@ CONNECTION_TIMEOUT</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_aeaab1a668f345648ec3f402f6d41a243afa885049b3e0acdd7f002a8af61c7036"><div class="ttname"><a href="namespacedtls_1_1v13.html#aeaab1a668f345648ec3f402f6d41a243afa885049b3e0acdd7f002a8af61c7036">dtls::v13::DTLSError::MISSING_CONFIGURATION</a></div><div class="ttdeci">@ MISSING_CONFIGURATION</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md146"></a>
Error Recovery</h2>
<p>Advanced error handling and recovery mechanisms:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structdtls_1_1v13_1_1ErrorRecoveryConfig.html">ErrorRecoveryConfig</a> {</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> max_retries = 3;</div>
<div class="line">    std::chrono::milliseconds initial_retry_delay{1000};</div>
<div class="line">    std::chrono::milliseconds max_retry_delay{30000};</div>
<div class="line">    <span class="keywordtype">double</span> backoff_multiplier = 2.0;</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> max_consecutive_errors = 10;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> max_errors_per_minute = 50;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> degraded_mode_threshold = 5;</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7">RecoveryStrategy</a> handshake_error_strategy = RecoveryStrategy::RETRY_WITH_BACKOFF;</div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7">RecoveryStrategy</a> crypto_error_strategy = RecoveryStrategy::RETRY_IMMEDIATE;</div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7">RecoveryStrategy</a> network_error_strategy = RecoveryStrategy::RETRY_WITH_BACKOFF;</div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7">RecoveryStrategy</a> protocol_error_strategy = RecoveryStrategy::RESET_CONNECTION;</div>
<div class="line">    </div>
<div class="line">    std::chrono::seconds health_check_interval{60};</div>
<div class="line">    std::chrono::seconds error_rate_window{60};</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">bool</span> enable_automatic_recovery = <span class="keyword">true</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum class</span> <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7">RecoveryStrategy</a> {</div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7ab50339a10e1de285ac99d4c3990b8693">NONE</a>,                    <span class="comment">// No recovery attempt</span></div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7a31995be349b2c6ff457b653ced20296d">RETRY_IMMEDIATE</a>,         <span class="comment">// Immediate retry</span></div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7afdd0168686ad6e589e86cbb61a224079">RETRY_WITH_BACKOFF</a>,      <span class="comment">// Exponential backoff retry</span></div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7aedb213ca9b6476838f1ed7f03f926d22">GRACEFUL_DEGRADATION</a>,    <span class="comment">// Reduce functionality</span></div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7a1af38ab8c9d27db122d0e538c9bc2305">RESET_CONNECTION</a>,        <span class="comment">// Reset and reconnect</span></div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7a36d31c88e39d3eb841007cbe5c9272dd">FAILOVER</a>,               <span class="comment">// Switch to backup</span></div>
<div class="line">    <a class="code hl_enumvalue" href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7a78d9166d151784a4673ec9b57e275c1c">ABORT_CONNECTION</a>        <span class="comment">// Terminate connection</span></div>
<div class="line">};</div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a3148a802c5357f5e43dcf3ba7a4a97b7"><div class="ttname"><a href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7">dtls::v13::RecoveryStrategy</a></div><div class="ttdeci">RecoveryStrategy</div><div class="ttdoc">Error recovery strategy types for connection management.</div><div class="ttdef"><b>Definition</b> <a href="connection_8h_source.html#l00067">connection.h:67</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a3148a802c5357f5e43dcf3ba7a4a97b7a1af38ab8c9d27db122d0e538c9bc2305"><div class="ttname"><a href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7a1af38ab8c9d27db122d0e538c9bc2305">dtls::v13::RecoveryStrategy::RESET_CONNECTION</a></div><div class="ttdeci">@ RESET_CONNECTION</div><div class="ttdoc">Reset connection state and retry (for state corruption)</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a3148a802c5357f5e43dcf3ba7a4a97b7a31995be349b2c6ff457b653ced20296d"><div class="ttname"><a href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7a31995be349b2c6ff457b653ced20296d">dtls::v13::RecoveryStrategy::RETRY_IMMEDIATE</a></div><div class="ttdeci">@ RETRY_IMMEDIATE</div><div class="ttdoc">Immediate retry without delay (for transient errors)</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a3148a802c5357f5e43dcf3ba7a4a97b7a36d31c88e39d3eb841007cbe5c9272dd"><div class="ttname"><a href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7a36d31c88e39d3eb841007cbe5c9272dd">dtls::v13::RecoveryStrategy::FAILOVER</a></div><div class="ttdeci">@ FAILOVER</div><div class="ttdoc">Switch to alternative provider/configuration (for provider failures)</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a3148a802c5357f5e43dcf3ba7a4a97b7a78d9166d151784a4673ec9b57e275c1c"><div class="ttname"><a href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7a78d9166d151784a4673ec9b57e275c1c">dtls::v13::RecoveryStrategy::ABORT_CONNECTION</a></div><div class="ttdeci">@ ABORT_CONNECTION</div><div class="ttdoc">Terminate connection gracefully (for unrecoverable errors)</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a3148a802c5357f5e43dcf3ba7a4a97b7ab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7ab50339a10e1de285ac99d4c3990b8693">dtls::v13::RecoveryStrategy::NONE</a></div><div class="ttdeci">@ NONE</div><div class="ttdoc">No recovery attempted - fail immediately.</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a3148a802c5357f5e43dcf3ba7a4a97b7aedb213ca9b6476838f1ed7f03f926d22"><div class="ttname"><a href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7aedb213ca9b6476838f1ed7f03f926d22">dtls::v13::RecoveryStrategy::GRACEFUL_DEGRADATION</a></div><div class="ttdeci">@ GRACEFUL_DEGRADATION</div><div class="ttdoc">Continue with reduced functionality (for feature failures)</div></div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a3148a802c5357f5e43dcf3ba7a4a97b7afdd0168686ad6e589e86cbb61a224079"><div class="ttname"><a href="namespacedtls_1_1v13.html#a3148a802c5357f5e43dcf3ba7a4a97b7afdd0168686ad6e589e86cbb61a224079">dtls::v13::RecoveryStrategy::RETRY_WITH_BACKOFF</a></div><div class="ttdeci">@ RETRY_WITH_BACKOFF</div><div class="ttdoc">Retry with exponential backoff (for network congestion)</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md147"></a>
Configuration</h1>
<h2><a class="anchor" id="autotoc_md148"></a>
System Configuration</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">dtls::v13::config</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SystemConfig</a> {</div>
<div class="line">    <span class="comment">// Threading configuration</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> worker_threads = std::thread::hardware_concurrency();</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">enable_thread_pool</a> = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">size_t</span> max_concurrent_handshakes = 1000;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Memory configuration</span></div>
<div class="line">    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">default_buffer_size</a> = 16384;</div>
<div class="line">    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">max_buffer_pool_size</a> = 10000;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">enable_secure_memory</a> = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">enable_memory_debugging</a> = <span class="keyword">false</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Security configuration</span></div>
<div class="line">    <a class="code hl_enumeration" href="namespacedtls_1_1v13.html#a454f2e2956822357a074530f22006b51">SecurityLevel</a> default_security_level = SecurityLevel::HIGH;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">enforce_perfect_forward_secrecy</a> = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">allow_weak_cipher_suites</a> = <span class="keyword">false</span>;</div>
<div class="line">    std::chrono::seconds <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">session_ticket_lifetime</a>{7200};</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Performance configuration</span></div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">enable_zero_copy_operations</a> = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_hardware_acceleration = <span class="keyword">true</span>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">max_connections_per_thread</a> = 100;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Logging and monitoring</span></div>
<div class="line">    LogLevel <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">default_log_level</a> = LogLevel::INFO;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">enable_performance_metrics</a> = <span class="keyword">true</span>;</div>
<div class="line">    std::chrono::seconds metrics_collection_interval{60};</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Load from configuration file</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;SystemConfig&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">from_file</a>(<span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config_path</a>);</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;SystemConfig&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">from_json</a>(<span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">json_config</a>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Validation</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">validate</a>() <span class="keyword">const</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Global configuration access</span></div>
<div class="line"><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">set_global_config</a>(<span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SystemConfig</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>);</div>
<div class="line"><span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SystemConfig</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_global_config</a>();</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="anamespacedtls_1_1v13_html_a454f2e2956822357a074530f22006b51"><div class="ttname"><a href="namespacedtls_1_1v13.html#a454f2e2956822357a074530f22006b51">dtls::v13::SecurityLevel</a></div><div class="ttdeci">SecurityLevel</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00285">types.h:285</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md149"></a>
Performance Monitoring</h1>
<h2><a class="anchor" id="autotoc_md150"></a>
Metrics Collection</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13_1_1monitoring.html">dtls::v13::monitoring</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ConnectionMetrics</a> {</div>
<div class="line">    <span class="comment">// Timing metrics</span></div>
<div class="line">    std::chrono::nanoseconds <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_time</a>;</div>
<div class="line">    std::chrono::nanoseconds <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">avg_round_trip_time</a>;</div>
<div class="line">    std::chrono::nanoseconds <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_operation_time</a>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Throughput metrics</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint64_t</a> bytes_sent;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint64_t</a> bytes_received;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> records_sent;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> records_received;</div>
<div class="line">    <span class="keywordtype">double</span> throughput_mbps;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Error metrics</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> handshake_failures;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> crypto_errors;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> network_errors;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> protocol_errors;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Security metrics</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">replay_attacks_blocked</a>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">invalid_signatures</a>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">certificate_failures</a>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">dos_attacks_blocked</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SystemMetrics</a> {</div>
<div class="line">    <span class="comment">// Resource utilization</span></div>
<div class="line">    <span class="keywordtype">double</span> cpu_usage_percent;</div>
<div class="line">    <span class="keywordtype">size_t</span> memory_usage_bytes;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> active_connections;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> pending_handshakes;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Performance metrics</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">connections_per_second</a>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshakes_per_second</a>;</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">avg_handshake_time_ms</a>;</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">avg_throughput_mbps</a>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// System health</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">total_errors_per_minute</a>;</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">error_rate_percent</a>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">degraded_connections</a>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> failed_connections;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>MetricsCollector {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> MetricsCollector&amp; instance();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Metrics collection</span></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">record_handshake_time</a>(std::chrono::nanoseconds <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">duration</a>);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">record_bytes_transferred</a>(<span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bytes</a>, <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">sent</a>);</div>
<div class="line">    <span class="keywordtype">void</span> record_error(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ErrorCode</a> error_code);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">record_crypto_operation_time</a>(std::chrono::nanoseconds <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">duration</a>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Metrics retrieval</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">ConnectionMetrics</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_connection_metrics</a>(<span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp; connection) <span class="keyword">const</span>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SystemMetrics</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">get_system_metrics</a>() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Reporting</span></div>
<div class="line">    std::string <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">generate_metrics_report</a>() <span class="keyword">const</span>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;void&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">export_metrics_to_file</a>(<span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">filepath</a>) <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configuration</span></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">set_collection_interval</a>(std::chrono::seconds <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">interval</a>);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">enable_detailed_metrics</a>(<span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">enable</a>);</div>
<div class="line">    <span class="keywordtype">void</span> reset_all_metrics();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    MetricsCollector() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1monitoring_html"><div class="ttname"><a href="namespacedtls_1_1v13_1_1monitoring.html">dtls::v13::monitoring</a></div><div class="ttdef"><b>Definition</b> <a href="metrics__system_8h_source.html#l00024">metrics_system.h:24</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md151"></a>
Security Features</h1>
<h2><a class="anchor" id="autotoc_md152"></a>
DoS Protection</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13_1_1security.html">dtls::v13::security</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>DoSProtection {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">DoSConfig</a> {</div>
<div class="line">        <span class="comment">// Rate limiting</span></div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> max_connections_per_ip = 100;</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">max_handshakes_per_second</a> = 1000;</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">max_requests_per_minute</a> = 60000;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Resource limits</span></div>
<div class="line">        <span class="keywordtype">size_t</span> max_memory_per_connection = 65536;</div>
<div class="line">        <span class="keywordtype">size_t</span> max_total_memory = 100 * 1024 * 1024;  <span class="comment">// 100MB</span></div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> max_concurrent_handshakes = 10000;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Cookie verification</span></div>
<div class="line">        <span class="keywordtype">bool</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">enable_cookie_verification</a> = <span class="keyword">true</span>;</div>
<div class="line">        std::chrono::seconds cookie_lifetime{300};</div>
<div class="line">        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">cookie_key_rotation_interval</a> = 3600;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Timeout protection</span></div>
<div class="line">        std::chrono::seconds connection_timeout{300};</div>
<div class="line">        std::chrono::seconds handshake_timeout{30};</div>
<div class="line">        std::chrono::seconds idle_timeout{900};</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">explicit</span> <a class="code hl_function" href="classdtls_1_1v13_1_1security_1_1DoSProtection.html#a692dec13d514a0f1cea9f1bb98e02ba8">DoSProtection</a>(<span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">DoSConfig</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Request validation</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">should_accept_connection</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">client_addr</a>);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">validate_handshake_rate</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">client_addr</a>);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> check_resource_limits() <span class="keyword">const</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Cookie verification</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;std::vector&lt;uint8_t&gt;</a>&gt; generate_cookie(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">client_addr</a>,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">client_hello</a></div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">Result&lt;bool&gt;</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">verify_cookie</a>(</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_struct" href="structdtls_1_1v13_1_1NetworkAddress.html">NetworkAddress</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">client_addr</a>,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">client_hello</a>,</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; cookie</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">DoSStats</a> {</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint64_t</a> total_connections_blocked;</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint64_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">rate_limited_requests</a>;</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint64_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">cookie_verification_failures</a>;</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint64_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">resource_limit_violations</a>;</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">uint32_t</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">currently_blocked_ips</a>;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">DoSStats</a> <a class="code hl_function" href="classdtls_1_1v13_1_1security_1_1DoSProtection.html#a1cd1e9babaec1a647306787958885da1">get_statistics</a>() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> reset_statistics();</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">DoSConfig</a> config_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="aclassdtls_1_1v13_1_1security_1_1DoSProtection_html_a1cd1e9babaec1a647306787958885da1"><div class="ttname"><a href="classdtls_1_1v13_1_1security_1_1DoSProtection.html#a1cd1e9babaec1a647306787958885da1">dtls::v13::security::DoSProtection::get_statistics</a></div><div class="ttdeci">DoSProtectionStats get_statistics() const</div><div class="ttdoc">Get DoS protection statistics.</div><div class="ttdef"><b>Definition</b> <a href="security_2dos__protection_8cpp_source.html#l00501">dos_protection.cpp:501</a></div></div>
<div class="ttc" id="aclassdtls_1_1v13_1_1security_1_1DoSProtection_html_a692dec13d514a0f1cea9f1bb98e02ba8"><div class="ttname"><a href="classdtls_1_1v13_1_1security_1_1DoSProtection.html#a692dec13d514a0f1cea9f1bb98e02ba8">dtls::v13::security::DoSProtection::DoSProtection</a></div><div class="ttdeci">DoSProtection(const DoSProtectionConfig &amp;config=DoSProtectionConfig{})</div><div class="ttdef"><b>Definition</b> <a href="security_2dos__protection_8cpp_source.html#l00163">dos_protection.cpp:163</a></div></div>
<div class="ttc" id="anamespacedtls_1_1v13_1_1security_html"><div class="ttname"><a href="namespacedtls_1_1v13_1_1security.html">dtls::v13::security</a></div><div class="ttdef"><b>Definition</b> <a href="security_2dos__protection_8h_source.html#l00018">dos_protection.h:18</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md153"></a>
Examples</h1>
<h2><a class="anchor" id="autotoc_md154"></a>
Complete Client Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;dtls/dtls.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">main</a>() {</div>
<div class="line">    <span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13.html">dtls::v13</a>;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        <span class="comment">// Initialize crypto provider</span></div>
<div class="line">        <span class="keyword">auto</span>&amp; factory = crypto::ProviderFactory::instance();</div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_result</a> = factory.create_provider(<span class="stringliteral">&quot;openssl&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_result</a>) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to create crypto provider: &quot;</span> </div>
<div class="line">                      &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Configure connection</span></div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a> = ConnectionConfig::default_client_config();</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>.enable_early_data = <span class="keyword">true</span>;</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>.handshake_timeout = std::chrono::seconds(10);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Create connection</span></div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server_addr</a> = NetworkAddress::from_string(<span class="stringliteral">&quot;example.com:4433&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server_addr</a>) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Invalid server address&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn_result</a> = Connection::create_client(</div>
<div class="line">            *<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server_addr</a>, <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>, std::move(*<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_result</a>)</div>
<div class="line">        );</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn_result</a>) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to create connection: &quot;</span> </div>
<div class="line">                      &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">auto</span> connection = std::move(*<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn_result</a>);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Set up event handling</span></div>
<div class="line">        connection-&gt;set_event_callback([](<a class="code hl_enumeration" href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1ea">ConnectionEvent</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">event</a>, <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>) {</div>
<div class="line">            <span class="keywordflow">switch</span> (<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">event</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> ConnectionEvent::HANDSHAKE_COMPLETED:</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;Handshake completed successfully!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;Cipher suite: &quot;</span> </div>
<div class="line">                              &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>.get_negotiated_cipher_suite()) </div>
<div class="line">                              &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">case</span> ConnectionEvent::DATA_RECEIVED:</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;Data received from server&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">case</span> ConnectionEvent::ERROR_OCCURRED:</div>
<div class="line">                    std::cerr &lt;&lt; <span class="stringliteral">&quot;Connection error occurred&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                    </div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        });</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Perform handshake</span></div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_result</a> = connection-&gt;handshake();</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_result</a>) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Handshake failed: &quot;</span> </div>
<div class="line">                      &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Send HTTP request</span></div>
<div class="line">        std::string <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">http_request</a> = </div>
<div class="line">            <span class="stringliteral">&quot;GET / HTTP/1.1\r\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;Host: example.com\r\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;Connection: close\r\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line">        </div>
<div class="line">        std::vector&lt;uint8_t&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">request_data</a>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">http_request</a>.begin(), <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">http_request</a>.end());</div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">send_result</a> = connection-&gt;send(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">request_data</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">send_result</a>) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to send data: &quot;</span> </div>
<div class="line">                      &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">send_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Sent &quot;</span> &lt;&lt; *<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">send_result</a> &lt;&lt; <span class="stringliteral">&quot; bytes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Receive response</span></div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">response_result</a> = connection-&gt;receive();</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">response_result</a>) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to receive data: &quot;</span> </div>
<div class="line">                      &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">response_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Received &quot;</span> &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">response_result</a>-&gt;size() &lt;&lt; <span class="stringliteral">&quot; bytes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::string <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">response</a>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">response_result</a>-&gt;begin(), <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">response_result</a>-&gt;end());</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Response: &quot;</span> &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">response</a> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Print connection statistics</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; stats = connection-&gt;get_statistics();</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Connection Statistics:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  Handshake duration: &quot;</span> </div>
<div class="line">                  &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div>
<div class="line">                      stats.handshake_duration).count() &lt;&lt; <span class="stringliteral">&quot;ms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  Bytes sent: &quot;</span> &lt;&lt; stats.bytes_sent &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  Bytes received: &quot;</span> &lt;&lt; stats.bytes_received &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  Records sent: &quot;</span> &lt;&lt; stats.records_sent &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  Records received: &quot;</span> &lt;&lt; stats.records_received &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Close connection gracefully</span></div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">close_result</a> = connection-&gt;close();</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">close_result</a>) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to close connection properly&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">        </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">e</a>) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception: &quot;</span> &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">e</a>.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md155"></a>
Complete Server Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;dtls/dtls.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;thread&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"> </div>
<div class="line">std::atomic&lt;bool&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">g_running</a>{<span class="keyword">true</span>};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">signal_handler</a>(<span class="keywordtype">int</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">signal</a>) {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">signal</a> == <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SIGINT</a> || <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">signal</a> == <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SIGTERM</a>) {</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">g_running</a> = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">EchoServer</a> {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    std::unique_ptr&lt;dtls::v13::ConnectionManager&gt; manager_;</div>
<div class="line">    std::vector&lt;std::shared_ptr&lt;dtls::v13::Connection&gt;&gt; active_connections_;</div>
<div class="line">    std::mutex connections_mutex_;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> start(<span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_address</a>) {</div>
<div class="line">        <span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13.html">dtls::v13</a>;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Configure server</span></div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a> = ConnectionConfig::default_server_config();</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>.max_early_data_size = 16384;</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>.enable_connection_id = <span class="keyword">true</span>;</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>.connection_id_length = 8;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Create connection manager</span></div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">manager_result</a> = ConnectionManager::create(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">manager_result</a>) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to create connection manager: &quot;</span> </div>
<div class="line">                      &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">manager_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        manager_ = std::move(*<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">manager_result</a>);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Set up event callbacks</span></div>
<div class="line">        manager_-&gt;set_event_callback([<span class="keyword">this</span>](<a class="code hl_enumeration" href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1ea">ConnectionEvent</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">event</a>, <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>) {</div>
<div class="line">            this-&gt;<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handle_connection_event</a>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">event</a>, <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>);</div>
<div class="line">        });</div>
<div class="line">        </div>
<div class="line">        manager_-&gt;set_new_connection_callback([<span class="keyword">this</span>](std::shared_ptr&lt;Connection&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>) {</div>
<div class="line">            this-&gt;<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handle_new_connection</a>(std::move(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>));</div>
<div class="line">        });</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Bind to address</span></div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">addr_result</a> = NetworkAddress::from_string(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_address</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">addr_result</a>) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Invalid bind address: &quot;</span> &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_address</a> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_result</a> = manager_-&gt;bind(*<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">addr_result</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_result</a>) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to bind to &quot;</span> &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_address</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> </div>
<div class="line">                      &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;DTLS server listening on &quot;</span> &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_address</a> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Start server loop</span></div>
<div class="line">        manager_-&gt;run();</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> stop() {</div>
<div class="line">        <span class="keywordflow">if</span> (manager_) {</div>
<div class="line">            manager_-&gt;stop();</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        std::lock_guard&lt;std::mutex&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">lock</a>(connections_mutex_);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a> : active_connections_) {</div>
<div class="line">            <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>-&gt;close();</div>
<div class="line">        }</div>
<div class="line">        active_connections_.clear();</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handle_connection_event</a>(<a class="code hl_enumeration" href="namespacedtls_1_1v13.html#ae6e8032c12417cb62fd44f38dfe5a1ea">dtls::v13::ConnectionEvent</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">event</a>, </div>
<div class="line">                                 <span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">dtls::v13::Connection</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>) {</div>
<div class="line">        <span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13.html">dtls::v13</a>;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">switch</span> (<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">event</a>) {</div>
<div class="line">            <span class="keywordflow">case</span> ConnectionEvent::HANDSHAKE_COMPLETED:</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Client handshake completed&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">            <span class="keywordflow">case</span> ConnectionEvent::DATA_RECEIVED: {</div>
<div class="line">                <span class="comment">// Echo received data back to client</span></div>
<div class="line">                <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">data_result</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp;<span class="keyword">&gt;</span>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>).receive();</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">data_result</a>) {</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;Received &quot;</span> &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">data_result</a>-&gt;size() </div>
<div class="line">                              &lt;&lt; <span class="stringliteral">&quot; bytes from client&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    </div>
<div class="line">                    <span class="comment">// Echo the data back</span></div>
<div class="line">                    <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">send_result</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">Connection</a>&amp;<span class="keyword">&gt;</span>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>).send(*<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">data_result</a>);</div>
<div class="line">                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">send_result</a>) {</div>
<div class="line">                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to echo data: &quot;</span> </div>
<div class="line">                                  &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">send_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">                    } <span class="keywordflow">else</span> {</div>
<div class="line">                        std::cout &lt;&lt; <span class="stringliteral">&quot;Echoed &quot;</span> &lt;&lt; *<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">send_result</a> &lt;&lt; <span class="stringliteral">&quot; bytes back&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">case</span> ConnectionEvent::CONNECTION_CLOSED:</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Client disconnected&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                remove_connection(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">            <span class="keywordflow">case</span> ConnectionEvent::ERROR_OCCURRED:</div>
<div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;Connection error occurred&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                remove_connection(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">            <span class="keywordflow">case</span> ConnectionEvent::EARLY_DATA_RECEIVED:</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Early data received from client&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                </div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handle_new_connection</a>(std::shared_ptr&lt;dtls::v13::Connection&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>) {</div>
<div class="line">        std::lock_guard&lt;std::mutex&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">lock</a>(connections_mutex_);</div>
<div class="line">        active_connections_.push_back(std::move(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>));</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;New client connected. Total connections: &quot;</span> </div>
<div class="line">                  &lt;&lt; active_connections_.size() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> remove_connection(<span class="keyword">const</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Connection.html">dtls::v13::Connection</a>&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>) {</div>
<div class="line">        std::lock_guard&lt;std::mutex&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">lock</a>(connections_mutex_);</div>
<div class="line">        active_connections_.erase(</div>
<div class="line">            std::remove_if(active_connections_.begin(), active_connections_.end(),</div>
<div class="line">                [&amp;<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn</a>](<span class="keyword">const</span> std::weak_ptr&lt;dtls::v13::Connection&gt;&amp; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">weak_conn</a>) {</div>
<div class="line">                    auto shared_conn = weak_conn.lock();</div>
<div class="line">                    return !shared_conn || shared_conn.get() == &amp;conn;</div>
<div class="line">                }),</div>
<div class="line">            active_connections_.end()</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">main</a>(<span class="keywordtype">int</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">argc</a>, <span class="keywordtype">char</span>* <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">argv</a>[]) {</div>
<div class="line">    <span class="comment">// Set up signal handling</span></div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">signal</a>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SIGINT</a>, <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">signal_handler</a>);</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">signal</a>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">SIGTERM</a>, <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">signal_handler</a>);</div>
<div class="line">    </div>
<div class="line">    std::string <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_address</a> = <span class="stringliteral">&quot;0.0.0.0:4433&quot;</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">argc</a> &gt; 1) {</div>
<div class="line">        <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_address</a> = <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">argv</a>[1];</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">EchoServer</a> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server</a>;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server</a>.start(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">bind_address</a>)) {</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Wait for shutdown signal</span></div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">g_running</a>) {</div>
<div class="line">        std::this_thread::sleep_for(std::chrono::milliseconds(100));</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Shutting down server...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">server</a>.stop();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md156"></a>
Early Data (0-RTT) Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;dtls/dtls.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">main</a>() {</div>
<div class="line">    <span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacedtls_1_1v13.html">dtls::v13</a>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Configure client with early data support</span></div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a> = ConnectionConfig::default_client_config();</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>.enable_early_data = <span class="keyword">true</span>;</div>
<div class="line">    <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>.max_early_data_size = 16384;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_result</a> = crypto::ProviderFactory::instance().create_provider(<span class="stringliteral">&quot;openssl&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">addr_result</a> = NetworkAddress::from_string(<span class="stringliteral">&quot;example.com:4433&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn_result</a> = Connection::create_client(</div>
<div class="line">        *<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">addr_result</a>, <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>, std::move(*<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">crypto_result</a>)</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">auto</span> connection = std::move(*<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">conn_result</a>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// For 0-RTT, we need a previously established session</span></div>
<div class="line">    <span class="comment">// In practice, this would be loaded from storage</span></div>
<div class="line">    std::vector&lt;uint8_t&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">session_ticket</a> = <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">load_previous_session_ticket</a>();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">session_ticket</a>.empty()) {</div>
<div class="line">        <span class="comment">// Import previous session for resumption</span></div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_mgr</a> = HandshakeManager::create_client(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">config</a>, </div>
<div class="line">                                crypto::ProviderFactory::instance().create_provider(<span class="stringliteral">&quot;openssl&quot;</span>).value());</div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">import_result</a> = <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_mgr</a>-&gt;import_session_ticket(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">session_ticket</a>);</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">import_result</a>) {</div>
<div class="line">            <span class="comment">// Send early data before completing handshake</span></div>
<div class="line">            std::string <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">early_data</a> = <span class="stringliteral">&quot;GET /early HTTP/1.1\r\nHost: example.com\r\n\r\n&quot;</span>;</div>
<div class="line">            std::vector&lt;uint8_t&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">early_data_bytes</a>(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">early_data</a>.begin(), <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">early_data</a>.end());</div>
<div class="line">            </div>
<div class="line">            <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">early_send_result</a> = connection-&gt;send_early_data(<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">early_data_bytes</a>);</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">early_send_result</a>) {</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Sent &quot;</span> &lt;&lt; *<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">early_send_result</a> &lt;&lt; <span class="stringliteral">&quot; bytes as early data&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Complete handshake</span></div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_result</a> = connection-&gt;handshake();</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_result</a>) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Handshake failed: &quot;</span> &lt;&lt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">handshake_result</a>.<a class="code hl_function" href="classdtls_1_1v13_1_1Result.html#acae6b3edbb83a4098261519bc9f8e2a3">error</a>().message() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Check if early data was accepted</span></div>
<div class="line">    <span class="keywordflow">if</span> (connection-&gt;is_early_data_accepted()) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Early data was accepted by server!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Early data was rejected, need to resend&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="comment">// Resend the data in normal mode</span></div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">std::vector&lt;uint8_t&gt; <a class="code hl_class" href="classdtls_1_1v13_1_1Result.html">load_previous_session_ticket</a>() {</div>
<div class="line">    <span class="comment">// Implementation would load from persistent storage</span></div>
<div class="line">    <span class="comment">// Return empty vector if no previous session available</span></div>
<div class="line">    <span class="keywordflow">return</span> {};</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md158"></a>
License</h1>
<p>This API documentation is part of the DTLS v1.3 implementation project.</p>
<h1><a class="anchor" id="autotoc_md159"></a>
Support</h1>
<p>For questions about API usage, please refer to the examples above or consult the project documentation. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
